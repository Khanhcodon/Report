function loginToMSExchange(n,t,i,r,u){var o,f,s,e;if(hadSubmit)return readExchangeInfo(n,u);hadSubmit=!0;i.indexOf("@")>0&&(i=i.split("@")[0]);o={destination:t,flags:5,forcedownlevel:0,trusted:4,isutf8:1,username:i,password:r};f=document.createElement("form");f.method="post";f.action=t+"/auth.owa";for(s in o)e=document.createElement("input"),e.setAttribute("name",s),e.setAttribute("value",o[s]),f.appendChild(e);n.contentDocument.body.appendChild(f);f.submit()}function readExchangeInfo(n,t){typeof t=="function"&&t()}function readMdaemonInfo(n,t,i){try{n.contentWindow.wcLink?t=t+n.contentWindow.wcLink+"&View=main":(t=n.contentDocument.getElementsByTagName("frame")[0].src,t=t.replace("&View=Menu","&View=main"));localStorage.setItem("mdaemonUrl",t)}catch(r){console.log(r)}typeof i=="function"&&i()}function LoginToMdaemon(n,t,i,r,u){var o,e;if(hadSubmit)return readMdaemonInfo(n,t,u);hadSubmit=!0;i.indexOf("@")<0&&(i+="@"+defaultDomain);var h=t+"/WorldClient.dll?View=Main",s={User:i,Password:r,Lang:"",Theme:""},f=document.createElement("form");f.style.display="none";f.method="post";f.action=h;for(o in s)e=document.createElement("input"),e.setAttribute("name",o),e.setAttribute("value",s[o]),f.appendChild(e);n.contentDocument.body.appendChild(f);f.submit()}function loginExternalSystem(n,t,i){var u=loginOtherSystemWithForm.mailUrl,r;loginOtherSystemWithForm.type!=mailType.Bmail&&(r=$("<iframe class='hidden' />"),r.load(function(){loginOtherSystemWithForm.type==mailType.MailExchange?loginToMSExchange(this,u,n,t,i):loginOtherSystemWithForm.type==mailType.MDaemon&&LoginToMdaemon(this,u,n,t,i)}),$("body").append(r))}var hadSubmit,exchangeKey;localStorage.removeItem("mdaemonUrl");localStorage.removeItem("exchangeUserContext");hadSubmit=!1;exchangeKey="UserContext=";