define([],function(){return Backbone.View.extend({id:"addStoreAttachment",initialize:function(n){this.storeId=n.id;this.render();this.$("#uploadStorePrivateAttachment").unbind("click")},render:function(){var n=this;require([egov.template.tree.createStoreAttachment],function(t){n.$el.html(t);n.initFileUploadStorePrivateAttachment()})},initFileUploadStorePrivateAttachment:function(){var n=this;n.$("#storePrivateAttachment").fileupload({dataType:"json",autoUpload:!1,singleFileUploads:!1,add:function(t,i){var r=_.pluck(i.files,"name").join("; ");n.$("#attachmentName").val(r);n.$("#uploadStorePrivateAttachment").unbind("click");n.$("#uploadStorePrivateAttachment").click(function(){i.submit()})},start:function(){egov.pubsub.publish(egov.events.status.processing,egov.resources.document.attachment.uploading)},stop:function(){n.$el.dialog("destroy")},done:function(){egov.views&&egov.views.home.tree&&egov.views.home.tree.storeTree&&egov.views.home.tree.storeTree.storeModelSelected&&egov.views.home.tree.storeTree.storeModelSelected.select();egov.pubsub.publish(egov.events.status.success,egov.resources.document.attachment.uploadSuccess);n.$el.dialog("destroy")},fail:function(){egov.pubsub.publish(egov.events.status.error,egov.resources.document.attachment.uploadError)}}).bind("fileuploadsubmit",function(t,i){console.log(i);i.formData={id:n.storeId,desc:n.$("#descStorePrivateAttachment").val(),__RequestVerificationToken:$("input[name=__RequestVerificationToken]","#StorePrivateAddAttachment").val()}})},setFocus:function(){var n=this.$("input[type=text]").first(),t;n&&n.length>0&&(t=n.val()?n.val().length:0,n.focus(),n[0].setSelectionRange(t,t))}})});