define([],function(){"use strict";var t=egov.dataManager,n=egov.resources.document.lienthong;return Backbone.View.extend({tagName:"div",className:"egov-lienthong",initialize:function(n){var i=this;return i.document=n.document,t.getAllAddress({success:function(n){i.address=_.filter(n,function(n){return!String.isNullOrEmpty(n.EdocId)});i.render()}}),this},render:function(){var t=this,i=t.document.model.get("LienThongs");require([egov.template.document.lienthong],function(r){$.tmpl(r,{addresses:t.address}).appendTo(t.$el);_.each(i,function(n){if(!n.IsResponsed){var r=n.AddressId,i=t.$("#address"+r);i.length>0&&(i.attr("disabled","disabled"),i.parent().addClass("disable"),i.next().append("<span> (Đang gửi liên thông)<\/span>"))}});t.$el.dialog({title:n.dialogTitle,width:450,height:"auto",buttons:[{text:n.sendButton,className:"btn-primary",click:function(){t.$el.dialog("hide");t.send()}},{text:egov.resources.common.closeButton,click:function(){t.$el.dialog("hide")}}]});t.$("#comment").focus();t.$("input.datetime").datepicker({dateFormat:"dd/m/yy"});t.searchAddress()})},searchAddress:function(){var t=this,n=$(".address-item");require(["vendors"],function(){var i=t.$("#searchAddress");i.keyup(function(){var t=i.val(),r;t==""&&n.show();r=n.each(function(){var n=$(this),i=egov.utilities.string.stripVietnameseChars(n.data("name")).toUpperCase(),r=egov.utilities.string.stripVietnameseChars(t).toUpperCase();i.indexOf(r)>-1?n.show():n.hide()})})})},send:function(){var t=[],r,i,u;if(this.$(".address-list :checked").each(function(){t.push(parseInt($(this).val()))}),t.length===0){alert(n.noAddressChoised);return}r=this.$("#comment").val();i=this.$("input.datetime").val();String.isNullOrEmpty(i)||(u=Globalize.parseDate(i));this.document.transferLienThong(r,t,u)}})});