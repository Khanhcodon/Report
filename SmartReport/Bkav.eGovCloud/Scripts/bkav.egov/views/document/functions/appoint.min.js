define(["jquery","backbone",egov.template.document.appoint],function(n,t,i){var r=egov.resources.document.appoint;return t.View.extend({doccode:"",that:null,isCreate:!0,template:i,initialize:function(t){this.document=t.document;this.doccode=this.document.model.get("DocCode");that=this;var i={type:"GET",dataType:"JSON",url:"https://kntc.bkav.com/TalkingPeople/GetAppointInfo",data:{doccode:that.doccode},success:function(n){that.render(n)},error:function(n,t,i){console.log({error:{xhr:n,e:t,info:i}});that.render()}};return n.ajax(i),that},render:function(t){var u,i,f;this.model={remind:"",talkingDate:"",number:0};t&&t.hasBook&&(u=t.data,this.model={talkingid:u.id,talkingDate:u.talkingDate,remind:u.remind,number:u.number},this.isCreate=!1);this.$el.html(n.tmpl(this.template,this.model));this.$el.bindResources();this.$(".datepicker").datepicker();i=this;f={width:800,height:270,draggable:!0,keyboard:!0,modal:!0,title:r.titleDialog,buttons:[{text:r.updateButton,className:"btn-primary",click:function(){i._validInfo()&&(i.isCreate?i._createAppointment():i._updateAppointment())}},{text:egov.resources.common.closeButton,click:function(){i.$el.dialog("hide")}},]};i.$el.dialog(f);i.$(".remind").focus()},_createAppointment:function(){var t=this,i=t.$(".dateAppoint").val(),u=t.$(".remind").val(),f={type:"POST",dataType:"JSON",url:"https://kntc.bkav.com/TalkingPeople/CreateAppoint",data:{doccode:t.doccode,remind:u,dateAppoint:i},success:function(n){if(n.success){t.$el.dialog("hide");egov.pubsub.publish(egov.events.status.success,r.createAppointSuccess);return}egov.pubsub.publish(egov.events.status.error,egov.resources.common.error)},error:function(){egov.pubsub.publish(egov.events.status.error,egov.resources.common.error)}};n.ajax(f)},_updateAppointment:function(){var t=this,i=t.model.talkingid,u=t.$(".dateAppoint").val(),f=t.$(".remind").val(),e={type:"POST",dataType:"JSON",url:"https://kntc.bkav.com/TalkingPeople/UpdateAppoint",data:{id:i,remind:f,dateAppoint:u},success:function(n){if(n.success){t.$el.dialog("hide");egov.pubsub.publish(egov.events.status.success,r.updateAppointSuccess);return}egov.pubsub.publish(egov.events.status.error,egov.resources.common.error)},error:function(){egov.pubsub.publish(egov.events.status.error,egov.resources.common.error)}};n.ajax(e)},_validInfo:function(){return this.$(".remind").val()==""?(this.$(".remind").focus(),!1):this.$(".dateAppoint").val()==""?(this.$(".dateAppoint").focus(),!1):!0}})});
//# sourceMappingURL=appoint.min.js.map
