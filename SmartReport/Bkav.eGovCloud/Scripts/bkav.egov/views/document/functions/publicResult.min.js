define([egov.template.publicResult],function(n){var t=egov.resources.document.publicResult;return Backbone.View.extend({doccode:"",that:null,template:n,initialize:function(n){this.document=n.document;this.doccode=this.document.model.get("DocCode");that=this;var t={type:"GET",dataType:"JSON",url:"https://kntc.bkav.com/TalkingPeople/GetBookInfo",data:{doccode:that.doccode},success:function(n){that.render(n)},error:function(n,t,i){console.log({error:{xhr:n,e:t,info:i}});that.render()}};return $.ajax(t),that},render:function(n){var r,i,u;this.model={result:"",talkingDate:"",isPublic:!1,finishDate:null};n&&n.hasBook&&(r=n.data,this.model={result:r.finalResult,talkingDate:r.talkingDate,isPublic:r.isPublic,finishDate:r.finishDate});this.$el.html($.tmpl(this.template,this.model));this.$el.bindResources();this.$(".datepicker").datepicker();i=this;u={width:800,height:270,draggable:!0,keyboard:!0,modal:!0,title:t.titleDialog,buttons:[{text:t.updateButton,className:"btn-primary",click:function(){i._validInfo()&&i._updateResult()}},{text:egov.resources.common.closeButton,click:function(){i.$el.dialog("hide")}},]};i.$el.dialog(u);i.$(".result").focus()},_updateResult:function(){var n=that.$("#finishProcess").is(":checked"),t=that.$(".dateAppoint").val(),i=that.$(".result").val(),r=that.$("#isAllowPublic").is(":checked"),u={type:"POST",dataType:"JSON",url:"https://kntc.bkav.com/Document/FinishDocument",data:{id:that.document.model.get("DocCode"),result:i,appointDate:t,isPublic:r},success:function(){n&&that.document.finish();that.$el.dialog("hide")},error:function(){}};$.ajax(u)},_validInfo:function(){return this.$(".result").val()==""?(this.$(".result").focus(),!1):this.$(".dateAppoint").val()==""?(this.$(".dateAppoint").focus(),!1):!0}})});