define([egov.template.document.storePrivate],function(n){"use strict";var t=egov.resources.document.docStore;return Backbone.View.extend({className:"docStorePrivate",template:n,events:{"click .list-group-item":"_selected","dblclick .list-group-item":"_selectAndSend"},initialize:function(){this.$el.html(this.template);this.$el.bindResources();this.$storePrivate=this.$(".storePrivates");this.$storeShare=this.$(".storeShares");var n=this;return egov.dataManager.getStorePrivate({success:function(t){if(t){n.model=t;var i=t.storePrivate,r=t.storeShare;n.$storePrivate.append($.tmpl('<li class="list-group-item"><a href="#" value="${id}"><\/a>${name}<\/li>',i));n.$storeShare.append($.tmpl('<li class="list-group-item"><a href="#" value="${id}"><\/a>${name}<\/li>',r))}},error:function(){egov.pubsub.publish(egov.events.status.error,egov.resources.treeStore.message.error.selectStore)}}),this},render:function(n){this.callback=n;var i=this;this.$el.attr("help-content-page","storePrivate");this.$el.dialog({title:t.dialogTitle,draggable:!0,width:"400px",height:"400px",buttons:[{text:t.createNew,className:"pull-left",click:function(){i._createNew()}},{text:t.saveButton,className:"btn-primary",disableProcess:!0,click:function(n){if(i.selectedId===undefined){egov.pubsub.publish(egov.events.status.warning,t.noChooseStore);egov.callback(n);return}typeof i.callback=="function"&&i.callback(i.selectedId,n)}},{text:t.notSaveButton,className:"btn-info",disableProcess:!0,click:function(n){typeof i.callback=="function"&&i.callback(null,n)}}]})},_selected:function(n){var t=$(n.target);t.is(".list-group-item")&&(this.selectedId=t.find("a").attr("value"),this.$(".active").removeClass("active"),t.addClass("active"));egov.helper.destroyClickEvent(n)},_selectAndSend:function(n){var t=$(n.target);t.is(".list-group-item")&&(this.$(".active").removeClass("active"),t.addClass("active"),this.selectedId=t.find("a").attr("value"),typeof this.callback=="function"&&this.callback(this.selectedId))},_createNew:function(){var n=this;egov.message.prompt(egov.resources.storePrivate.storePrivateNameWarning,t.createNew,function(t){t!==""&&t!==null&&egov.request.createStorePrivate({data:{storePrivateName:t,descStorePrivate:"",parentId:null,userIdJoined:[],__RequestVerificationToken:$('input[name="__RequestVerificationToken"]',"#StorePrivateCreate").val()},success:function(i){var f,e,u,r;if(i&&i.success&&(f=i.id,n.$(".active").removeClass("active"),n.$storePrivate.append($.tmpl('<li class="list-group-item active"><a href="#" value="${id}"><\/a>${name}<\/li>',{id:f,name:t})),n.selectedId=f,e={isStorePrivateRoot:!1,isStoreShared:!1,name:t,root:!1,state:"in",status:0,storePrivateId:f,storePrivateName:t},e=new egov.models.StorePrivateModel(e),egov.views&&egov.views&&egov.views.home.tree&&egov.views.home.tree.storeTree&&egov.views.home.tree.storeTree.storesModel&&egov.views.home.tree.storeTree.storesModel.length>0))for(u=egov.views.home.tree.storeTree.storesModel,r=0;r<u.length;r++)if(!u[r].model.get("isStoreShared")&&(u[r].model.get("id")==null||u[r].model.get("id")==0)){u[r].add(e);break}}})})}})});