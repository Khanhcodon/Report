define([],function(n,t){"use strict";var i,o;if(typeof n!="function")throw"Trang chưa có Jquery";i=function(){this.printButtonId="#btnPrint";this.transferButtonId=".btnTransfer";this.addPaperId="#addPaper";this.addFeeId="#addFee";this.addRelationId=".btnInsertRelation";this.addCommentId="#addLastestComment";this.addAttachmentId=".fileupload"};o=t.View.extend({el:window,initialize:function(n){n.document.toolbar._getActionList()},events:{keydown:"keyDown",keyup:"keyUp"},keyUp:function(n){n.keyCode==17},keyDown:function(n){var t=new i;if(n.ctrlKey)switch(n.keyCode){case 83:n.preventDefault();t.saveDocument(n);break;case 115:n.preventDefault();t.saveDocument(n);break;case 73:n.preventDefault();t.print();break;case 72:n.preventDefault();t.transfer();break;case 71:n.preventDefault();t.addPaper();break;case 76:n.preventDefault();t.addFee();break;case 82:n.preventDefault();t.addRelation();break;case 89:n.preventDefault();t.addComment();break;case 69:n.preventDefault();t.addAttachment()}else switch(n.keyCode){case 9:n.preventDefault();case 13:t.moveNext(n);break;case 37:t.moveLeft(n);break;case 38:t.moveUp(n);break;case 39:t.moveNext(n);break;case 40:t.moveDown(n);break;case 32:t.checkbox(n)}}});i.prototype.saveDocument=function(){egov.toolbar._transferSpecialCreate("TiepNhanHoSoVaTiepTuc")};i.prototype.print=function(){n(this.printButtonId).click()};i.prototype.transfer=function(){n(this.transferButtonId).click()};i.prototype.addPaper=function(){n(this.addPaperId).click()};i.prototype.addFee=function(){n(this.addFeeId).click()};i.prototype.addRelation=function(){n(this.addRelationId).click()};i.prototype.addComment=function(){n(this.addCommentId).click()};i.prototype.addAttachment=function(){n(this.addAttachmentId).click()},function(n){n.fn.getCursorPosition=function(){var t=n(this).get(0),i=0,r,u;return"selectionStart"in t?i=t.selectionStart:"selection"in document&&(t.focus(),r=document.selection.createRange(),u=document.selection.createRange().text.length,r.moveStart("character",-t.value.length),i=r.text.length-u),i}}(jQuery);var s=function(n){var t=n.parent().children().index(n),i=n.parent().parent().children().index(n.parent());return{row:i,col:t}},v=function(n){return n.siblings("td").length+1},r=function(t,i){var r,u=i?n(t.find(e).get().reverse()):t.find(e);return u.each(function(){return n(this).attr("disabled")?!0:(r=n(this),!1)}),r},u=function(n,t){var u,i=n.parent(),e,f;if(t)for(e=n.index();i.next().length>0;){if(i=i.next(),f=i.children("td:eq("+e+")"),f.length>0&&(u=r(f),u))break;if(u=r(i),u)break}else while(i.next().length>0)if(i=i.next(),u=r(i),u)break;return u},f=function(n,t){var u,i=n.parent(),e,f;if(t)for(e=n.index();i.prev().length>0;){if(i=i.prev(),f=i.children("td:eq("+e+")"),f.length>0&&(u=r(f),u))break;if(u=r(i),u)break}else while(i.prev().length>0)if(i=i.prev(),u=r(i,!0),u)break;return u},h=function(n){for(var t,r=n.attr("class").split(" ")[0],i=n.closest("li");i.next().length>0;)if(i=i.next(),t=i.find("input."+r),t.length>0&&!t.attr("disabled"))return t;return u(n.closest("td"),!0)},c=function(n){for(var t,r=n.attr("class").split(" ")[0],i=n.closest("li");i.prev().length>0;)if(i=i.prev(),t=i.find("input."+r),t.length>0&&!t.attr("disabled"))return t;return f(n.closest("td"),!0)},l=function(n){var t,f=s(n),e=v(n),i;if(f.col<e-1){for(i=n;i.next().length>0;)if(i=i.next(),t=r(i),t)return t;t=u(n)}else t=u(n);return t},a=function(n){var t,u=s(n),i;if(u.col>0){for(i=n;i.prev().length>0;)if(i=i.prev(),t=r(i),t)return t;t=f(n)}else t=f(n);return t},e="input[type=text],input[type=checkbox],.ui-multiselect,textarea,select:visible";return i.prototype.moveNext=function(t){var i=n(document.activeElement),f=i.parents(".document-info"),r,u;if(i.is(f.find("input[type=text],input[type=checkbox],select,textarea").last()))return i.blur(),egov.utils.homeShortkey.focusFirstTab(),!0;if(i.parents("#tableLayout").length===0)if(i.parents(".ui-multiselect-checkboxes").length>0){if(n("#"+i.attr("name").replace("multiselect_","")).parents("#tableLayout").length===0)return!0}else return!0;if(r=function(t){var f,s;t&&t.length>0&&(i=t);var r,o=i.closest("td"),u=o.find(e),h=n.inArray(i[0],u);if(h<u.length-1){for(f=h+1;f<u.length;f++)if(s=n(u[f]),!s.attr("disabled")){r=s;r.focus();return}r=l(o)}else r=l(o);r&&r.focus()},i.is('input[type="text"]')){if(i.val().length===0||i.getCursorPosition()===i.val().length||t.keyCode===13||t.keyCode===9)return r(),!1}else if(i.is("textarea"))if(i.val().length==0||i.getCursorPosition()==i.val().length){if(t.keyCode===39||t.keyCode===9)return r(),!1}else return t.keyCode===9?(r(),!1):!0;else if(i.is('input[type="checkbox"]')&&i.parents(".ui-multiselect-checkboxes").length>0){if(t.keyCode===9&&(u=i.attr("name"),u.indexOf("multiselect_")>-1))return r(n("#"+u.replace("multiselect_","")).siblings("button")),!1}else return i.is("select")?t.keyCode===13?i.data("events").mousedown?!1:!0:(r(),!1):(r(),!1);return!0},i.prototype.moveUp=function(t){var r,i=n(document.activeElement);if(i.parents("#tableLayout").length===0)return!0;if(i.is('input[type="text"]')||i.is(".ui-multiselect")){if(i.hasClass("fee-name")||i.hasClass("fee-price")||i.hasClass("fee-id")||i.hasClass("paper-name")||i.hasClass("paper-amount")||i.hasClass("paper-id"))r=c(i);else{if(i.hasClass("ui-autocomplete-input")&&n(".ui-autocomplete:visible").length>0)return!0;r=f(i.closest("td"),!0)}return r&&r.focus(),!1}if(i.is("textarea")){if(i.val().length===0||i.getCursorPosition()===0)return t.preventDefault(),r=f(i.closest("td"),!0),r&&r.focus(),!1}else{if(i.is('input[type="checkbox"]')&&i.parents(".ui-multiselect-checkboxes").length===0)return r=i.hasClass("fee-id")||i.hasClass("paper-id")?c(i):f(i.closest("td"),!0),r&&r.focus(),!1;if(i.is("select"))return r=f(i.closest("td"),!0),r&&r.focus(),!1}return!0},i.prototype.moveDown=function(t){var r,i=n(document.activeElement);if(i.parents("#tableLayout").length===0)return!0;if(i.is('input[type="text"]')){if(i.hasClass("fee-name")||i.hasClass("fee-price")||i.hasClass("paper-name")||i.hasClass("paper-amount"))r=h(i);else{if(i.hasClass("ui-autocomplete-input")&&n(".ui-autocomplete:visible").length>0)return!0;r=u(i.closest("td"),!0)}return r&&r.focus(),!1}if(i.is("textarea")){if(i.val().length===0||i.getCursorPosition()===i.val().length)return r=u(i.closest("td"),!0),r&&r.focus(),!1}else{if(i.is('input[type="checkbox"]')&&i.parents(".ui-multiselect-checkboxes").length===0)return r=i.hasClass("fee-id")||i.hasClass("paper-id")?h(i):u(i.closest("td"),!0),r&&r.focus(),!1;if(i.is("select"))return r=u(i.closest("td"),!0),t.preventDefault(),r&&r.focus(),!1;i.is(".ui-multiselect")&&i.simulate("click")}return!0},i.prototype.moveLeft=function(){var t=n(document.activeElement),i;if(t.parents("#tableLayout").length===0)return!0;if(i=function(){var i,u=t.closest("td"),o=u.find(e),s=n.inArray(document.activeElement,o),r,f;if(s>0){for(r=s-1;r>=0;r--)if(f=n(o[r]),!f.attr("disabled")){i=f;i.focus();return}i=a(u)}else i=a(u);i&&i.focus()},t.is('input[type="text"]')||t.is("textarea")){if(t.val().length===0||t.getCursorPosition()===0)return i(),!1}else return t.is('input[type="checkbox"]')?t.parents(".ui-multiselect-checkboxes").length===0?(i(),!1):!0:(i(),!1);return!0},i.prototype.moveRight=function(){return this.moveNext()},i.prototype.checkbox=function(){var t=n(document.activeElement);t.is('input[type="checkbox"]')&&t.simulate("click")},o});