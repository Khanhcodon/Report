/*
Navicat MySQL Data Transfer

Source Server         : localhost
Source Server Version : 50540
Source Host           : localhost:3306
Source Database       : egovbrvt_soyt

Target Server Type    : MYSQL
Target Server Version : 50540
File Encoding         : 65001

Date: 2017-01-23 11:53:55
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for `processfunction`
-- ----------------------------
DROP TABLE IF EXISTS `processfunction`;
CREATE TABLE `processfunction` (
  `ProcessFunctionId` int(11) NOT NULL AUTO_INCREMENT,
  `ParentId` int(11) DEFAULT NULL,
  `ProcessFunctionTypeId` int(11) DEFAULT NULL,
  `Name` varchar(128) COLLATE utf8_unicode_ci NOT NULL COMMENT 'Tên chức năng',
  `Icon` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  `Color` varchar(16) COLLATE utf8_unicode_ci DEFAULT NULL,
  `QueryLatest` text COLLATE utf8_unicode_ci COMMENT 'Câu query khi click vào',
  `QueryOlder` text COLLATE utf8_unicode_ci,
  `QueryItemRemove` text COLLATE utf8_unicode_ci,
  `QueryCountAllItems` text COLLATE utf8_unicode_ci,
  `QueryCountItemUnread` text COLLATE utf8_unicode_ci,
  `QueryPaging` text COLLATE utf8_unicode_ci,
  `IsEnablePaging` bit(1) NOT NULL,
  `IsActivated` bit(1) NOT NULL COMMENT 'Trạng thái sử dụng',
  `Order` int(11) NOT NULL,
  `DateFilter` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
  `DateFilterView` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
  `IsOverdueFilter` bit(1) NOT NULL,
  `IsDateFilter` bit(1) NOT NULL,
  `Type` int(11) DEFAULT '0',
  `DateModified` date NOT NULL,
  `ShowTotalInTreeType` tinyint(4) DEFAULT '1',
  `HasUyQuyen` bit(1) DEFAULT b'0',
  `HasTransferTheoLo` bit(1) DEFAULT b'0',
  `TreeGroupId` int(11) NOT NULL,
  `ExportFileConfig` varchar(1000) COLLATE utf8_unicode_ci DEFAULT NULL,
  `HasExportFile` bit(1) DEFAULT b'0',
  `QueryExportDataToFile` text COLLATE utf8_unicode_ci,
  `DocColumnSettingId` int(11) DEFAULT NULL,
  `PermissionSettingId` int(11) DEFAULT NULL,
  PRIMARY KEY (`ProcessFunctionId`),
  KEY `FK_ProcessFunctionParentId_ProcessFunctionId` (`ParentId`) USING BTREE,
  KEY `FK_ProcessFunction_ProcessFunctionTypeId` (`ProcessFunctionTypeId`) USING BTREE,
  CONSTRAINT `processfunction_ibfk_1` FOREIGN KEY (`ProcessFunctionTypeId`) REFERENCES `processfunctiontype` (`ProcessFunctionTypeId`)
) ENGINE=InnoDB AUTO_INCREMENT=240 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- ----------------------------
-- Records of processfunction
-- ----------------------------
INSERT INTO `processfunction` VALUES ('158', null, null, 'Hồ sơ vừa tiếp nhận', null, null, 'SELECT `d`.*, \r\n	`dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, 	\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , \r\n	fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color`, \r\n	GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated = 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả \r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color`, GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\nGetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated = 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nWHERE\r\n	(`dc`.`UserCurrentId` != @userId \r\nOR dc.`Status` != 2\r\nOR `dc`.HasJustCreated != 1\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4))\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated = 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated = 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', '{\"FunctionId\":158,\"FileName\":\"eb090303be7f40118fefed648b2f2e45\",\"DateCreated\":\"2016-01-06T17:13:59.8020547+07:00\",\"FileLocationId\":5,\"IdentityFolder\":\"0\",\"FileLocationKey\":\"E:\\\\eGovUploadFile\\\\Attach\",\"RealFileName\":\"ExportToFile.rpt\"}', '', 'SELECT \r\n	d.DocCode, \r\n	d.CitizenName, \r\n	d.DateCreated, \r\n	d.DateAppointed, \r\n	DATEDIFF(d.DateAppointed, d.DateCreated) as RemainTime\r\nFROM document d\r\nINNER JOIN documentcopy dc on dc.DocumentId = d.DocumentId\r\nWHERE dc.DocumentCopyId in (#docCopyIds)', '174', '1');
INSERT INTO `processfunction` VALUES ('159', '188', null, 'Hồ sơ chờ bổ sung', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	`dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , \r\n	fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSupplemented is NOT NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) = 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, \r\n	`dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,\r\n	`dc`.Status as`DocCopyStatus`, `dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSupplemented is NOT NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) = 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` != @userId \r\nOR dc.`Status` NOT IN (2, 16)\r\nOR d.`Status` != 16\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4)\r\nOR d.IsGettingOut = 1\r\nAND d.IsSupplemented is NULL\r\nOR (1024 & dc.NodeCurrentPermission) = 1024 \r\nOR (512 & dc.NodeCurrentPermission) != 512 \r\nOR (2048 & dc.NodeCurrentPermission) = 2048\r\nOR d.IsReturned = 1)\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSupplemented is NOT NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) = 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0);', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSupplemented is NOT NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) = 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `dc`.WorkflowId , `dc`.NodeCurrentId ,`df`.`DocFinishType`,`df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '175', '1');
INSERT INTO `processfunction` VALUES ('160', null, null, 'Hồ sơ đang theo dõi', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color`, GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\nGetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color`, GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\nGetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nWHERE\r\n	(`dc`.`UserCurrentId` = @userId OR dc.`Status` NOT IN (2, 16) OR `dc`.`DocumentCopyType` NOT IN (1, 2, 4))\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4);', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '3', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '176', '1');
INSERT INTO `processfunction` VALUES ('161', null, null, 'Hồ sơ đã trả kết quả', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE d.IsReturned = 1\r\nAND `d`.CategoryBusinessId = 4 \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\nif(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE \r\nd.IsReturned = 1\r\nAND `d`.CategoryBusinessId = 4 \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC\r\nLimit 150;', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nJOIN `document` d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(d.IsReturned IS NULL OR d.IsReturned = 0\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4))\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE \r\nd.IsReturned = 1\r\nAND `d`.CategoryBusinessId = 4 \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4);', 'SELECT COUNT(1) FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE d.IsReturned = 1\r\nAND `d`.CategoryBusinessId = 4 \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '4', null, null, '', '', '0', '2017-01-11', '1', '', '', '3', null, '', null, '177', '1');
INSERT INTO `processfunction` VALUES ('175', null, null, 'Hồ sơ đã kết thúc', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , DATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue`\r\n	,DATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId` \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 4\r\nAND `d`.`Status` = 4\r\nAND `d`.CategoryBusinessId = 4 \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , DATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue`\r\n,DATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId` \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 4\r\nAND `d`.`Status` = 4\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC\r\nLimit 150;', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nWHERE\r\n(dc.`Status` != 4\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4))\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1)\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 4\r\nAND `d`.`Status` = 4\r\nAND `d`.CategoryBusinessId = 4 \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 4\r\nAND `d`.`Status` = 4\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', null, '', '', '5', null, null, '', '', '0', '2017-01-11', '0', '', '', '3', null, '', null, '197', '1');
INSERT INTO `processfunction` VALUES ('179', '188', null, 'Hồ sơ chờ trả kết quả', null, null, 'SELECT `d`.*, \r\n	`dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) != 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) = 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) != 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) = 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC\r\n', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` != @userId \r\nOR dc.`Status` NOT IN (2, 16)\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4)\r\nOR d.IsGettingOut = 1\r\nOR (1024 & dc.NodeCurrentPermission) = 1024 \r\nOR (512 & dc.NodeCurrentPermission) = 512 \r\nOR (2048 & dc.NodeCurrentPermission) != 2048\r\nOR d.IsReturned = 1)\r\nAND `dc`.`DocumentCopyId` IN ({0});\r\n', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) != 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) = 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0);', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) != 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) = 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '2', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '201', '1');
INSERT INTO `processfunction` VALUES ('180', null, null, 'Văn bản đến chờ xử lý', null, null, 'SELECT `d`.*, `dc`.`DocumentCopyId`, `dc`.`DateReceived`, \r\n	1 as `IsViewed`\r\nFROM `document` as `d` \r\nJOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`CategoryBusinessId` = 1 \r\nAND `d`.DocTypeId is NULL\r\nAND `dc`.`DateReceived` >= @toDate\r\nAND `dc`.`UserCurrentId` = @userId\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT `d`.*, `dc`.`DocumentCopyId`, `dc`.`DateReceived`, \r\n	1 as `IsViewed`\r\nFROM `document` as `d` \r\nJOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`CategoryBusinessId` = 1 \r\nAND `d`.DocTypeId is NULL\r\nAND `dc`.`UserCurrentId` = @userId\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT `dc`.DocumentCopyId\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE (`dc`.`Status` != 2 \r\nOr `d`.`CategoryBusinessId` != 1 \r\nOr `d`.DocTypeId is not NULL\r\nOr `dc`.`UserCurrentId` != @userId)\r\nAND `dc`.`DocumentCopyId` IN ({0})', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`CategoryBusinessId` = 1 \r\nAND `d`.DocTypeId is NULL\r\nAND `dc`.`UserCurrentId` = @userId', 'SELECT COUNT(1) FROM `document` as `d` INNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` WHERE `dc`.`Status` = 2 AND `d`.`CategoryBusinessId` = 1 AND `dc`.`UserCurrentId` = @userId', null, '', '', '10', null, null, '', '', '0', '2017-01-23', '1', '', '', '1', null, '', null, '245', '1');
INSERT INTO `processfunction` VALUES ('181', null, null, 'Hồ sơ đang dự thảo', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus` ,`dc`.UserCurrentId  ,`dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 1 \r\n	AND `dc`.`UserCurrentId` = @userId \r\n	AND `dc`.`DateReceived` >= @toDate \r\n	AND d.CategoryBusinessId = 4\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản đang dự thảo mặc định lấy ra tất cả\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId,  `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND d.CategoryBusinessId = 4\r\n ORDER BY `dc`.`DateReceived` DESC;', 'SELECT  `DocumentCopyId`\r\nFROM  `documentcopy` as dc\r\nWHERE ( dc.`Status` != 1 or  `dc`.`UserCurrentId` <> @userId )\r\nAND dc.`DocumentCopyId` IN ({0})', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId;', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc` \r\nWHERE `dc`.`Status` = 1 \r\n	AND `dc`.`UserCurrentId` = @userId \r\n	AND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId , `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '2', null, null, '', '', '0', '2017-01-11', '1', '', '', '3', null, '', null, '246', '1');
INSERT INTO `processfunction` VALUES ('182', '160', null, 'Hồ sơ đang thụ lý', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , \r\n	fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048;\r\n', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` = @userId \r\nOR dc.`Status` NOT IN (2)\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4)\r\nOR d.IsSuccess is NOT NULL\r\nOR d.IsSupplemented is NOT NULL\r\nOR d.IsGettingOut = 1\r\nOR (1024 & dc.NodeCurrentPermission) = 1024 \r\nOR (2048 & dc.NodeCurrentPermission) = 2048)\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048;', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '248', '1');
INSERT INTO `processfunction` VALUES ('183', '160', null, 'Hồ sơ chờ trả kết quả', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) != 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) = 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) != 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) = 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC;\r\n', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM `documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` = @userId \r\nOR dc.`Status` NOT IN (2, 16)\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4)\r\nOR d.IsGettingOut = 1\r\nOR (1024 & dc.NodeCurrentPermission) = 1024 \r\nOR (512 & dc.NodeCurrentPermission) = 512 \r\nOR (2048 & dc.NodeCurrentPermission) != 2048\r\nOR d.IsReturned = 1)\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) != 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) = 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0);', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` IN (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) != 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) = 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '1', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '249', '1');
INSERT INTO `processfunction` VALUES ('184', '160', null, 'Hồ sơ chờ bổ sung', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSupplemented is NOT NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) = 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	  if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSupplemented is NOT NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) = 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC;\r\n', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` = @userId \r\nOR dc.`Status` NOT IN (2, 16)\r\nOR d.`Status` != 16\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4)\r\nOR d.IsGettingOut = 1\r\nAND d.IsSupplemented is NULL\r\nOR (1024 & dc.NodeCurrentPermission) = 1024 \r\nOR (512 & dc.NodeCurrentPermission) != 512 \r\nOR (2048 & dc.NodeCurrentPermission) = 2048\r\nOR d.IsReturned = 1)\r\nAND `dc`.`DocumentCopyId` IN ({0});\r\n', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSupplemented is NOT NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) = 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0);\r\n', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` IN (2, 16)\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSupplemented is NOT NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (512 & dc.NodeCurrentPermission) = 512\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;\r\n', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '2', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '250', '1');
INSERT INTO `processfunction` VALUES ('185', '160', null, 'Hồ sơ đang trình ký', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) = 1024 \r\nAND (512 & dc.NodeCurrentPermission) != 512 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) = 1024 \r\nAND (512 & dc.NodeCurrentPermission) != 512 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` = @userId \r\nOR dc.`Status` != 2\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4)\r\nOR d.IsSuccess is NOT NULL\r\nOR d.IsSupplemented is NOT NULL\r\nOR d.IsGettingOut = 1\r\nOR (512 & dc.NodeCurrentPermission) = 512 \r\nOR (1024 & dc.NodeCurrentPermission) != 1024 \r\nOR (2048 & dc.NodeCurrentPermission) = 2048)\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) = 1024 \r\nAND (512 & dc.NodeCurrentPermission) != 512 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048;', 'SELECT COUNT(1) FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) = 1024 \r\nAND (512 & dc.NodeCurrentPermission) != 512 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '3', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '251', '1');
INSERT INTO `processfunction` VALUES ('186', '160', null, 'Hồ sơ đang liên thông', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , \r\n	fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 16\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsGettingOut = 1\r\nAND (2 & dc.NodeCurrentPermission) = 2\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 16\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsGettingOut = 1\r\nAND (2 & dc.NodeCurrentPermission) = 2\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` = @userId \r\nOR dc.`Status` != 16\r\nOR d.`Status` != 16\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4)\r\nOR (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (2 & dc.NodeCurrentPermission) != 2\r\nOR d.IsReturned = 1)\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 16\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsGettingOut = 1\r\nAND (2 & dc.NodeCurrentPermission) = 2\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0);', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 16\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` != @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND d.IsGettingOut = 1\r\nAND (2 & dc.NodeCurrentPermission) = 2\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '4', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '252', '1');
INSERT INTO `processfunction` VALUES ('187', '188', null, 'Hồ sơ chờ duyệt', null, null, 'SELECT `d`.*, \r\n	`dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n	`dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , \r\n	DATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue`, \r\n	DATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) = 1024 \r\nAND (512 & dc.NodeCurrentPermission) != 512 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT `d`.*, \r\n	`dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , \r\nDATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue`, \r\nDATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) = 1024 \r\nAND (512 & dc.NodeCurrentPermission) != 512 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nORDER BY `dc`.`DateReceived` DESC;\r\n', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` != @userId \r\nOR dc.`Status` != 2\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4)\r\nOR d.IsSuccess is NOT NULL\r\nOR d.IsSupplemented is NOT NULL\r\nOR d.IsGettingOut = 1\r\nOR (512 & dc.NodeCurrentPermission) = 512 \r\nOR (1024 & dc.NodeCurrentPermission) != 1024 \r\nOR (2048 & dc.NodeCurrentPermission) = 2048)\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\n\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) = 1024 \r\nAND (512 & dc.NodeCurrentPermission) != 512 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) = 1024 \r\nAND (512 & dc.NodeCurrentPermission) != 512 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;\r\n', null, '', '', '1', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '253', '1');
INSERT INTO `processfunction` VALUES ('188', null, null, 'Hồ sơ chờ xử lý', null, null, 'SELECT `d`.*, \r\n	`dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue, \r\nGetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\nGetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` in (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT `d`.*, \r\n`dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as DateOverdue , \r\nGetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\nGetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status`  in (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nWHERE\r\n	(`dc`.`UserCurrentId` != @userId \r\nOR dc.`Status` not in (2, 16)\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4))\r\nOR `dc`.HasJustCreated = 1\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status`  in (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4);', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status`  in (2, 16)\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', null, '', '', '1', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', '{\"FunctionId\":188,\"FileName\":\"87d294dc030043078a2b12467654faba\",\"DateCreated\":\"2015-11-14T14:50:48.7323092+07:00\",\"FileLocationId\":5,\"IdentityFolder\":\"0\",\"FileLocationKey\":\"E:\\\\eGovUploadFile\\\\Attach\",\"RealFileName\":\"DocumentsToFile.rpt\"}', '', null, '254', '1');
INSERT INTO `processfunction` VALUES ('189', '158', '3', 'Lọc theo lĩnh vực', null, null, 'SELECT `d`.*, \r\n`dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,`df`.`DocFinishType`,`df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , \r\nDATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue`, \r\nDATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.`DocumentCopyType` = 1\r\nAND `dc`.HasJustCreated = 1\r\nAND (d.IsGettingOut IS NULL OR d.IsGettingOut = 0)\r\nAND d.DocFieldId = @docfieldid\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT `d`.*, \r\n`dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,`df`.`DocFinishType`,`df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , \r\nDATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue`, \r\nDATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DocumentCopyType` = 1\r\nAND `dc`.HasJustCreated = 1\r\nAND (d.IsGettingOut IS NULL OR d.IsGettingOut = 0)\r\nAND d.DocFieldId = @docfieldid\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE (`dc`.`Status` != 2 \r\nOR `d`.`Status` != 2\r\nOR `d`.CategoryBusinessId != 4 \r\nOR `dc`.`UserCurrentId` != @userId \r\nOR `dc`.`DocumentCopyType` != 1\r\nOR `dc`.HasJustCreated = 1\r\nOR d.IsGettingOut = 1)\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DocumentCopyType` = 1\r\nAND `dc`.HasJustCreated = 1\r\nAND (d.IsGettingOut IS NULL OR d.IsGettingOut = 0)\r\nAND d.DocFieldId = @docfieldid\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DocumentCopyType` = 1\r\nAND `dc`.HasJustCreated = 1\r\nAND (d.IsGettingOut IS NULL OR d.IsGettingOut = 0)\r\nAND d.DocFieldId = @docfieldid\r\nAND df.IsViewed = 0', null, '', '', '0', null, null, '', '', '0', '2016-05-09', '1', '', '', '3', null, '', null, '255', '1');
INSERT INTO `processfunction` VALUES ('190', '188', null, 'Hồ sơ chờ thụ lý', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048;\r\n', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` != @userId \r\nOR dc.`Status` NOT IN (2)\r\nOR `dc`.`DocumentCopyType` NOT IN (1, 2, 4)\r\nOR d.IsSuccess is NOT NULL\r\nOR d.IsSupplemented is NOT NULL\r\nOR d.IsGettingOut = 1\r\nOR (1024 & dc.NodeCurrentPermission) = 1024 \r\nOR (2048 & dc.NodeCurrentPermission) = 2048)\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048;', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 2\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` in (1, 2, 4)\r\nAND d.IsSuccess is NULL\r\nAND d.IsSupplemented is NULL\r\nAND (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nAND (1024 & dc.NodeCurrentPermission) != 1024 \r\nAND (2048 & dc.NodeCurrentPermission) != 2048\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '3', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '256', '1');
INSERT INTO `processfunction` VALUES ('192', null, null, 'Hồ sơ đang liên thông', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , \r\n	fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color`, \r\n	GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DateReceived` >= @toDate \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` = 64\r\nAND d.IsGettingOut = 1\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nORDER BY `dc`.`DateReceived` DESC', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả @fromDate @take\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, \r\nif(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color`, GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\nGetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` = 64\r\nAND d.IsGettingOut = 1\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0);', 'SELECT\r\n	dc.`DocumentCopyId`\r\nFROM\r\n	`documentcopy` dc\r\nINNER JOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE\r\n	(`dc`.`UserCurrentId` != @userId \r\nOR dc.`Status` != 2\r\nOR d.`Status` != 16\r\nOR `dc`.`DocumentCopyType` != 64\r\nOR (d.IsGettingOut is NULL OR d.IsGettingOut = 0)\r\nOR d.IsReturned = 1)\r\nAND `dc`.`DocumentCopyId` IN ({0});', 'SELECT COUNT(1) FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` = 64 \r\nAND d.IsGettingOut = 1\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0);\r\n', 'SELECT COUNT(1) FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2\r\nAND `d`.`Status` = 16\r\nAND `d`.CategoryBusinessId = 4 \r\nAND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.HasJustCreated != 1\r\nAND `dc`.`DocumentCopyType` = 64\r\nAND d.IsGettingOut = 1\r\nAND (d.IsReturned is NULL OR d.IsReturned = 0)\r\nAND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , fnGetDocumentColor(`d`.`UrgentId`,`d`.`DateAppointed`, `d`.`DateResponsed`, `d`.`DateResponsedOverdue`, `dc`.`DateOverdue`, `dc`.`DocumentCopyType`, `dc`.Status) AS `Color` FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2017-01-11', '3', '', '', '3', null, '', null, '178', '1');
