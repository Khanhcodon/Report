define([egov.template.updateLastResult],function(n){return Backbone.View.extend({template:n,initialize:function(n){return this.document=n.document,this.success=n.callback,this.message=n.message,this.render(),this},render:function(){var n,t;this.$el.html($.tmpl(this.template,{message:this.message}));this.$el.bindResources();n=this;n.$datePublish=n.$(".updateLastResultDatePublish");n.$code=n.$(".updateLastResultCode");n.$comment=n.$(".updateLastResultComment");t={width:500,height:351,draggable:!0,keyboard:!0,modal:!0,title:egov.resources.document.updateLastResult.dialogTitle,buttons:[{text:egov.resources.common.updateButton,className:"btn-primary",click:function(){n._update()}},{text:egov.resources.common.closeButton,click:function(){n.$el.dialog("hide")}},]};n.$el.dialog(t);n.$comment.focus();n.$datePublish.datepicker()},_update:function(){var n=this,t=n.$datePublish.val(),i=n.$code.val(),r="Số đến:"+i+"/n Phát hành ngày:"+t+"/n Ý kiến:"+this.$comment.val(),u=$("[name='IsSuccess']:checked").val(),f=u=="true"?!0:!1;egov.pubsub.publish(egov.events.status.processing,"Đang xử lý");egov.request.updateLastResult({data:{result:f,comment:r,documentCopyId:n.document.model.get("DocumentCopyId")},success:function(t){if(t.error){egov.pubsub.publish("status.error",t.error);return}n.$el.dialog("hide");egov.callback(n.success)}})}})});