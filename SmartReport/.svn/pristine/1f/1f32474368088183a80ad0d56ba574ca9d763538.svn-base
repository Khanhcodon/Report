(function(n){window.localStorage||console.log("localStorage not support");window.indexedDB||console.log("indexedDB not support");var i={folderList:"folderList",mailList:"mailList",folder:"mailFolder",notify:"notifyData"},r={READ_WRITE:"readwrite",READ_ONLY:"readonly"},t=function(){};t.prototype.readAllNotify=function(n){var t=this.readCache(n);return(t==null||t==undefined)&&(t=JSON.stringify([])),JSON.parse(t)};t.prototype.readNotify=function(){};t.prototype.removeNotify=function(n,t){var i=this.readAllNotify(n),r=i.find(function(n){return n.id==t});i.splice(i.indexOf(r),1);this.setCache(n,JSON.stringify(i))};t.prototype.removeAllNotify=function(n){this.updateNotifies(n,[])};t.prototype.addNotify=function(n,t,i){var r=this.readAllNotify();i?r.unshift(t):r.push(t);this.setCache(n,JSON.stringify(r))};t.prototype.updateNotifies=function(n,t){this.setCache(n,JSON.stringify(t))};t.prototype.getFolderList=function(){return this.readCache(i.folderList)};t.prototype.setFolderList=function(n){this.setCache(i.folderList,n)};t.prototype.getLastMailList=function(){return this.readCache(i.mailList)};t.prototype.setLastMailList=function(n){this.setCache(i.mailList,n)};t.prototype.getLastFolderIndex=function(){var n=this.readCache(i.folder);return n&&!isNaN(n)?n:0};t.prototype.setLastFolderIndex=function(n){this.setCache(i.folder,n)};t.prototype.setCache=function(n,t){t=hashBase64.encode(t.toString());window.localStorage?window.localStorage.setItem(n,t):window.indexedDB&&(objectStore=that._getObjectStore(r.READ_WRITE),request=objectStore.add({key:n,value:t,dateModified:new Date}))};t.prototype.readCache=function(n){var t,i;return window.localStorage?t=window.localStorage.getItem(n):window.indexedDB&&(i=this._getObjectStore(r.READ_ONLY),t=i.get(n)),t?hashBase64.decode(t):void 0};t.prototype.removeCache=function(n){window.localStorage?window.localStorage.removeItem(n):window.indexedDB&&(objectStore=that._getObjectStore(r.READ_WRITE),request=objectStore.delete(key))};t.prototype.reset=function(){window.localStorage?window.localStorage.clear():window.indexedDB&&(objectStore=this._getObjectStore(r.READ_WRITE),objectStore.clear())};t.prototype._getObjectStore=function(n){n=n?n:r.READ_WRITE;var t;return t=this._storage.transaction([this._tableName],n),t.objectStore(this._tableName)};n.locache=new t})(bmail=window.bmail||{});