function login(){if(validateField()){$("#error").text("").hide();showLoading(!0);var n=$("#Username").val(),t=$("#Password").val();$.post('@Url.Action("LoginViaLdap")',{username:n,password:t},function(n){if(n.success==!0&&n.token!=""){var t=!1;$(".login").find("input[type='checkbox']").length&&(t=$("#RememberMe").attr("checked")=="checked");$.get("@ssoDomain/User/LoginToken?callback=?",{token:n.token,domain:"@ViewBag.Domain",remember:$("#RememberMe").attr("checked")=="checked"},function(n){if(n.LoginTokenResult.Status=="DENIED")showLoading(!1),$("#error").text('@Html.Raw(Localizer("User.Login.Failed"))').show();else{var i='@Url.Action("Login", "Account")?ReturnUrl=@(string.IsNullOrWhiteSpace(Request.QueryString["ReturnUrl"]) ? "/" : Request.QueryString["ReturnUrl"])&remember='+t;document.location=i}},"jsonp").fail(function(n){console.log("Login token");console.log(n)})}else showLoading(!1),n.message!=""?$("#error").text(n.message).show():$("#error").text('@Html.Raw(Localizer("User.Login.Failed"))').show()},"json").fail(function(n){console.log("Login Ldap");console.log(n)})}return!1}$(function(){$('input[type="text"]').first().focus();$("#login").click(function(){login()});$("#Username").keyup(function(n){n.keyCode==13&&login()});$("#Password").keyup(function(n){n.keyCode==13&&login()})});