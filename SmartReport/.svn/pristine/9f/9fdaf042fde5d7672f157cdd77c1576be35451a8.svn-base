"use strict";var REDIPS=REDIPS||{};REDIPS.table=function(){var l,o,a,s,u,v,h,t,f,y,p,i,w,e,r,b,n=[],k,c;return l=function(t,i,u){var s,e,o,h;if(h=function(n){for(var r=[],i=n.getElementsByTagName("table"),t=0;t<i.length;t++)r.push(i[t]);return r},k=i,typeof t=="string")if(u==="classname")for(n=h(document),e=0;e<n.length;e++)n[e].className.indexOf(t)===-1&&(n.splice(e,1),e--);else t=document.getElementById(t);for(t&&typeof t=="object"&&(t.nodeName==="TABLE"?n[0]=t:n=h(t)),o=0;o<n.length;o++)for(s=n[o].getElementsByTagName("td"),e=0;e<s.length;e++)f(s[e]);r()},f=function(n){n.className.indexOf("ignore")>-1||(k===!0?REDIPS.event.add(n,"mousedown",o):REDIPS.event.remove(n,"mousedown",o))},b=function(n){typeof n=="string"&&(n=document.getElementById(n));REDIPS.event.remove(n,"mousedown",o)},o=function(n){var r=n||window.event,i=r.target||r.srcElement,u,f;(f=/^\s*$/.test(i.innerHTML)?!0:!1,REDIPS.table.mark_nonempty!==!1||f!==!1)&&(u=r.which?r.which:r.button,u===1&&(i.redips=i.redips||{},i.redips.selected===!0?t(!1,i):t(!0,i)))},a=function(f,o,c){var b,g,a,tt,it,y,nt,d,k,p,w,v,l={index:-1,span:-1};for(e(),b=c===undefined?n:h(c),p=0;p<b.length;p++)for(k=i(b[p]),g=b[p].rows,tt=f==="v"?u(b[p]):g.length,it=f==="v"?g.length:u(b[p]),w=0;w<tt;w++){for(l.index=l.span=-1,v=0;v<=it;v++)d=f==="v"?v+"-"+w:w+"-"+v,k[d]?(a=k[d],a.redips=a.redips||{},y=a?a.redips.selected:!1,nt=f==="v"?a.colSpan:a.rowSpan):y=!1,y===!0&&l.index===-1?(l.index=v,l.span=nt):(y!==!0&&l.index>-1||l.span>-1&&l.span!==nt)&&(s(k,w,l.index,v,f,o),l.index=l.span=-1,y===!0&&((o===!0||o===undefined)&&t(!1,a),y=!1)),k[d]&&(v+=f==="v"?a.rowSpan-1:a.colSpan-1);y===!0&&s(k,w,l.index,v,f,o)}r()},s=function(n,i,r,u,f,e){for(var c=0,l,s,o=f==="v"?n[r+"-"+i]:n[i+"-"+r],h=r+1;h<u;h++)l=f==="v"?h+"-"+i:i+"-"+h,n[l]&&(s=n[l],c+=f==="v"?s.rowSpan:s.colSpan,w(s,o),s.parentNode.deleteCell(s.cellIndex));o!==undefined&&(f==="v"?o.rowSpan+=c:o.colSpan+=c,(e===!0||e===undefined)&&t(!1,o))},u=function(n){var u=n.rows,i,f=0,t,r;for(typeof n=="string"&&(n=document.getElementById(n)),t=0;t<u.length;t++){for(i=0,r=0;r<u[t].cells.length;r++)i+=u[t].cells[r].colSpan||1;i>f&&(f=i)}return f},v=function(o,s){var y,p,c,b,d,w,k,g,v,l,a,nt;for(nt=function(n,t,i){var u,f,r;for(u=0,f=t+n.rowSpan-1,r=i-1;r>=0;r--)b[f+"-"+r]===undefined&&u++;return u},e(),y=s===undefined?n:h(s),v=0;v<y.length;v++)for(b=i(y[v]),g=u(y[v]),p=y[v].rows,l=0;l<p.length;l++)for(k=o==="v"?g:p[l].cells.length,a=0;a<k;a++)o==="v"?(c=b[l+"-"+a],c!==undefined&&(c.redips=c.redips||{}),c!==undefined&&c.redips.selected===!0&&c.rowSpan>1&&(d=nt(c,l,a),w=p[l+c.rowSpan-1].insertCell(a-d),w.colSpan=c.colSpan,c.rowSpan-=1,f(w),b=i(y[v]))):(c=p[l].cells[a],c.redips=c.redips||{},c.redips.selected===!0&&c.colSpan>1&&(k++,w=p[l].insertCell(a+1),w.rowSpan=c.rowSpan,c.colSpan-=1,f(w))),c!==undefined&&t(!1,c);r()},h=function(n){var t=[];return n!==undefined&&(typeof n=="string"&&(n=document.getElementById(n)),n&&typeof n=="object"&&n.nodeName==="TABLE"&&(t[0]=n)),t},y=function(n,t,o){var w,a=null,v,h,y,c=0,s,l,p;if(e(),typeof n!="object"&&(n=document.getElementById(n)),o===undefined&&(o=-1),t==="insert"){for(v=n.rows[0],s=0;s<v.cells.length;s++)c+=v.cells[s].colSpan;for(a=n.insertRow(o),s=0;s<c;s++)w=a.insertCell(s),f(w);r()}else{if(n.rows.length===1)return;for(n.deleteRow(o),y=i(n),o=n.rows.length-1,c=u(n),s=0;s<c;s++){if(h=y[o+"-"+s],h===undefined){for(l=o,p=1;l>=0;l--,p++)if(h=y[l+"-"+s],h!==undefined){h.rowSpan=p;break}}else h.rowSpan>1&&(h.rowSpan-=1);s+=h.colSpan-1}}return a},p=function(n,t,i){var o,s,h,u;if(e(),typeof n!="object"&&(n=document.getElementById(n)),i===undefined&&(i=-1),t==="insert"){for(u=0;u<n.rows.length;u++)h=n.rows[u].insertCell(i),f(h);r()}else{if(o=n.rows[0].cells,o.length===1&&(o[0].colSpan===1||o[0].colSpan===undefined))return;for(u=0;u<n.rows.length;u++)s=i===-1?n.rows[u].cells.length-1:i,o=n.rows[u].cells[s],o.colSpan>1?o.colSpan-=1:n.rows[u].deleteCell(i),u+=o.rowSpan-1}},t=function(n,t,r,u){var f;if(typeof n=="boolean"){if(typeof t=="string")t=document.getElementById(t);else if(typeof t!="object")return;(t.nodeName==="TABLE"&&(f=i(t),t=f[r+"-"+u]),t&&t.nodeName==="TD")&&(t.redips=t.redips||{},typeof REDIPS.table.color.cell=="string"&&(n===!0?(t.redips.background_old=t.style.backgroundColor,t.style.backgroundColor=REDIPS.table.color.cell):t.style.backgroundColor=t.redips.background_old),t.redips.selected=n)}},e=function(){if(window.getSelection)window.getSelection().removeAllRanges();else if(document.selection&&document.selection.type==="Text")try{document.selection.empty()}catch(n){}},i=function(n){for(var r=[],c,l={},u,i,a,v,e,s,t,h,o=n.rows,f=0;f<o.length;f++)for(s=0;s<o[f].cells.length;s++){for(u=o[f].cells[s],i=u.parentNode.rowIndex,a=u.rowSpan||1,v=u.colSpan||1,r[i]=r[i]||[],t=0;t<r[i].length+1;t++)if(typeof r[i][t]=="undefined"){e=t;break}for(l[i+"-"+e]=u,t=i;t<i+a;t++)for(r[t]=r[t]||[],c=r[t],h=e;h<e+v;h++)c[h]="x"}return l},w=function(n,t){var u,r,i;if(n!==t)for(u=n.childNodes.length,r=0,i=0;r<u;r++)n.childNodes[i].nodeType===1?t.appendChild(n.childNodes[i]):i++},r=function(t){if(t!==undefined||c===!0){t!==undefined&&(c=t);for(var s,h,o,l,r,f,e=0;e<n.length;e++)for(s=n[e].rows,l=u(n[e]),o=i(n[e]),r=0;r<s.length;r++)for(f=0;f<l;f++)o[r+"-"+f]&&(h=o[r+"-"+f],h.innerHTML=c?r+"-"+f:"")}},{color:{cell:!1,row:!1,column:!1},mark_nonempty:!0,onmousedown:l,mark:t,merge:a,split:v,row:y,column:p,cell_index:r,cell_ignore:b}}();REDIPS.event||(REDIPS.event=function(){var n,t;return n=function(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i},t=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent?n.detachEvent("on"+t,i):n["on"+t]=null},{add:n,remove:t}}());
/*
//# sourceMappingURL=redips-table.min.js.map
*/