define(function(){"use strict";return Backbone.View.extend({mailId:0,className:"rownavbar custom_nav",sender:"",subject:"",buttons:{isShowReply:!0,isShowReplyAll:!0,isShowDelete:!1,isShowDeletePer:!1,isShowEdit:!0,isShowForward:!0,isShowSpam:!1,isShowUnSpam:!1,isShowUnread:!1,isShowRestore:!1,mailId:0},events:{"touchend #ReplyBT":"reply","touchend #ReplyMore":"replyAll","touchend #btndelete":"deleteMail","touchend #btndeleteper":"deleteMailPer","touchend #btnedit":"edit","touchend #btnforward":"forward","touchend #btnspam":"markSpam","touchend #btnunspam":"unMarkSpam","touchend #btnunread":"markunread","touchend #btnrestore":"restore"},initialize:function(n){return this.mailId=n.mailId,this.mail=n.mail,this.initData(n.mailId),this.render()},initData:function(){this.buttons.mailId=this.mailId;this.sender=this.mail.model.get("sender");this.subject=this.mail.model.get("subject");return},render:function(){var n=this;return require([egov.template.bmail.toolbar],function(t){n.$el.html($.tmpl(t,n.buttons))}),this},reply:function(){var n={to:this.sender.fulladdress,subject:"Re: "+this.subject,sendInfo:String.format("Vào {0} {1} ({2}) đã gửi: ",this.mail.model.get("detailDate"),this.mail.model.get("sender").fullname,this.mail.model.get("sender").fulladdress),oldContentMail:this.mail.model.get("content"),isReply:!0};this.editOrReply(n)},replyAll:function(){var n={to:this.mail.model.get("receivers").join(";"),subject:"Re: "+this.subject,oldContentMail:this.mail.model.get("content"),isReply:!0};this.editOrReply(n)},deleteMail:function(){bmail.current.mail.deleteMail()},deleteMailPer:function(){bmail.current.mail.deleteMailPer()},edit:function(){var n={to:this.mail.model.get("receivers").join(";"),subject:this.subject,oldContentMail:this.mail.model.get("content"),isEdit:!0,idMailDraft:this.mailId};this.editOrReply(n)},forward:function(){var n={to:"",subject:this.subject,oldContentMail:this.mail.model.get("content"),isForward:!0};this.editOrReply(n)},markSpam:function(){bmail.current.mail.markSpam()},unMarkSpam:function(){bmail.current.mail.unMarkSpam()},markunread:function(){bmail.current.mail.markUnRead()},restore:function(){bmail.current.mail.restore()},editOrReply:function(n){var t=this;egov.mobile.showDetailPage("compose");require(["bmailCreateOrReply"],function(t){var i=new t(n)})}})});