/*
Navicat MySQL Data Transfer

Source Server         : localhost
Source Server Version : 50540
Source Host           : localhost:3306
Source Database       : egov_na

Target Server Type    : MYSQL
Target Server Version : 50540
File Encoding         : 65001

Date: 2016-12-23 14:44:37
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for `processfunction`
-- ----------------------------
DROP TABLE IF EXISTS `processfunction`;
CREATE TABLE `processfunction` (
  `ProcessFunctionId` int(11) NOT NULL AUTO_INCREMENT,
  `ParentId` int(11) DEFAULT NULL,
  `ProcessFunctionTypeId` int(11) DEFAULT NULL,
  `Name` varchar(128) COLLATE utf8_unicode_ci NOT NULL COMMENT 'Tên chức năng',
  `Icon` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  `Color` varchar(16) COLLATE utf8_unicode_ci DEFAULT NULL,
  `QueryLatest` text COLLATE utf8_unicode_ci COMMENT 'Câu query khi click vào',
  `QueryOlder` text COLLATE utf8_unicode_ci,
  `QueryItemRemove` text COLLATE utf8_unicode_ci,
  `QueryCountAllItems` text COLLATE utf8_unicode_ci,
  `QueryCountItemUnread` text COLLATE utf8_unicode_ci,
  `QueryPaging` text COLLATE utf8_unicode_ci,
  `IsEnablePaging` bit(1) NOT NULL,
  `IsActivated` bit(1) NOT NULL COMMENT 'Trạng thái sử dụng',
  `Order` int(11) NOT NULL,
  `DateFilter` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
  `DateFilterView` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
  `IsOverdueFilter` bit(1) NOT NULL,
  `IsDateFilter` bit(1) NOT NULL,
  `Type` int(11) DEFAULT '0',
  `DateModified` date NOT NULL,
  `ShowTotalInTreeType` tinyint(4) DEFAULT '1',
  `HasUyQuyen` bit(1) DEFAULT b'0',
  `HasTransferTheoLo` bit(1) DEFAULT b'0',
  `TreeGroupId` int(11) NOT NULL,
  `ExportFileConfig` varchar(1000) COLLATE utf8_unicode_ci DEFAULT NULL,
  `HasExportFile` bit(1) DEFAULT b'0',
  `QueryExportDataToFile` text COLLATE utf8_unicode_ci,
  `DocColumnSettingId` int(11) DEFAULT NULL,
  `PermissionSettingId` int(11) DEFAULT NULL,
  PRIMARY KEY (`ProcessFunctionId`),
  KEY `FK_ProcessFunctionParentId_ProcessFunctionId` (`ParentId`) USING BTREE,
  KEY `FK_ProcessFunction_ProcessFunctionTypeId` (`ProcessFunctionTypeId`) USING BTREE,
  CONSTRAINT `processfunction_ibfk_2` FOREIGN KEY (`ProcessFunctionTypeId`) REFERENCES `processfunctiontype` (`ProcessFunctionTypeId`)
) ENGINE=InnoDB AUTO_INCREMENT=238 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- ----------------------------
-- Records of processfunction
-- ----------------------------
INSERT INTO `processfunction` VALUES ('13', null, null, 'Văn bản đang dự thảo', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n	1 as `IsViewed`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus` ,`dc`.UserCurrentId  ,`dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DateReceived` >= @toDate AND d.CategoryBusinessId != 4\r\n ORDER BY `dc`.`DateReceived` DESC', '-- Văn bản đang dự thảo mặc định lấy ra tất cả\r\nSELECT \r\n	d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n	1 as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId,  `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 1 \r\n	AND `dc`.`UserCurrentId` = @userId \r\n	AND d.CategoryBusinessId != 4\r\n	ORDER BY `dc`.`DateReceived` DESC', 'SELECT  `DocumentCopyId`\r\nFROM  `documentcopy` as dc\r\nWHERE  \r\n(`Status` != 1 or  `dc`.`UserCurrentId` <> @userId )\r\nAND `DocumentCopyId` IN ({0})', 'SELECT COUNT(1) FROM `documentcopy` as `dc`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId ', 'SELECT 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId , `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '3', null, null, '', '', '0', '2016-12-23', '1', '', '', '1', null, '', null, '6', '1');
INSERT INTO `processfunction` VALUES ('32', null, null, 'Văn bản mới kết thúc', null, null, 'SELECT `d`.`Compendium`, d.DocCode, `d`.`DateCreated`,`d`.`DocTypeId`,`d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `d`.`CategoryId`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`, `dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	`dc`.UserCurrentId \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4\r\n	AND d.CategoryBusinessId != 4 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND `dc`.`DateReceived` >= @toDate  	\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT \r\n	`d`.`Compendium`, \r\n	`d`.`DateCreated`,`d`.`DocTypeId`,`d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,d.DocCode, `d`.`CategoryId`,\r\n	1 as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,\r\n	`dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	`dc`.UserCurrentId  \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4\r\n	AND d.CategoryBusinessId != 4 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND `dc`.`DateReceived` <= @fromDate \r\nORDER BY `dc`.`DateReceived` DESC LIMIT 0,100;', 'SELECT  `DocumentCopyId`\r\nFROM  `documentcopy`\r\nWHERE  `UserCurrentId` != @userId And `Status` != 4\r\nAND `DocumentCopyId` IN ({0})', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc` \r\nWHERE `dc`.`Status` = 4 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\');', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc`\r\nWHERE `dc`.`Status` = 4 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	and if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`,`d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,d.DocCode, `d`.`CategoryId`,`df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.WorkflowId , `dc`.NodeCurrentId ,`df`.`DocFinishType`,`dc`.UserCurrentId\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 4  AND d.CategoryBusinessId != 4    AND `df`.`UserId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '7', null, null, '', '', '0', '2016-12-21', '1', '', '', '1', null, '', null, '28', '1');
INSERT INTO `processfunction` VALUES ('33', null, null, 'Văn bản được ủy quyền xử lý', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`,`dc`.`DateReceived`, \r\n`dc`.`DocumentCopyId`,`dc`.`DocumentCopyType`, \r\n`dc`.`Status`  as`DocCopyStatus`,`dc`.UserCurrentId , \r\n0 as `IsViewed`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `authorize` as `au` on `au`.AuthorizeUserId = `dc`.UserCurrentId AND `au`.`Active` = 1\r\nWHERE  `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\n   and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n     and `dc`.UserCurrentId = `au`.AuthorizeUserId \r\n	   and `dc`.`Status` IN (2, 16) AND d.CategoryBusinessId != 4 \r\n		 AND NOW() >= `au`.`DateBegin` \r\n		 AND NOW() <= `au`.`DateEnd` \r\n		 AND  `au`.`AuthorizeUserId` in ({0} )     \r\n		AND `dc`.`DateReceived` >= @toDate \r\n     ORDER BY `dc`.`DateReceived` DESC', 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, \r\n`dc`.`DocumentCopyId`,`dc`.`DocumentCopyType`, \r\n`dc`.`Status`  as`DocCopyStatus`,`dc`.UserCurrentId , \r\n0 as `IsViewed`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `authorize` as `au` on `au`.AuthorizeUserId = `dc`.UserCurrentId AND `au`.`Active` = 1\r\nWHERE  `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\n    and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n     and `dc`.UserCurrentId = `au`.AuthorizeUserId  AND d.CategoryBusinessId != 4 \r\n	   and `dc`.`Status` IN (2, 16)\r\n		 AND NOW() >= `au`.`DateBegin` \r\n		 AND NOW() <= `au`.`DateEnd`  AND `au`.`AuthorizeUserId` in ({0} ) \r\n      AND `dc`.`DateReceived` <= @fromDate \r\n     ORDER BY `dc`.`DateReceived` DESC LIMIT 0,100;', 'SELECT   `DocumentCopyId`  \r\n FROM `documentcopy` as `dc`\r\nINNER JOIN  `authorize` as `au`  ON `dc`.`UserCurrentId` = `au`.`AuthorizeUserId` \r\nWHERE\r\n(`au`.`AuthorizeUserId` not  in ({0}) OR (`au`.`AuthorizeUserId` in ({0})  AND dc.`Status` != 2))\r\n AND dc.`DocumentCopyId` IN ({1})', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `authorize` as `au` on `au`.AuthorizeUserId = `dc`.UserCurrentId AND `au`.`Active` = 1\r\nWHERE  `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\n    and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n     and `dc`.UserCurrentId = `au`.AuthorizeUserId  AND d.CategoryBusinessId != 4 \r\n	   and `dc`.`Status` IN (2, 16)\r\n		 AND NOW() >= `au`.`DateBegin` \r\n		 AND NOW() <= `au`.`DateEnd`  AND `au`.`AuthorizeUserId` in ({0} ) ;', 'SELECT 0;', 'SELECT `d`.*, `dc`.`DateReceived`, \r\n`dc`.`DocumentCopyId`,`dc`.`DocumentCopyType`, \r\n`dc`.`Status`  as`DocCopyStatus`,`dc`.UserCurrentId , \r\n`df`.`IsViewed`,`df`.`IsDocumentImportant` \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`  AND `dc`.UserCurrentId = `df`.UserId \r\nINNER JOIN `authorize` as `au` on `au`.AuthorizeUserId = `df`.UserId AND `au`.`Active` = 1\r\nWHERE  `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nand (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n     and `dc`.UserCurrentId = `au`.AuthorizeUserId \r\n	   and `dc`.`Status` IN (2, 16)\r\n		 AND NOW() >= `au`.`DateBegin` \r\n		 AND NOW() <= `au`.`DateEnd` \r\n		 AND `au`.`AuthorizeUserId` in ({0} ) \r\n      AND `dc`.`DateReceived` <= @fromDate \r\n     AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)\r\n    ORDER BY `dc`.`DateReceived` DESC\r\n     LIMIT @skip,@take', '', '', '8', null, null, '', '', '0', '2016-12-22', '3', '', '', '1', null, '', null, '29', '1');
INSERT INTO `processfunction` VALUES ('34', null, null, 'Văn bản ủy quyền vừa xử lý', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, \r\n0 as `IsViewed`,`dc`.`DocumentCopyType`,\r\n `dc`.Status  as`DocCopyStatus`,\r\n`dc`.UserCurrentId , `dc`.`DocumentCopyId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `authorize` au on `au`.`Active` = 1 AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',au.AuthorizeUserId,\';%\')\r\nWHERE\r\n   `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) \r\n		AND d.CategoryBusinessId != 4 \r\n    and  `au`.`AuthorizeUserId`  in ({0}) \r\n    AND NOW() >= `au`.`DateBegin`\r\n    AND NOW() <= `au`.`DateEnd`\r\n		AND `d`.DateCreated >= `au`.`DateBegin`\r\n    AND `d`.DateCreated <= `au`.`DateEnd`\r\n		and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n		and (dc.UserCurrentId != au.AuthorizeUserId or (dc.UserCurrentId = au.AuthorizeUserId AND dc.`Status` = 4))\r\n		AND `dc`.`DateReceived` >= @toDate \r\n ORDER BY `dc`.`DateReceived` DESC', 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, \r\n1 as `IsViewed`,`dc`.`DocumentCopyType`,\r\n `dc`.Status  as`DocCopyStatus`,\r\n`dc`.UserCurrentId , `dc`.`DocumentCopyId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `authorize` au on `au`.`Active` = 1 AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',au.AuthorizeUserId,\';%\')\r\nWHERE\r\n   `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) \r\n		AND d.CategoryBusinessId != 4 \r\n    and  `au`.`AuthorizeUserId` in ({0}) \r\n    AND NOW() >= `au`.`DateBegin`\r\n    AND NOW() <= `au`.`DateEnd`\r\n		AND `d`.DateCreated >= `au`.`DateBegin`\r\n    AND `d`.DateCreated <= `au`.`DateEnd`\r\n		and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n		and (dc.UserCurrentId != au.AuthorizeUserId or (dc.UserCurrentId = au.AuthorizeUserId AND dc.`Status` = 4))\r\n		AND `dc`.`DateReceived`<= @fromDate\r\n ORDER BY `dc`.`DateReceived` DESC LIMIT 0, 100', 'SELECT  `DocumentCopyId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN  `authorize` as `au`   ON `dc`.`UserCurrentId` = `au`.`AuthorizeUserId` \r\nWHERE  `au`.`AuthorizeUserId`  not  in ({0} ) AND `au`.`Active` = 1  AND `d`.DateCreated <= `au`.`DateBegin`    AND `d`.DateCreated >= `au`.`DateEnd`\r\n AND dc.`DocumentCopyId` IN ({1})', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `authorize` au on `au`.`Active` = 1 AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',au.AuthorizeUserId,\';%\')\r\nWHERE\r\n   `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) \r\n		AND d.CategoryBusinessId != 4 \r\n    and  `au`.`AuthorizeUserId` in ({0}) \r\n    AND NOW() >= `au`.`DateBegin`\r\n    AND NOW() <= `au`.`DateEnd`\r\n		AND `d`.DateCreated >= `au`.`DateBegin`\r\n    AND `d`.DateCreated <= `au`.`DateEnd`\r\n		and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n		and (dc.UserCurrentId != au.AuthorizeUserId or (dc.UserCurrentId = au.AuthorizeUserId AND dc.`Status` = 4))\r\n		AND `dc`.`DateReceived`<= @fromDate\r\n ORDER BY `dc`.`DateReceived` DESC LIMIT 0, 100', 'SELECT 0;', 'SELECT `d`.*, `dc`.`DateReceived`, \r\n`df`.`IsViewed`,`dc`.`DocumentCopyType`,\r\n `dc`.Status  as`DocCopyStatus`,\r\n`dc`.UserCurrentId , `dc`.`DocumentCopyId`,`df`.`IsDocumentImportant` \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` \r\nINNER JOIN `authorize` au on au.AuthorizeUserId = df.UserId\r\nWHERE\r\n   `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\n    and  `au`.`AuthorizeUserId` in ({0} ) \r\n		AND `au`.`Active` = 1\r\n    AND NOW() >= `au`.`DateBegin`\r\n    AND NOW() <= `au`.`DateEnd`\r\nAND `d`.DateCreated >= `au`.`DateBegin`\r\n    AND `d`.DateCreated <= `au`.`DateEnd`\r\n    and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n		and (dc.UserCurrentId != au.AuthorizeUserId or (dc.UserCurrentId = au.AuthorizeUserId AND dc.`Status` = 4))\r\n		AND `dc`.`DateReceived` >= @toDate \r\n		AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)\r\n ORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '9', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '30', '1');
INSERT INTO `processfunction` VALUES ('139', null, null, 'Hồ sơ cá nhân', null, null, 'INNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId ', 'INNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` ', ' SELECT\r\n	`DocumentCopyId`\r\nFROM\r\n	`documentcopy`\r\nWHERE\r\n	`UserCurrentId` != @userId\r\nAND `DocumentCopyId` IN ({0})', 'AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)', null, 'WHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  ', '', '', '0', null, null, '', '', '1', '0000-00-00', '1', '', '', '4', null, '', null, '163', '1');
INSERT INTO `processfunction` VALUES ('140', null, null, 'Hồ sơ chia sẻ', null, null, 'WHERE `dc`.`Status` = 2 AND `d`.CategoryBusinessId != 4 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DateReceived` >= @toDate AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)', 'INNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` ', 'SELECT\r\n	`DocumentCopyId`\r\nFROM\r\n	`documentcopy`\r\nWHERE\r\n	`UserCurrentId` != @userId\r\nAND `DocumentCopyId` IN ({0})', 'SELECT Count(1) FROM `document` as `d` INNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` INNER JOIN `storeprivate_documentcopy` as `sdc` ON `dc`.`DocumentCopyId` = `sdc`.`DocumentCopyId` INNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` INNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId', 'SELECT Count(1) FROM `document` as `d` INNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` INNER JOIN `storeprivate_documentcopy` as `sdc` ON `dc`.`DocumentCopyId` = `sdc`.`DocumentCopyId` INNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` INNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId WHERE `df`.`IsViewed` = 0', 'ORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '1', '0000-00-00', '1', '', '', '4', null, '', null, '162', '1');
INSERT INTO `processfunction` VALUES ('180', null, null, 'Văn bản đến chờ xử lý', null, null, 'SELECT `d`.*, `dc`.`DocumentCopyId`, `dc`.`DateReceived`, df.IsViewed\r\nFROM `document` as `d` \r\nJOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nJoin `docfinish` as df On df.DocumentCopyId = dc.DocumentCopyId\r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`CategoryBusinessId` = 1 \r\nAND `d`.DocTypeId is NULL\r\nAND `dc`.`DateReceived` >= @toDate\r\nAND `dc`.`UserCurrentId` = @userId\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT `d`.*, `dc`.`DocumentCopyId`, `dc`.`DateReceived`, df.IsViewed\r\nFROM `document` as `d` \r\nJOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nJoin `docfinish` as df On df.DocumentCopyId = dc.DocumentCopyId\r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`CategoryBusinessId` = 1 \r\nAND `d`.DocTypeId is NULL\r\nAND `dc`.`UserCurrentId` = @userId\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT `dc`.DocumentCopyId\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE (`dc`.`Status` != 2 \r\nOr `d`.`CategoryBusinessId` != 1 \r\nOr `d`.DocTypeId is not NULL\r\nOr `dc`.`UserCurrentId` != @userId)\r\nAND `dc`.`DocumentCopyId` IN ({0})', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 2 \r\nAND `d`.`CategoryBusinessId` = 1 \r\nAND `d`.DocTypeId is NULL\r\nAND `dc`.`UserCurrentId` = @userId', 'SELECT COUNT(1) FROM `document` as `d` INNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` WHERE `dc`.`Status` = 2 AND `d`.`CategoryBusinessId` = 1 AND `dc`.`UserCurrentId` = @userId', null, '', '', '10', null, null, '', '', '0', '2016-04-07', '1', '', '', '1', null, '', null, '245', '1');
INSERT INTO `processfunction` VALUES ('191', null, null, 'Văn bản của cả cơ quan', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\nGetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`, concat(\"PT\",dc.DocumentCopyId) as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 AND `d`.CategoryBusinessId != 4 AND `dc`.`DocumentCopyType` =1\r\nand d.DocCode is not null and d.DocCode != \'\' \r\n-- AND @toDate = @toDate \r\nORDER BY `dc`.`DateReceived` DESC\r\nlimit 50;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue,\r\n	GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, \r\n	`dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\nAND d.CategoryBusinessId != 4\r\nAND `dc`.`DocumentCopyType` =1 \r\nand d.DocCode is not null and d.DocCode != \'\' \r\nORDER BY `dc`.`DateReceived` DESC Limit 0, 200;', 'SELECT dc.`DocumentCopyId`\r\nFROM `documentcopy` as `dc`\r\nJoin `document` as `d` on dc.DocumentId = d.DocumentId\r\nWHERE dc.`DocumentCopyId` IN ({0}) or `d`.CategoryBusinessId != 4\r\nor d.DocCode is null or d.DocCode = \'\' \r\n', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả\r\nSELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\nAND d.CategoryBusinessId != 4\r\nAND `dc`.`DocumentCopyType` =1 \r\nand d.DocCode is not null and d.DocCode != \'\' \r\nORDER BY `dc`.`DateReceived` DESC Limit 0, 200;', 'SELECT 0;\r\n\r\n', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,`df`.`DocFinishType`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , DATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue` , DATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2016-12-22', '3', '', '', '1', null, '', null, '165', '192');
INSERT INTO `processfunction` VALUES ('221', null, null, 'Văn bản đang theo dõi', null, null, '\r\nSELECT  d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`,`dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`, \r\n	`dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	`u`.`FullName` as `UserCurrentFullName`, \r\n	`u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue ,\r\n	GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` , concat(\"PT\",dc.DocumentCopyId) as NewDocCode\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\n-- INNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE (`dc`.`Status` = 2 OR `dc`.`Status` = 16) \r\n-- 	AND `df`.`UserId` = @userId\r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND d.CategoryBusinessId != 4 AND `dc`.`UserCurrentId` != @userId \r\n	AND `dc`.`DateReceived` >= @toDate ORDER BY `DateReceived` DESC', '\r\n-- Văn bản đang theo dõi mặc định lấy tất cả\r\nSELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,  `dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n		1 as `DocFinishType`, \r\n		`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue ,\r\n		GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n		GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` , concat(\"PT\",dc.DocumentCopyId) as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\nWHERE `dc`.`Status` in (2, 16)\r\n		AND d.CategoryBusinessId != 4 \r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` != @userId AND `dc`.`DateCreated` <= @fromDate \r\nORDER BY `DateReceived` DESC;', 'SELECT `dc`.`DocumentCopyId`\r\nFROM `documentcopy` as `dc`\r\nWHERE (`dc`.`Status` not in (2, 16) or `dc`.`UserCurrentId` = @userId)\r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`DocumentCopyId` IN ({0});', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` in (2, 16)\r\n		AND d.CategoryBusinessId != 4 \r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` != @userId\r\nORDER BY `DateReceived` DESC;', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` in (2, 16)\r\n		AND d.CategoryBusinessId != 4 \r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` != @userId\r\nand if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,  `dc`.WorkflowId , `dc`.NodeCurrentId ,`df`.`DocFinishType`, `u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId  FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE (`dc`.`Status` = 2 OR `dc`.`Status` = 16) AND `df`.`UserId` = @userId AND `dc`.`UserCurrentId` != @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `DateReceived` DESC LIMIT @skip ,@take', '', '', '2', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '165', '1');
INSERT INTO `processfunction` VALUES ('222', null, null, 'Văn bản chờ xử lý', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId` as DocumentCopyId, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, \r\n	`dc`.`WorkflowId`, `dc`.`NodeCurrentId`, dc.DocumentCopyId as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\n	AND `d`.CategoryBusinessId != 4 \r\n	AND `dc`.`UserCurrentId` = @userId \r\n	AND `dc`.`DateReceived` >= @toDate \r\n	AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nORDER BY `dc`.`DateReceived` DESC', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả\r\nSELECT \r\n		d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId` as DocumentCopyId, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n		1 as `DocFinishType`, \r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue,\r\n		GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n		GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`, dc.DocumentCopyId as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4  AND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT dc.`DocumentCopyId`\r\nFROM `documentcopy` as `dc`\r\nJoin `document` as `d` on dc.DocumentId = d.DocumentId\r\nWHERE (dc.`UserCurrentId` != @userId OR (dc.`UserCurrentId` = @userId AND dc.`Status` != 2)) \r\nAND dc.`DocumentCopyId` IN ({0}) and `d`.CategoryBusinessId != 4\r\n', 'SELECT COUNT(1) FROM `documentcopy` as `dc`\r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc`\r\nWHERE \r\n	`dc`.`Status` = 2 \r\n	AND `dc`.`UserCurrentId` = @userId \r\n	and if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0\r\n	AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\n\r\n', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,`df`.`DocFinishType`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , DATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue` , DATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '1', null, null, '', '', '0', '2016-12-22', '3', '', '', '1', null, '', null, '1', '1');
INSERT INTO `processfunction` VALUES ('223', null, null, 'Văn bản thông báo', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,`dc`.UserCurrentId ,\r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` != 4 \r\n		AND d.CategoryBusinessId != 4 \r\n		AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DateReceived` >= @toDate ORDER BY `dc`.`DateReceived` DESC', '-- Các văn bản kết thúc xử lý mặc định load ra 100\r\nSELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,\r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` != 4 \r\n	AND d.CategoryBusinessId != 4 \r\n	AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND `dc`.`DateReceived` <= @fromDate \r\nORDER BY `dc`.`DateReceived` DESC LIMIT 0, 100;', 'SELECT  `DocumentCopyId`\r\nFROM  `documentcopy`as dc\r\nWHERE \r\n		(`dc`.`Status` != 4 \r\n		Or dc.UserThongBao NOT LIKE CONCAT(\'%;\',@userId,\';%\'))\r\n		AND `DocumentCopyId` IN ({0})', 'SELECT COUNT(1)\r\nFROM `documentcopy` as `dc`\r\nWHERE \r\n		`dc`.`Status` != 4 \r\n		AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` = @userId ', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc` \r\nWHERE \r\n		`dc`.`Status` != 4 \r\n		AND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0\r\n		AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId` ,`df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.`UserCurrentId` = `df`.`UserId`\r\nWHERE `dc`.`Status` != 4 AND `dc`.`DocumentCopyType` = 8 AND `dc`.`UserCurrentId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '3', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '25', '1');
INSERT INTO `processfunction` VALUES ('224', '222', null, 'Văn bản đến', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId` as DocumentCopyId, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, \r\n	`dc`.`WorkflowId`, `dc`.`NodeCurrentId`, dc.DocumentCopyId as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\n	AND `d`.CategoryBusinessId = 1\r\n	AND `dc`.`UserCurrentId` = @userId \r\n	AND `dc`.`DateReceived` >= @toDate \r\n	AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nORDER BY `dc`.`DateReceived` DESC', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả\r\nSELECT \r\n		d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId` as DocumentCopyId, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n		1 as `DocFinishType`, \r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue,\r\n		GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n		GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`, dc.DocumentCopyId as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4  AND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nAND `d`.CategoryBusinessId = 1\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT dc.`DocumentCopyId`\r\nFROM `documentcopy` as `dc`\r\nJoin `document` as `d` on dc.DocumentId = d.DocumentId\r\nWHERE (dc.`UserCurrentId` != @userId OR (dc.`UserCurrentId` = @userId AND dc.`Status` != 2)) \r\nAND dc.`DocumentCopyId` IN ({0}) AND `d`.CategoryBusinessId != 1\r\n', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc`\r\nJOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND `d`.CategoryBusinessId = 1;', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc`\r\nJOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE \r\n	`dc`.`Status` = 2 \r\n	AND `dc`.`UserCurrentId` = @userId \r\n	and if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0\r\n	AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nAND `d`.CategoryBusinessId = 1\r\n', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,`df`.`DocFinishType`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , DATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue` , DATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2016-12-22', '3', '', '', '1', null, '', null, '1', '1');
INSERT INTO `processfunction` VALUES ('226', '222', null, 'Văn bản đi', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId` as DocumentCopyId, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, \r\n	`dc`.`WorkflowId`, `dc`.`NodeCurrentId`, dc.DocumentCopyId as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\n	AND `d`.CategoryBusinessId = 2\r\n	AND `dc`.`UserCurrentId` = @userId \r\n	AND `dc`.`DateReceived` >= @toDate \r\n	AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nORDER BY `dc`.`DateReceived` DESC', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả\r\nSELECT \r\n		d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId` as DocumentCopyId, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n		1 as `DocFinishType`, \r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue,\r\n		GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n		GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`, dc.DocumentCopyId as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4  AND `dc`.`UserCurrentId` = @userId \r\nAND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nAND `d`.CategoryBusinessId = 2\r\nORDER BY `dc`.`DateReceived` DESC;', 'SELECT dc.`DocumentCopyId`\r\nFROM `documentcopy` as `dc`\r\nJoin `document` as `d` on dc.DocumentId = d.DocumentId\r\nWHERE (dc.`UserCurrentId` != @userId OR (dc.`UserCurrentId` = @userId AND dc.`Status` != 2)) \r\nAND dc.`DocumentCopyId` IN ({0}) AND `d`.CategoryBusinessId != 2\r\n', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc`\r\nJOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE `dc`.`Status` = 2 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND `d`.CategoryBusinessId = 2;', 'SELECT COUNT(1) \r\nFROM `documentcopy` as `dc`\r\nJOIN document d on d.DocumentId = dc.DocumentId\r\nWHERE \r\n	`dc`.`Status` = 2 \r\n	AND `dc`.`UserCurrentId` = @userId \r\n	and if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0\r\n	AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nAND `d`.CategoryBusinessId = 2\r\n', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,`df`.`DocFinishType`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , DATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue` , DATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '1', null, null, '', '', '0', '2016-12-22', '3', '', '', '1', null, '', null, '1', '1');
INSERT INTO `processfunction` VALUES ('227', '221', null, 'Văn bản đến', null, null, '\r\nSELECT  d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`,`dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`, \r\n	`dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	`u`.`FullName` as `UserCurrentFullName`, \r\n	`u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue ,\r\n	GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` , concat(\"PT\",dc.DocumentCopyId) as NewDocCode\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\n-- INNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE (`dc`.`Status` = 2 OR `dc`.`Status` = 16) \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND d.CategoryBusinessId = 1 AND `dc`.`UserCurrentId` != @userId \r\n	AND `dc`.`DateReceived` >= @toDate ORDER BY `DateReceived` DESC', '\r\n-- Văn bản đang theo dõi mặc định lấy tất cả\r\nSELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,  `dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n		1 as `DocFinishType`, \r\n		`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue ,\r\n		GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n		GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` , concat(\"PT\",dc.DocumentCopyId) as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\nWHERE `dc`.`Status` in (2, 16)\r\n		AND d.CategoryBusinessId = 1 \r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` != @userId AND `dc`.`DateCreated` <= @fromDate \r\nORDER BY `DateReceived` DESC;', 'SELECT `dc`.`DocumentCopyId`\r\nFROM `documentcopy` as `dc`\r\nJoin document d on d.DocumentId = dc.DocumentId\r\nWHERE (`dc`.`Status` not in (2, 16) or `dc`.`UserCurrentId` = @userId)\r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`DocumentCopyId` IN ({0}) AND d.CategoryBusinessId != 1;', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` in (2, 16)\r\n		AND d.CategoryBusinessId = 1\r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` != @userId\r\nORDER BY `DateReceived` DESC;', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` in (2, 16)\r\n		AND d.CategoryBusinessId = 1\r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` != @userId\r\nand if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,  `dc`.WorkflowId , `dc`.NodeCurrentId ,`df`.`DocFinishType`, `u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId  FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE (`dc`.`Status` = 2 OR `dc`.`Status` = 16) AND `df`.`UserId` = @userId AND `dc`.`UserCurrentId` != @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `DateReceived` DESC LIMIT @skip ,@take', '', '', '0', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '165', '1');
INSERT INTO `processfunction` VALUES ('228', '221', null, 'Văn bản đi', null, null, '\r\nSELECT  d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`,`dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`, \r\n	`dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	`u`.`FullName` as `UserCurrentFullName`, \r\n	`u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue ,\r\n	GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` , concat(\"PT\",dc.DocumentCopyId) as NewDocCode\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\n-- INNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE (`dc`.`Status` = 2 OR `dc`.`Status` = 16) \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND d.CategoryBusinessId = 2 AND `dc`.`UserCurrentId` != @userId \r\n	AND `dc`.`DateReceived` >= @toDate ORDER BY `DateReceived` DESC', '\r\n-- Văn bản đang theo dõi mặc định lấy tất cả\r\nSELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, \r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,  `dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n		1 as `DocFinishType`, \r\n		`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue ,\r\n		GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n		GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed` , concat(\"PT\",dc.DocumentCopyId) as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\nWHERE `dc`.`Status` in (2, 16)\r\n		AND d.CategoryBusinessId = 2 \r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` != @userId AND `dc`.`DateCreated` <= @fromDate \r\nORDER BY `DateReceived` DESC;', 'SELECT `dc`.`DocumentCopyId`\r\nFROM `documentcopy` as `dc`\r\nJoin document d on d.DocumentId = dc.DocumentId\r\nWHERE (`dc`.`Status` not in (2, 16) or `dc`.`UserCurrentId` = @userId)\r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`DocumentCopyId` IN ({0}) AND d.CategoryBusinessId != 2;', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` in (2, 16)\r\n		AND d.CategoryBusinessId = 2\r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` != @userId\r\nORDER BY `DateReceived` DESC;', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` in (2, 16)\r\n		AND d.CategoryBusinessId = 2\r\n		AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` != @userId\r\nand if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,  `dc`.WorkflowId , `dc`.NodeCurrentId ,`df`.`DocFinishType`, `u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId  FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `user` as `u` ON `dc`.`UserCurrentId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE (`dc`.`Status` = 2 OR `dc`.`Status` = 16) AND `df`.`UserId` = @userId AND `dc`.`UserCurrentId` != @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `DateReceived` DESC LIMIT @skip ,@take', '', '', '1', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '165', '1');
INSERT INTO `processfunction` VALUES ('229', '13', null, 'Văn bản đến', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus` ,`dc`.UserCurrentId  ,`dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DateReceived` >= @toDate AND d.CategoryBusinessId = 1\r\n ORDER BY `dc`.`DateReceived` DESC', '-- Văn bản đang dự thảo mặc định lấy ra tất cả\r\nSELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId,  `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\n\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND d.CategoryBusinessId = 1\r\n ORDER BY `dc`.`DateReceived` DESC', 'SELECT  `DocumentCopyId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE  \r\n(d.`Status` != 1 or  `dc`.`UserCurrentId` <> @userId )\r\nAND dc.`DocumentCopyId` IN ({0}) AND d.CategoryBusinessId != 1', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND d.CategoryBusinessId = 1', 'SELECT 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId , `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '6', '1');
INSERT INTO `processfunction` VALUES ('230', '13', null, 'Văn bản đi', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus` ,`dc`.UserCurrentId  ,`dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DateReceived` >= @toDate AND d.CategoryBusinessId = 2\r\n ORDER BY `dc`.`DateReceived` DESC', '-- Văn bản đang dự thảo mặc định lấy ra tất cả\r\nSELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId,  `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\n\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND d.CategoryBusinessId = 2\r\n ORDER BY `dc`.`DateReceived` DESC', 'SELECT  `DocumentCopyId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE  \r\n(d.`Status` != 1 or  `dc`.`UserCurrentId` <> @userId )\r\nAND dc.`DocumentCopyId` IN ({0}) AND d.CategoryBusinessId != 2', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND d.CategoryBusinessId = 2', 'SELECT 0;', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId , `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 1 AND `dc`.`UserCurrentId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '1', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '6', '1');
INSERT INTO `processfunction` VALUES ('231', '223', null, 'Văn bản đến', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,`dc`.UserCurrentId ,\r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` != 4 \r\n		AND d.CategoryBusinessId = 1 \r\n		AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DateReceived` >= @toDate ORDER BY `dc`.`DateReceived` DESC', '-- Các văn bản kết thúc xử lý mặc định load ra 100\r\nSELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,\r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` != 4 \r\n	AND d.CategoryBusinessId  = 1 \r\n	AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND `dc`.`DateReceived` <= @fromDate \r\nORDER BY `dc`.`DateReceived` DESC LIMIT 0, 100;', 'SELECT  `DocumentCopyId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE \r\n		(`dc`.`Status` != 4 \r\n		Or dc.UserThongBao NOT LIKE CONCAT(\'%;\',@userId,\';%\'))\r\n		AND `DocumentCopyId` IN ({0}) AND d.CategoryBusinessId  != 1 ', 'SELECT COUNT(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE \r\n		`dc`.`Status` != 4 \r\n                AND d.CategoryBusinessId  = 1 \r\n		AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` = @userId ', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE \r\n		`dc`.`Status` != 4 \r\n		AND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0\r\n		AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\') AND d.CategoryBusinessId  = 1 ', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId` ,`df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.`UserCurrentId` = `df`.`UserId`\r\nWHERE `dc`.`Status` != 4 AND `dc`.`DocumentCopyType` = 8 AND `dc`.`UserCurrentId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '25', '1');
INSERT INTO `processfunction` VALUES ('232', '223', null, 'Văn bản đi', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,`dc`.UserCurrentId ,\r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` != 4 \r\n		AND d.CategoryBusinessId = 2 \r\n		AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')\r\nAND `dc`.`DateReceived` >= @toDate ORDER BY `dc`.`DateReceived` DESC', '-- Các văn bản kết thúc xử lý mặc định load ra 100\r\nSELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,\r\n		if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n		`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` != 4 \r\n	AND d.CategoryBusinessId  = 2 \r\n	AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND `dc`.`DateReceived` <= @fromDate \r\nORDER BY `dc`.`DateReceived` DESC LIMIT 0, 100;', 'SELECT  `DocumentCopyId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE \r\n		(`dc`.`Status` != 4 \r\n		Or dc.UserThongBao NOT LIKE CONCAT(\'%;\',@userId,\';%\'))\r\n		AND `DocumentCopyId` IN ({0}) AND d.CategoryBusinessId  != 2 ', 'SELECT COUNT(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE \r\n		`dc`.`Status` != 4 \r\n                AND d.CategoryBusinessId  = 2 \r\n		AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\')\r\n		AND `dc`.`UserCurrentId` = @userId ', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE \r\n		`dc`.`Status` != 4 \r\n		AND if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0\r\n		AND dc.UserThongBao LIKE CONCAT(\'%;\',@userId,\';%\') AND d.CategoryBusinessId  = 2 ', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId` ,`df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.UserCurrentId \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.`UserCurrentId` = `df`.`UserId`\r\nWHERE `dc`.`Status` != 4 AND `dc`.`DocumentCopyType` = 8 AND `dc`.`UserCurrentId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) ORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '1', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '25', '1');
INSERT INTO `processfunction` VALUES ('233', '32', null, 'Văn bản đến', null, null, 'SELECT `d`.`Compendium`, d.DocCode, `d`.`DateCreated`,`d`.`DocTypeId`,`d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `d`.`CategoryId`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`, `dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	`dc`.UserCurrentId \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4\r\n	AND d.CategoryBusinessId = 1\r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND `dc`.`DateReceived` >= @toDate  	\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT \r\n	`d`.`Compendium`, \r\n	`d`.`DateCreated`,`d`.`DocTypeId`,`d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,d.DocCode, `d`.`CategoryId`,\r\n	1 as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,\r\n	`dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	`dc`.UserCurrentId  \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4\r\n	AND d.CategoryBusinessId = 1 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND `dc`.`DateReceived` <= @fromDate \r\nORDER BY `dc`.`DateReceived` DESC LIMIT 0,100;', 'SELECT  dc.`DocumentCopyId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE  dc.`UserCurrentId` != @userId And dc.`Status` != 4\r\nAND dc.`DocumentCopyId` IN ({0}) AND d.CategoryBusinessId != 1', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4 \r\nAND d.CategoryBusinessId = 1 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\');', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4 \r\n	AND d.CategoryBusinessId = 1 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	and if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`,`d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,d.DocCode, `d`.`CategoryId`,`df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.WorkflowId , `dc`.NodeCurrentId ,`df`.`DocFinishType`,`dc`.UserCurrentId\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 4  AND d.CategoryBusinessId != 4    AND `df`.`UserId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '28', '1');
INSERT INTO `processfunction` VALUES ('234', '32', null, 'Văn bản đi', null, null, 'SELECT `d`.`Compendium`, d.DocCode, `d`.`DateCreated`,`d`.`DocTypeId`,`d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `d`.`CategoryId`,\r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`, `dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	`dc`.UserCurrentId \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4\r\n	AND d.CategoryBusinessId = 2\r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND `dc`.`DateReceived` >= @toDate  	\r\nORDER BY `dc`.`DateReceived` DESC', 'SELECT \r\n	`d`.`Compendium`, \r\n	`d`.`DateCreated`,`d`.`DocTypeId`,`d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,d.DocCode, `d`.`CategoryId`,\r\n	1 as `IsViewed`,\r\n	`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,\r\n	`dc`.WorkflowId , `dc`.NodeCurrentId ,\r\n	1 as `DocFinishType`,\r\n	`dc`.UserCurrentId  \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4\r\n	AND d.CategoryBusinessId = 2 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	AND `dc`.`DateReceived` <= @fromDate \r\nORDER BY `dc`.`DateReceived` DESC LIMIT 0,100;', 'SELECT  dc.`DocumentCopyId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE  dc.`UserCurrentId` != @userId And dc.`Status` != 4\r\nAND dc.`DocumentCopyId` IN ({0}) AND d.CategoryBusinessId != 2', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4 \r\nAND d.CategoryBusinessId = 2 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\');', 'SELECT COUNT(1) \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nWHERE `dc`.`Status` = 4 \r\n	AND d.CategoryBusinessId = 2 \r\n	AND dc.UserNguoiThamGia LIKE CONCAT(\'%;\',@userId,\';%\')\r\n	and if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) = 0;', 'SELECT `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`,`d`.`CategoryBusinessId`, `dc`.`DateReceived`, `dc`.`DocumentCopyId`,d.DocCode, `d`.`CategoryId`,`df`.`IsViewed`,`df`.`IsDocumentImportant`,`dc`.`DocumentCopyType`, `dc`.Status  as`DocCopyStatus`,`dc`.WorkflowId , `dc`.NodeCurrentId ,`df`.`DocFinishType`,`dc`.UserCurrentId\r\n FROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`\r\nWHERE `dc`.`Status` = 4  AND d.CategoryBusinessId != 4    AND `df`.`UserId` = @userId AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch) \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '1', null, null, '', '', '0', '2016-12-22', '1', '', '', '1', null, '', null, '28', '1');
INSERT INTO `processfunction` VALUES ('235', '191', null, 'Văn bản đến', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\nGetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`, concat(\"PT\",dc.DocumentCopyId) as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 AND `d`.CategoryBusinessId = 1 AND `dc`.`DocumentCopyType` =1\r\nand d.DocCode is not null and d.DocCode != \'\' \r\n-- AND @toDate = @toDate \r\nORDER BY `dc`.`DateReceived` DESC\r\nlimit 50;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue,\r\n	GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, \r\n	`dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\nAND d.CategoryBusinessId  = 1\r\nAND `dc`.`DocumentCopyType` =1 \r\nand d.DocCode is not null and d.DocCode != \'\' \r\nORDER BY `dc`.`DateReceived` DESC Limit 0, 200;', 'SELECT dc.`DocumentCopyId`\r\nFROM `documentcopy` as `dc`\r\nJoin `document` as `d` on dc.DocumentId = d.DocumentId\r\nWHERE dc.`DocumentCopyId` IN ({0}) or `d`.CategoryBusinessId != 1\r\nor d.DocCode is null or d.DocCode = \'\' \r\n', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả\r\nSELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\nAND d.CategoryBusinessId  = 1\r\nAND `dc`.`DocumentCopyType` =1 \r\nand d.DocCode is not null and d.DocCode != \'\' \r\nORDER BY `dc`.`DateReceived` DESC Limit 0, 200;', 'SELECT 0;\r\n\r\n', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,`df`.`DocFinishType`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , DATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue` , DATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2016-12-22', '3', '', '', '1', null, '', null, '165', '192');
INSERT INTO `processfunction` VALUES ('236', '191', null, 'Văn bản đi', null, null, 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`, `u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue , GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\nGetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`, concat(\"PT\",dc.DocumentCopyId) as NewDocCode\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 AND `d`.CategoryBusinessId = 2 AND `dc`.`DocumentCopyType` =1\r\nand d.DocCode is not null and d.DocCode != \'\' \r\n-- AND @toDate = @toDate \r\nORDER BY `dc`.`DateReceived` DESC\r\nlimit 50;', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả\r\nSELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,\r\n	1 as `DocFinishType`, \r\n	if(INSTR(dc.UserNguoiDaXem, CONCAT(\';\',@userId,\';\')) > 0, 1, 0) as `IsViewed`,\r\n	`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId ,  dc.DateOverdue,\r\n	GetDayDocumentProcess_new(dc.DateOverdue, d.Status, d.IsSuccess, d.IsReturned) as `NumberDayOverdue`, \r\n	GetDayDocumentProcess_new(d.DateAppointed, d.Status, d.IsSuccess, d.IsReturned) as  `NumberDayAppointed`, \r\n	`dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\nAND d.CategoryBusinessId  = 2\r\nAND `dc`.`DocumentCopyType` =1 \r\nand d.DocCode is not null and d.DocCode != \'\' \r\nORDER BY `dc`.`DateReceived` DESC Limit 0, 200;', 'SELECT dc.`DocumentCopyId`\r\nFROM `documentcopy` as `dc`\r\nJoin `document` as `d` on dc.DocumentId = d.DocumentId\r\nWHERE dc.`DocumentCopyId` IN ({0}) or `d`.CategoryBusinessId != 2\r\nor d.DocCode is null or d.DocCode = \'\' \r\n', '-- Văn bản chờ xử lý mặc định là lấy ra tất cả\r\nSELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nWHERE `dc`.`Status` = 2 \r\nAND d.CategoryBusinessId  = 2\r\nAND `dc`.`DocumentCopyType` =1 \r\nand d.DocCode is not null and d.DocCode != \'\' \r\nORDER BY `dc`.`DateReceived` DESC Limit 0, 200;', 'SELECT 0;\r\n\r\n', 'SELECT `d`.*, `dc`.`DateReceived`, `dc`.`DocumentCopyId`, `dc`.`LastComment` as `LastComment`,`dc`.`DocumentCopyType`,`dc`.Status as`DocCopyStatus`,`df`.`DocFinishType`, `df`.`IsViewed`,`df`.`IsDocumentImportant`,`u`.`FullName` as `UserCurrentFullName`, `u`.`FirstName` as `UserCurrentFirstName`,`dc`.UserCurrentId , DATEDIFF(Now(),dc.DateOverdue) AS `NumberDayOverdue` , DATEDIFF(Now(),d.DateAppointed) AS `NumberDayAppointed`, `dc`.`WorkflowId`, `dc`.`NodeCurrentId`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId` \r\nINNER JOIN `user` as `u` ON `d`.`UserCreatedId` = `u`.`UserId` \r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId` AND `dc`.UserCurrentId = `df`.UserId \r\nWHERE `dc`.`Status` = 2 AND d.CategoryBusinessId != 4 AND `dc`.`UserCurrentId` = @userId AND `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64) AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)  \r\nORDER BY `dc`.`DateReceived` DESC LIMIT @skip,@take', '', '', '1', null, null, '', '', '0', '2016-12-22', '3', '', '', '1', null, '', null, '165', '192');
INSERT INTO `processfunction` VALUES ('237', '33', null, 'Văn bản đến', null, null, 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`,`dc`.`DateReceived`, \r\n`dc`.`DocumentCopyId`,`dc`.`DocumentCopyType`, \r\n`dc`.`Status`  as`DocCopyStatus`,`dc`.UserCurrentId , \r\n0 as `IsViewed`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `authorize` as `au` on `au`.AuthorizeUserId = `dc`.UserCurrentId AND `au`.`Active` = 1\r\nWHERE  `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\n   and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n     and `dc`.UserCurrentId = `au`.AuthorizeUserId \r\n	   and `dc`.`Status` IN (2, 16) AND d.CategoryBusinessId != 4 \r\n		 AND NOW() >= `au`.`DateBegin` \r\n		 AND NOW() <= `au`.`DateEnd` \r\n		 AND  `au`.`AuthorizeUserId` in ({0} )     \r\n		AND `dc`.`DateReceived` >= @toDate \r\n     ORDER BY `dc`.`DateReceived` DESC', 'SELECT d.Status, `d`.`Compendium`, `d`.`DateCreated`,`d`.`DocTypeId`, `d`.`CategoryBusinessId`, `dc`.`DateReceived`, \r\n`dc`.`DocumentCopyId`,`dc`.`DocumentCopyType`, \r\n`dc`.`Status`  as`DocCopyStatus`,`dc`.UserCurrentId , \r\n0 as `IsViewed`\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `authorize` as `au` on `au`.AuthorizeUserId = `dc`.UserCurrentId AND `au`.`Active` = 1\r\nWHERE  `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\n    and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n     and `dc`.UserCurrentId = `au`.AuthorizeUserId  AND d.CategoryBusinessId != 4 \r\n	   and `dc`.`Status` IN (2, 16)\r\n		 AND NOW() >= `au`.`DateBegin` \r\n		 AND NOW() <= `au`.`DateEnd`  AND `au`.`AuthorizeUserId` in ({0} ) \r\n      AND `dc`.`DateReceived` <= @fromDate \r\n     ORDER BY `dc`.`DateReceived` DESC LIMIT 0,100;', 'SELECT   `DocumentCopyId`  \r\n FROM `documentcopy` as `dc`\r\nINNER JOIN  `authorize` as `au`  ON `dc`.`UserCurrentId` = `au`.`AuthorizeUserId` \r\nWHERE\r\n(`au`.`AuthorizeUserId` not  in ({0}) OR (`au`.`AuthorizeUserId` in ({0})  AND dc.`Status` != 2))\r\n AND dc.`DocumentCopyId` IN ({1})', 'SELECT Count(1)\r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `authorize` as `au` on `au`.AuthorizeUserId = `dc`.UserCurrentId AND `au`.`Active` = 1\r\nWHERE  `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\n    and (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n     and `dc`.UserCurrentId = `au`.AuthorizeUserId  AND d.CategoryBusinessId != 4 \r\n	   and `dc`.`Status` IN (2, 16)\r\n		 AND NOW() >= `au`.`DateBegin` \r\n		 AND NOW() <= `au`.`DateEnd`  AND `au`.`AuthorizeUserId` in ({0} ) ;', 'SELECT 0;', 'SELECT `d`.*, `dc`.`DateReceived`, \r\n`dc`.`DocumentCopyId`,`dc`.`DocumentCopyType`, \r\n`dc`.`Status`  as`DocCopyStatus`,`dc`.UserCurrentId , \r\n`df`.`IsViewed`,`df`.`IsDocumentImportant` \r\nFROM `document` as `d` \r\nINNER JOIN `documentcopy` as `dc` ON `d`.`DocumentId` = `dc`.`DocumentId`\r\nINNER JOIN `docfinish` as `df` ON `dc`.`DocumentCopyId` = `df`.`DocumentCopyId`  AND `dc`.UserCurrentId = `df`.UserId \r\nINNER JOIN `authorize` as `au` on `au`.AuthorizeUserId = `df`.UserId AND `au`.`Active` = 1\r\nWHERE  `dc`.`DocumentCopyType` in (1, 2, 4, 32, 64)\r\nand (`au`.`DocTypeId` IS NULL OR `au`.`DocTypeId` =\'\' or  `au`.DocTypeId  like CONCAT(\'%\', `d`.`DocTypeId`,\'%\'))\r\n     and `dc`.UserCurrentId = `au`.AuthorizeUserId \r\n	   and `dc`.`Status` IN (2, 16)\r\n		 AND NOW() >= `au`.`DateBegin` \r\n		 AND NOW() <= `au`.`DateEnd` \r\n		 AND `au`.`AuthorizeUserId` in ({0} ) \r\n      AND `dc`.`DateReceived` <= @fromDate \r\n     AND (@quicksearch = \'\' OR `Compendium` LIKE @quicksearch)\r\n    ORDER BY `dc`.`DateReceived` DESC\r\n     LIMIT @skip,@take', '', '', '0', null, null, '', '', '0', '2016-12-22', '3', '', '', '1', null, '', null, '29', '1');
