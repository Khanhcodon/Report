function getColorCode(n){return n?(n.toUpperCase().charCodeAt(0)+randomInt)%10:randomInt%10}function getDefaultAvatar(){egov.mobile&&(title=egov.mobile.avatarTheme);switch(title){case"troll":return String.format(getResource("egov.resources.avatar.troll"),Math.floor(Math.random()*6)+1);case"icon":return String.format(getResource("egov.resources.avatar.icon"),Math.floor(Math.random()*2)+1);case"alphabet":return String.format(getResource("egov.resources.avatar.alphabet"),account[0].toLowerCase());default:return getResource("egov.resources.avatar.noData")}}function getUserAvatar(n,t){return n?String.format(egov.resources.avatar.path,t):getDefaultAvatar()}function getErrorAvatar(){return getResource("egov.resources.avatar.errorUrl")}function Base(){}function ChromeNativeApp(){Base.call(this)}function PluginFactory(){}jQuery.fn.bindResources=function(n,t){t=!0;var i=this.find("*[data-res]"),r=this.find("*[data-restitle]"),u=this.find("*[data-respholder]");return(i.length>0||r.length>0||u.length>0)&&($.each(i,function(n,i){var u=$(i).attr("data-res"),f,r;try{eval(u)&&(t||$(i).removeAttr("data-res"),$(i).prop("tagName").toLowerCase()==="input"?(f=$(i).val().trim(),$(i).val(eval(u))):(f=$(i).text().trim(),$(i).text(eval(u))))}catch(e){r=JSON.stringify(u).split(".");r=r[r.length-2]+"."+r[r.length-1];t||$(i).removeAttr("data-res");$(i).prop("tagName").toLowerCase()==="input"?$(i).val(r):$(i).text(r)}}),$.each(r,function(n,i){var u=$(i).attr("data-restitle"),r;try{eval(u)&&(t||$(i).removeAttr("data-restitle"),$(i).attr("title",eval(u)))}catch(f){r=JSON.stringify(u).split(".");r=r[r.length-2]+"."+r[r.length-1];t||$(i).removeAttr("data-restitle");$(i).attr("title",r)}}),$.each(u,function(n,i){var u=$(i).attr("data-respholder"),r;try{eval(u)&&(t||$(i).removeAttr("data-respholder"),$(i).attr("placeholder",eval(u)))}catch(f){r=JSON.stringify(u).split(".");r=r[r.length-2]+"."+r[r.length-1];t||$(i).removeAttr("data-respholder");$(i).attr("placeholder",r)}})),typeof n=="function"&&n(),this};window.getResource=function(n){try{return eval(n)}catch(t){return n}};var extend=function(n,t){for(var i in t)t[i]&&t[i].constructor&&t[i].constructor===Object?(n[i]=n[i]||{},arguments.callee(n[i],t[i])):n[i]=t[i];return n},randomInt=Math.floor(Math.random()*10);(function(n){"use strict";var t=["áàảãạăắằẳẵặâấầẩẫậ","ÁÀẢÃẠĂẮẰẲẴẶÂẤẦẨẪẬ","đ","Đ","éèẻẽẹêếềểễệ","ÉÈẺẼẸÊẾỀỂỄỆ","íìỉĩị","ÍÌỈĨỊ","óòỏõọơớờởỡợôốồổỗộ","ÓÒỎÕỌƠỚỜỞỠỢÔỐỒỔỖỘ","ưứừửữựúùủũụ","ƯỨỪỬỮỰÚÙỦŨỤ","ýỳỷỹỵ","ÝỲỶỸỴ"],i=["a","A","d","D","e","E","i","I","o","O","u","U","y","Y"];n.utils=n.utils||{};n.log=function(n){typeof console!="undefined"&&typeof console.log!="undefined"&&console.log(n)};n.toJSON=function(n){return typeof n=="string"?JSON.parse(n):n};n.getKeyName=function(t){var i;return i=t.id===undefined||t.id===null?t.name:t.name+"_"+t.id,i+("_"+n.userid)};n.callback=function(n,t){n&&typeof n=="function"&&n(t)};n.getRelativeEndpointUrl=function(t){var i,u=function(n){return n===null||n===undefined?"":n.split("/")},f=function(n,t){for(i=0;i<t.length;i+=1)t[i].length>0&&(n+="/"+t[i]);return n},e=u(n.rootUrl),o=u(t),r="";return t?t.indexOf(n.rootUrl||"")===0?t:(r=f(r,e),f(r,o)):""};n.toPrettyDate=function(n){var r,t,i;if(typeof n!="object"&&(n=new Date(n)),r=new Date,t=(r.getTime()-n.getTime())/1e3,i=Math.floor(t/86400),i===0){if(t<60)return"Mới gửi";if(t<120)return"1 phút trước.";if(t<3600)return Math.floor(t/60)+" phút trước.";if(t<7200)return"1 giờ trước.";if(t<86400)return Math.floor(t/3600)+" giờ trước."}else{if(i===1)return Globalize.format(n,"hh:mm tt")+" hôm qua.";if(i>1&&i<=7)return Globalize.format(n,"hh:mm tt")+" "+Globalize.format(n,"dd")+" ngày trước."}return Globalize.format(n,"dd/MM/yyyy hh:mm tt")};n.toServerDate=function(n){return n.toISOString()};n.mergeArraysByProperty=function(n,t,i){return _.each(t,function(t){var r=_.find(n,function(n){return n[i]===t[i]});r?_.extend(r,t):n.push(t)}),n};n.containFlags=function(n,t){return(n&t)===t};n.contain=function(t,i){return typeof t!="string"||typeof i!="string"?(n.log("Tham số đầu vào không hợp lệ."),!1):t.indexOf(i)>-1};n.getWordCount=function(n){return n=n.trim(),n.split(" ").length};n.stripVietnameseChars=function(r){var u;return u=r.split(""),_.each(u,function(r){_.each(t,function(t,u){n.contain(t,r)&&(r=i[u])})}),u.join("")};n.sortByValue=function(n,t,i,r){var f,e,u;if(typeof n=="object")return(f=[],e=_.find(n,function(n){return n[t]===i}),e)?(f.push(e),u=_.reject(n,function(n){return n[t]===i}),u=_.sortBy(u,function(n){return n[r]}),_.union(f,u)):void 0};n.getLevelOfDept=function(n){return n.split(".").length}})(this.egov=this.egov||{}),function(n){n.enum={categoryBusiness:{vbden:1,vbdi:2,hsmc:4,kntc:8},urgents:{thuong:1,khan:2,hoatoc:3},securityLevel:{thuong:1,mat:2,toimat:3},transferType:{xulychinh:1,dongxuly:2,thongbao:3,xyk:4,giamsat:5},documentTransferType:{taoMoiThongThuong:1,banGiaoThongThuong:2,banGiaoKhiTraLoi:4,banGiaoKhiPhanLoai:8},documentListSize:{small:0,medium:1,large:2},documentViewType:{"default":0,preView:1,dialog:2},quickViewType:{hide:0,right:1,below:2},documentOriginal:{egov:0,egovOnline:1,other:2},fontSizeType:{nho:0,vua:1,lon:2},searchType:{document:1,file:2},processFilterType:{group:1,equal:2,custom:3},documentStatus:{DuThao:1,DangXuLy:2,KetThuc:4,LoaiBo:8,DungXuLy:16},permission:{khoitaovanban:1,xemvanban:2,dinhkem:4,suavanban:8,guiykien:16,bangiao:32,thongbao:64,xinykien:128,phanloai:256,traloivanban:512,laylaivanban:1024,xacnhanbangiao:2048,xacnhanxuly:4096,yeucaubosung:8192,tiepnhanbosung:16384,kyduyet:32768,traketqua:65536,giahanxuly:131072,dungxuly:262144,ketthucxuly:524288,huyvanban:1048576,luuhosocanhan:2097152,luuso:4194304,phathanh:8388608,capnhatketquaxulycuoi:16777216,luuvanban:33554432,traloiykien:67108864,capphep:134217728,doihanxulykhiphanloai:268435456,molaivanban:536870912,danhlaisoden:1073741824,xoavanbankhoihoso:2147483648},actionSpecial:{thongThuong:{name:"ThongThuong",value:0},luuSoVaPhatHanhNoiBo:{name:"LuuSoVaPhatHanhNoiBo",value:1},luuSoNoiBo:{name:"LuuSoNoiBo",value:2},luuSoVaPhatHanhRaNgoai:{name:"LuuSoVaPhatHanhRaNgoai",value:3},chuyenNguoiKhoiTao:{name:"ChuyenNguoiKhoiTao",value:4},chuyenYKienDongGopVbDxl:{name:"ChuyenYKienDongGopVbDxl",value:5},tiepTucXuLy:{name:"TiepTucXuLy",value:6},chuyenNguoiCoQuyenDongGopYKien:{name:"ChuyenNguoiCoQuyenDongGopYKien",value:7},tiepNhanHoSo:{name:"TiepNhanHoSo",value:8},tiepNhanHoSoVaTiepTuc:{name:"TiepNhanHoSoVaTiepTuc",value:9},capNhatKetQuaDungXuLy:{name:"CapNhatKetQuaDungXuLy",value:10},chuyenYKienDongGopVbXinYKien:{name:"ChuyenYKienDongGopVbXinYKien",value:11},chuyenNguoiGui:{name:"ChuyenNguoiGui",value:12},tiepNhanBoSung:{name:"TiepNhanBoSung",value:13},lienThong:{name:"LienThong",value:14},transferMultiple:{name:"TransferMultiple",value:15}},commentType:{Common:1,Consulted:2,Contribution:3,Supplementary:4,Signed:5,Success:6,Finished:7},formType:{html:1,dynamic:2,fromUrl:3},language:{VietNam:1,Laos:2},defaultToolbar:{Create:1,Edit:2,InsertImagePacket:3},commonTemplate:{InBienNhanBanGiao:1}};n.enum.feeType={TiepNhan:1,ThuongBosung:2,TraCongDan:3};n.enum.paperType={TiepNhan:1,ThuongBosung:2,TraCongDan:3};n.enum.supplementaryType={renew:1,"continue":2,add:3};n.enum.printProcessType={TiepNhan:1,BanGiao:2,KyDuyet:4,TraKetQua:8,TiepNhanBoSung:16,GiaHan:32}}(this.egov=this.egov||{}),function(n,t){"use strict";var i=function(){var n;this.profilers=[];this.dataDefaults={type:"GET",async:!0,traditional:!1};n=_.find(_.groupBy(r,function(n){return n.url}),function(n){return n.length>1});n!=null&&(console.log("Lặp url, kiểm tra lại để đảm bảo không bị lặp: "),console.log(n));n=_.find(_.groupBy(r,function(n){return n.name}),function(n){return n.length>1});n!=null&&(console.log("Lặp tên query, kiểm tra lại để đảm bảo không bị lặp"),console.log(n));this.model=r;this.setDefaultAjaxSetting();this.init();this._profilers()},r;i.prototype.setDefaultAjaxSetting=function(){};i.prototype.init=function(){var n=this,t;return this.aborts={},_.each(this.model,function(i){t=i.name;n[t]=function(t){var r=i.name+JSON.stringify(t.data)+"processing";n._exeQuery(i,t)}}),this};i.prototype._exeQuery=function(i,r){var o,f,l,e,s,h,c,u=this;e=i.name+JSON.stringify(r.data);f=$.extend({},u.dataDefaults);i.async!==undefined&&(f.async=i.async);f.async=!0;i.traditional!==undefined&&(f.dataType="json",f.traditional=i.traditional);i.hasToken!==undefined&&(l="#"+i.url.replace(/\//g,""),r.data.__RequestVerificationToken=$("input[name='__RequestVerificationToken']",l).val());s=r.beforeSend;r.beforeSend=function(n,t){u[e]=!0;u.profilers.push({processName:e,Name:t.url,Started:new Date});typeof s=="function"&&s()};c=r.success;r.success=function(n){var t=_.find(u.profilers,function(n){return n.processName===e});t&&(t.durations=new Date-t.Started);delete u[e];typeof c=="function"&&c(n)};h=r.complete;r.complete=function(){console.log(u.profilers);delete u[e];typeof h=="function"&&h()};r.data=r.data||{};r.data.puid=n.userid;o=$.extend({},f,i,r);t&&!n.isMobile&&(t.options.checks={xhr:o});this.aborts[i.name]=$.ajax(o)};i.prototype._profilers=function(){setInterval(function(){if(this.profilers.length!==0){var n=_.map(this.profilers,function(n){return{Name:n.Name,Started:n.Started.toServerString(),DurationMilliseconds:n.durations}});this.profilers=[];$.ajax({url:"/profiler/updateclient",type:"Post",data:{json:JSON.stringify(n)},complete:function(){}})}}.bind(this),5e3)};r=[{name:"getDataCompile",url:"/Document/GetDataCompile"},{name:"getAllUsers",url:"/Common/GetAllUsers"},{name:"getCategories",url:"/Common/GetCategories"},{name:"getDepartmentsByUser",url:"/Common/GetDepartmentsByUser"},{name:"getDepartmentsCurrent",url:"/Common/GetCurrentDepartments"},{name:"getAllDepartment",url:"/Common/GetAllDepartment"},{name:"getAllJobTitlies",url:"/Common/getAllJobTitlies"},{name:"getAllUserDepartmentJobTitlesPosition",url:"/Common/GetAllUserDepartmentJobTitlesPosition"},{name:"getAllPosition",url:"/Common/GetAllPosition"},{name:"getAllAddress",url:"/Common/GetAllAddress"},{name:"getKeywords",url:"/Common/GetKeywords"},{name:"getDocField",url:"/Common/GetDocField"},{name:"getSendTypes",url:"/Common/GetSendTypes"},{name:"getDeptAndUsers",url:"/Common/GetDeptAndUsers"},{name:"GetCodes",url:"/Common/GetCodes",type:"Get"},{name:"getOrganizations",url:"/Common/GetOrganizations",type:"Get"},{name:"editNew",url:"/Document/EditNew/",type:"Get"},{name:"getFormContent",url:"/Document/GetFormContent"},{name:"getFormUrl",url:"/Document/GetFormUrl"},{name:"confirmTransfer",url:"/Document/ConfirmTransfer",type:"Post",hasToken:!0},{name:"confirmProcess",url:"/Document/ConfirmProcess",type:"Post",hasToken:!0},{name:"getDocumentRelations",url:"/document/GetDocumentRelations",type:"Get"},{name:"renewals",url:"/Document/Renewals",type:"Post"},{name:"getDocumentPermission",url:"/Document/GetDocumentPermission",traditional:!0,async:!0},{name:"getDocumentInfoForEdit",url:"/Document/GetDocumentDetail"},{name:"getMultiDocument",url:"/Document/GetDocumentDetails",traditional:!0},{name:"getDocumentInfoForMobile",url:"/Document/getDocumentInfoForMobile"},{name:"getDocumentInfoForCreateMobile",url:"/Document/GetDocumentInfoForCreateMobile"},{name:"getDocumentInfoForCreate",url:"/Document/GetDocumentInfoForCreate"},{name:"getContextItemForUndoTransfering",url:"/Document/GetContextItemForUndoTransfering/"},{name:"removeDocument",url:"/Document/RemoveDocument",type:"Post",hasToken:!0,traditional:!0},{name:"undoTransfering",url:"/Document/UndoTransfering",type:"Post",hasToken:!0},{name:"getUsersForUndoTransfering",url:"/Document/GetUsersForUndoTransfering"},{name:"setDocumentViewed",url:"/Document/SetViewed/",type:"Post"},{name:"editDocumentOnline",url:"/Document/EditDocumentOnline/"},{name:"editDocumentContent",url:"/Document/EditContent/",type:"Post"},{name:"getDocumentContentVersion",url:"/Document/getDocumentContentVersion",type:"Get"},{name:"getCommonComments",url:"/Document/GetCommonComments/"},{name:"getTemplateComments",url:"/Document/GetTemplateComments/"},{name:"createTemplateComments",url:"/Document/CreateTemplateComments/",type:"Post"},{name:"updateTemplateComments",url:"/Document/UpdateTemplateComments",type:"post"},{name:"deleteTemplateComments",url:"/Document/DeleteTemplateComments",type:"post"},{name:"searchDocuments",url:"/Document/SearchDocuments",type:"Post",traditional:!0},{name:"setDocumentImportant",url:"/Document/SetDocumentImportant",type:"Post"},{name:"quickViewDocument",url:"/Home/QuickViewDocument",type:"Get"},{name:"getDocumentTemplate",url:"/Document/GetDocumentTemplate",type:"Get"},{name:"getCatalog",url:"/Document/GetCatalog",type:"Get"},{name:"updateLastResult",url:"/Document/UpdateLastResult",type:"Post"},{name:"createImagesFromBeginAndLastPdfPages",url:"/Document/CreateImagesFromBeginAndLastPdfPages",type:"Get"},{name:"GetDocumentInfoFromScan",url:"/Parallel/GetDocumentInfoFromScan",type:"Get",traditional:!0},{name:"getImageTemp",url:"/Document/GetImageTemp",type:"Get"},{name:"cancelCode",url:"/Document/CancelCode",type:"Get"},{name:"GetDocCodes",url:"/Document/GetDocCodes",type:"Get"},{name:"GetInOutCode",url:"/Document/GetInOutCode",type:"Get"},{name:"GetIsTransferPublish",url:"/Document/GetIsTransferPublish",type:"Get"},{name:"deleteDocPaper",url:"/Document/DeleteDocPaper",type:"Post"},{name:"deleteDocFee",url:"/Document/DeleteDocFee",type:"Post"},{name:"acceptThuHoi",url:"/Document/AcceptThuHoi",type:"Post"},{name:"getDoctype",url:"/Doctype/GetDocType"},{name:"getDocTypes",url:"/Doctype/GetDocTypes"},{name:"getDoctypePaperAndFees",url:"/Doctype/GetPaperAndFees"},{name:"updateDoctypePaperAndFees",url:"/Doctype/UpdatePaperAndFees",type:"Post"},{name:"deleteDoctypePaper",url:"/Document/DeleteDoctypePaper",type:"Post"},{name:"deleteDoctypeFee",url:"/Document/DeleteDoctypeFee",type:"Post"},{name:"checkDocCodeIsUsed",url:"/Document/CheckDocCodeIsUsed"},{name:"GetListUser",url:"/Mission/GetListUser",type:"Get"},{name:"CreateMission",url:"/Mission/CreateMission",type:"post",traditional:!0,async:!0},{name:"LinkDetailMission",url:"/Mission/LinkDetailMission",type:"post",traditional:!0,async:!0},{name:"downloadAttachmentTemp",url:"/Attachment/DownloadAttachmentTempBase64",type:"Get"},{name:"downloadAttachment",url:"/Attachment/DownloadAttachmentBase64",type:"Get"},{name:"downloadAttachmentForSignBase64",url:"/Attachment/DownloadAttachmentForSignBase64",type:"Get",traditional:!0},{name:"uploadTempScan",url:"/Attachment/UploadTempScan",type:"Post"},{name:"getDocumentEditAction",url:"/Workflow/GetActionsEdit",type:"Get"},{name:"getDocumentCreateAction",url:"/Workflow/GetActionsCreate",type:"Get"},{name:"getUserByAction",url:"/Workflow/GetUserByAction",type:"Get"},{name:"getActionsTransferPlan",url:"/Workflow/GetActionsTransferPlan",type:"Get"},{name:"getUserByActionTheoLo",url:"/Workflow/GetUserByActionTheoLo",type:"post",traditional:!0},{name:"getActionTheoLoVanBan",url:"/Workflow/GetActionTheoLoVanBan",type:"post",traditional:!0,async:!0},{name:"transfer",url:"/Transfer/TransferDocument",type:"Post",traditional:!0,hasToken:!0},{name:"surveyRelease",url:"/Transfer/SurveyReleased",type:"Post",traditional:!0,hasToken:!0},{name:"surveyComplete",url:"/Transfer/SurveyComplete",type:"Post",traditional:!0,hasToken:!0},{name:"surveySaveReport",url:"/Transfer/SurveySaveReport",type:"Post",traditional:!0,hasToken:!0},{name:"transferTheoLo",url:"/Transfer/TransferMultiple",type:"Post",traditional:!0,hasToken:!0},{name:"lightTransfer",url:"/Transfer/LightTransfer",type:"Post"},{name:"TransferYKienDongGop",url:"/Transfer/TransferAnswer",type:"Post",traditional:!0,hasToken:!0},{name:"TransferTiepNhan",url:"/Transfer/TransferTiepNhan",type:"Post",traditional:!0,hasToken:!0},{name:"TransferAnnouncement",url:"/Transfer/TransferAnnouncement",type:"Post",traditional:!0,hasToken:!0},{name:"TransferConsult",url:"/Transfer/TransferConsult",type:"Post",traditional:!0,hasToken:!0},{name:"publishGov",url:"/Publish/TransferPublishGov",type:"Post",traditional:!0,hasToken:!0},{name:"publish",url:"/Publish/TransferPublish",type:"Post",traditional:!0,hasToken:!0},{name:"privatePublish",url:"/Publish/TransferPrivatePublish",type:"Post",traditional:!0,hasToken:!0},{name:"privatePublishTheoLo",url:"/Publish/TransferPrivatePublishTheoLo",type:"Post",traditional:!0},{name:"publishTheoLo",url:"/Publish/TransferPublishTheoLo",type:"Post",traditional:!0,hasToken:!0},{name:"publishmentPlan",url:"/Publish/PublishmentPlan",type:"Post"},{name:"rePublish",url:"/Publish/RePublish",type:"Post",traditional:!0},{name:"saveDoc",url:"/Transfer/SaveDoc",type:"Post",hasToken:!0,traditional:!0},{name:"saveDocDraft",url:"/Transfer/SaveDocDraft",type:"Post",hasToken:!0},{name:"transferLienThong",url:"/Publish/transferLienThong",type:"Post",hasToken:!0,traditional:!0},{name:"recalledLienThong",url:"/Publish/RecalledLienThong",type:"Post",hasToken:!0,traditional:!0},{name:"resendLienThong",url:"/Transfer/ResendLienThong",type:"Post",hasToken:!0,traditional:!0},{name:"sendComment",url:"/Document/SendComment",type:"Post",hasToken:!0},{name:"finish",url:"/Finish/UpdateFinish",type:"Post",hasToken:!0},{name:"undoFinish",url:"/Finish/UndoFinish",type:"Post"},{name:"approverSend",url:"/Approver/Send",type:"Post",hasToken:!0},{name:"deleteApprover",url:"/Approver/deleteApprover",type:"Post",hasToken:!0},{name:"deleteResult",url:"/Document/DeleteResult",type:"Post",hasToken:!0},{name:"getNodeQuestion",url:"/Question/GetNode",type:"Get"},{name:"getsQuestion",url:"/Question/GetQuestions",type:"Get"},{name:"answerQuestion",url:"/Question/Answer",type:"POST"},{name:"rejectQuestion",url:"/Question/Reject",type:"POST"},{name:"forwardQuestion",url:"/Question/ForwardQuestion",type:"POST"},{name:"rejectAnswer",url:"/Question/RejectAnswer",type:"POST"},{name:"getForwardList",url:"/Question/GetForwardList",type:"Get"},{name:"getsHolderList",url:"/Question/GetsHolderList",type:"Get"},{name:"GetStores",url:"/Common/GetStores",type:"Get"},{name:"getStorePrivate",url:"/StorePrivate/Gets",type:"Get"},{name:"createStorePrivate",url:"/StorePrivate/Create",type:"Post",hasToken:!0,traditional:!0},{name:"updateStorePrivate",url:"/StorePrivate/Update",type:"Post",hasToken:!0,traditional:!0},{name:"anycStoreShare",url:"/StorePrivate/AnycStoreShare",type:"Get"},{name:"openStorePrivate",url:"/StorePrivate/Open",type:"Post",hasToken:!0},{name:"closeStorePrivate",url:"/StorePrivate/Close",type:"Post",hasToken:!0},{name:"deleteStorePrivate",url:"/StorePrivate/Delete",type:"Post",hasToken:!0},{name:"getStorePrivateDocuments",url:"/StorePrivate/GetDocuments",type:"Post"},{name:"removeStorePrivateDocument",url:"/StorePrivate/RemoveDocuments",type:"Post",traditional:!0},{name:"getUserJoined",url:"/StorePrivate/GetUserJoined",type:"Get"},{name:"SaveDocumentToStorePrivate",url:"/Document/SaveDocumentToStorePrivate",type:"Post",hasToken:!0},{name:"storePrivateOpenFile",url:"/StorePrivate/DownloadAttachmentBase64",type:"Get"},{name:"storePrivateRemoveFile",url:"/StorePrivate/RemoveAttachment",type:"post",hasToken:!0},{name:"removeDocumentAnnouncement",url:"/Document/RemoveDocumentAnnouncement",type:"post"},{name:"getDocumentStore",url:"/Home/GetDocumentStore"},{name:"getDocumentTree",url:"/Home/GetFunctionByParentId",type:"get"},{name:"getDocumentTreeHasTransferTheoLo",url:"/Home/GetFunctionHasTransferTheoLoByParentId",type:"get"},{name:"syncDocumentStore",url:"/Home/SyncDocumentStore"},{name:"getFunctionGroups",url:"/Home/GetFunctionGroups"},{name:"getCommonConfigs",url:"/Home/GetCommonConfigs",type:"Get"},{name:"hasHideSaveStore",url:"/Home/HasHideSaveStore",type:"Post"},{name:"getDateAppointed",url:"/Document/GetDateAppointed",type:"Post"},{name:"setUserConfig",url:"/Account/SetUserConfig/",type:"Post"},{name:"setPopUpSize",url:"/Account/setPopUpSize/",type:"Post"},{name:"filterCitizen",url:"/Document/FilterCitizen/",type:"Get"},{name:"print",url:"/Print/Index",type:"Get"},{name:"previewPrint",url:"/Print/PreviewPrint",type:"Get"},{name:"getPrints",url:"/Print/GetPrints",type:"Get"},{name:"getPrintTemplates",url:"/Print/GetPrintTemplates",type:"Get"},{name:"getPrintByDocCopys",url:"/Print/GetPrintByDocCopys",type:"Get"},{name:"quickPrint",url:"/Print/QuickPrint",type:"Get"},{name:"getPrinters",url:"/Print/GetActivePrinters",type:"Get"},{name:"printTransferHistory",url:"/Print/PrintTransferHistory",type:"Get"},{name:"getReturnResult",url:"/Return/GetReturnResult",type:"Get"},{name:"updateReturn",url:"/Return/UpdateReturn",type:"Post"},{name:"createSupplementary",url:"/Supplementary/CreateSupplementary",type:"Get"},{name:"receiveSupplementary",url:"/Supplementary/GetDetails",type:"Get"},{name:"supplementaryReceive",url:"/Supplementary/Receive",type:"Post"},{name:"getNewDateAppointed",url:"/Supplementary/GetDateAppointed",type:"Get"},{name:"sendRequiredSupplementary",url:"/Supplementary/SendRequire",type:"Post",hasToken:!0},{name:"cancelReceiveSupplementary",url:"/Supplementary/CancelReceive",type:"Post",hasToken:!0},{name:"continueProcess",url:"/Supplementary/continueProcess",type:"Post"},{name:"quickSearch",url:"/Search/QuickSearch",type:"Get",traditional:!0},{name:"getMailTemplates",url:"/Document/GetMailTemplates",type:"Get"},{name:"getSmsTemplates",url:"/Document/GetSmsTemplates",type:"Get"},{name:"sendMailToPeople",url:"/Document/SendMailToPeople",type:"Post"},{name:"sendSmsToPeople",url:"/Document/SendSmsToPeople",type:"Post"},{name:"getVersionValue",url:"/Home/GetVersionValue",type:"Get"},{name:"getTotalDocumentUnreadMultiFunction",url:"/Parallel/GetTotalDocumentUnreadMultiFunction",type:"Post"},{name:"getTotalDocumentUnread",url:"/Home/GetTotalDocumentUnread",type:"Post"},{name:"getDocuments",url:"/home/GetDocuments",type:"Post"},{name:"getAllDocument",url:"/Home/GetAllDocument",type:"Post"},{name:"getDocumentPaging",url:"/Home/GetDocumentPaging",type:"Post"},{name:"getLastestDocuments",url:"/Home/GetLastestDocuments",type:"Post",traditional:!0},{name:"getLastestReports",url:"/HomeSMReport/GetLastestDocuments",type:"Post",traditional:!0},{name:"getReports",url:"/HomeSMReport/GetDocuments",type:"Post",traditional:!0},{name:"searchAdvance",url:"/Search/SearchAdvance",type:"Get",traditional:!0},{name:"getSearchAdvanceForm",url:"/Search/GetSearchAdvanceForm",type:"Get"},{name:"getDiffVersionTrees",url:"/Home/DiffVersionTree",type:"Get"},{name:"acceptOnline",url:"/DocumentOnline/AcceptOnline",type:"Post"},{name:"rejectOnline",url:"/DocumentOnline/RejectOnline",type:"Post"},{name:"onlineSupplementary",url:"/DocumentOnline/OnlineSupplementary",type:"Post"},{name:"additionalRequirements",url:"/DocumentOnline/AdditionalRequirements",type:"Post"},{name:"getTotalOnlineRegistration",url:"/DocumentOnline/GetTotalOnlineRegistration",type:"Get"},{name:"getDocumentOnlineRegistration",url:"/DocumentOnline/GetDocumentOnlineRegistration",type:"Get"},{name:"getTotalOnlineCancel",url:"/DocumentOnline/GetTotalOnlineCancel",type:"Get"},{name:"getDocumentOnlineCancel",url:"/DocumentOnline/GetDocumentOnlineCancel",type:"Get"},{name:"getDocumentDetailOnlineRegistration",url:"/DocumentOnline/GetDocumentDetailOnlineRegistration",type:"Get"},{name:"checkDocumentOnline",url:"/DocumentOnline/CheckDocumentOnline/",type:"Get"},{name:"checkDocument",url:"/DocumentOnline/CheckDocument/",type:"Get"},{name:"reOpenDocument",url:"/Document/ReOpenDocument",type:"Get"},{name:"exportToFile",url:"/Home/ExportToFile",type:"Post"},{name:"editTemplate",url:"/Document/EditTemplate",type:"Get"},{name:"notificationsCount",url:"/Mobile/GetNotificationsCount",type:"Get"},{name:"setMobileUserConfig",url:"/Account/SetMobileUserConfig/",type:"Post",hasToken:!0},{name:"removeAttachment",url:"/Attachment/RemoveAttachment",type:"Post"},{name:"getTotalGeneralQuestion",url:"/Question/GetTotal?isGetGeneral=true",type:"Get"},{name:"getTotalDocumentQuestion",url:"/Question/GetTotal?isGetGeneral=false",type:"Get"},{name:"getBusinessLicense",url:"/BusinessLicense/BusinessLicenses",type:"Get"},{name:"removeBusinessLicense",url:"/BusinessLicense/RemoveLicenses",type:"Post",traditional:!0},{name:"createCitizen",url:"/BusinessLicense/CreateCitizen",type:"Post",traditional:!0},{name:"createLicense",url:"/BusinessLicense/CreateLicense",type:"Post",traditional:!0},{name:"createInvoice",url:"/DocumentInvoice/ImportInvoice",type:"Post"},{name:"getInvoice",url:"/DocumentInvoice/LookupInvoice",type:"Get"},{name:"getDetailInvoice",url:"/DocumentInvoice/DetailInvoice",type:"Get"},{name:"removeInvoice",url:"/DocumentInvoice/RemoveInvoice",type:"Post"},{name:"createVote",url:"/Referendum/Vote",type:"Post",traditional:!0},{name:"updateVote",url:"/Referendum/VoteUpdate",type:"Post",traditional:!0},{name:"deleteVote",url:"/Referendum/DeleteVote",type:"Post",traditional:!0},{name:"getVotes",url:"/Referendum/GetVotes",type:"Get"},{name:"getVoteDetail",url:"/Referendum/GetVoteDetail",type:"Get"},{name:"createCommentDiff",url:"/Referendum/CreateCommentDiff",type:"Post",traditional:!0},{name:"checkVote",url:"/Referendum/CheckVote",type:"Post",traditional:!0},{name:"checkVoteResult",url:"/Referendum/CheckVoteResult",type:"Post",traditional:!0},{name:"uncheckVote",url:"/Referendum/UncheckVote",type:"Post",traditional:!0},{name:"getUserInfos",url:"/Referendum/GetUserInfos",type:"get"},{name:"getVoteDetailReload",url:"/Referendum/GetVoteDetailReload",type:"get"},];n.request=new i}(this.egov=this.egov||{},window.Offline),function(n){n.entities={currentDoctypes:{name:"currentDoctypes",hasCache:!0,hasSessionCache:!0,request:n.request.getDocTypes,option:{}},categories:{name:"categories",hasCache:!0,hasSessionCache:!0,request:n.request.getCategories,option:{}},currentDepartments:{name:"currentDepartments",hasCache:!0,hasSessionCache:!0,request:n.request.getDepartmentsByUser,option:{}},getDepartmentsCurrent:{name:"getDepartmentsCurrent",hasCache:!0,hasSessionCache:!0,request:n.request.getDepartmentsCurrent,option:{}},allDept:{name:"allDept",hasCache:!0,hasSessionCache:!0,request:n.request.getAllDepartment,option:{}},allJobtitle:{name:"allJobtitle",hasCache:!0,hasSessionCache:!0,request:n.request.getAllJobTitlies,option:{}},allPosition:{name:"allPosition",hasCache:!0,hasSessionCache:!0,request:n.request.getAllPosition,option:{}},allUsers:{name:"allUsers",hasCache:!0,hasSessionCache:!0,request:n.request.getAllUsers,option:{}},allUserDeptPosition:{name:"allUserDeptPosition",hasCache:!0,hasSessionCache:!0,request:n.request.getAllUserDepartmentJobTitlesPosition,option:{}},getDeptAndUsers:{name:"getDeptAndUsers",hasCache:!0,hasSessionCache:!0,request:n.request.getDeptAndUsers,option:{}},allAddress:{name:"allAddress",hasCache:!0,hasSessionCache:!0,request:n.request.getAllAddress,option:{}},allKeyword:{name:"allKeyword",hasCache:!1,hasSessionCache:!0,request:n.request.getKeywords,option:{}},allDocField:{name:"allDocField",hasCache:!0,hasSessionCache:!0,request:n.request.getDocField,option:{}},allSendType:{name:"allSendType",hasCache:!0,hasSessionCache:!0,request:n.request.getSendTypes,option:{}},userConfig:{name:"userConfig",hasCache:!1,hasSessionCache:!0,request:n.request.getCommonConfigs,option:{beforeSent:function(){n.pubsub.public(n.events.status,{type:"processing",message:"Đang tải"})}}},allCommonComments:{name:"allCommonComments",hasCache:!0,hasSessionCache:!0,request:n.request.getCommonComments,option:{}},allTemplateComments:{name:"allTemplateComments",hasCache:!0,hasSessionCache:!0,request:n.request.getTemplateComments,option:{}},currentUserId:{name:"currentUserId",hasCache:!0,hasSessionCache:!0,option:{}},getCommonConfigs:{name:"getCommonConfigs",hasCache:!0,hasSessionCache:!0,request:n.request.getCommonConfigs,option:{}},documentTree:{name:"documentTree",hasCache:!0,request:n.request.getDocumentTree,hasSessionCache:!0,option:{beforeSent:function(){n.pubsub.public(n.events.status,{type:"processing",message:"Đang tải"})}}},documentStore:{name:"documentStore",id:null,hasCache:!0,hasSessionCache:!0,isReplaceWhenSync:!1,request:n.request.getDocumentStore,option:{}},getDocumentPermission:{name:"getDocumentPermission",id:null,hasCache:!1,hasSessionCache:!1,request:n.request.getDocumentPermission,option:{}},document_Store:{name:"document-functionStore",hasCache:!1,hasSessionCache:!0,request:null,option:{}},documents:{name:"documents",hasCache:!0,hasSessionCache:!0,isReplaceWhenSync:!1,request:n.request.getDocuments,option:{}},documentsReport:{name:"documents",hasCache:!0,hasSessionCache:!0,isReplaceWhenSync:!1,request:n.request.getReports,option:{}},tempDocuments:{name:"tempDocuments",hasCache:!1,hasSessionCache:!1,isReplaceWhenSync:!0,request:n.request.getDocuments,option:{}},functionGroups:{name:"functionGroups",id:null,hasCache:!1,hasSessionCache:!0,request:n.request.getFunctionGroups,option:{}},documentTemplate:{name:"documentTemplate",id:null,hasCache:!0,hasSessionCache:!0,isInsertToCurrentCache:!0,request:n.request.getDocumentTemplate,option:{}},documentEdit:{name:"documentEdit",id:null,hasCache:!1,hasSessionCache:!1,request:n.request.getDocumentInfoForEdit,option:{}},documentCreate:{name:"documentCreate",id:null,hasCache:!1,hasSessionCache:!1,request:n.request.getDocumentInfoForCreate,option:{}},documentCreateAction:{name:"documentCreateAction",id:null,hasCache:!1,hasSessionCache:!1,request:n.request.getDocumentCreateAction,option:{}},documentEditAction:{name:"documentEditAction",id:null,hasCache:!1,hasSessionCache:!1,request:n.request.getDocumentEditAction,option:{}},getUserByAction:{name:"getUserByAction",hasCache:!1,hasSessionCache:!1,request:n.request.getUserByAction,option:{}},transfer:{name:"transfer",hasCache:!1,hasSessionCache:!1,request:n.request.transfer,option:{}},setPopUpSize:{name:"setPopUpSize",hasCache:!1,hasSessionCache:!1,request:n.request.setPopUpSize,option:{}},getDocumentDetail:{name:"getDocumentDetail",hasCache:!1,hasSessionCache:!1,request:n.request.getDocumentDetail,option:{}},filterCitizen:{name:"filterCitizen",hasCache:!1,hasSessionCache:!1,request:n.request.filterCitizen,option:{}},getStorePrivate:{name:"getStorePrivate",id:null,hasCache:!1,hasSessionCache:!0,request:n.request.getStorePrivate,option:{}},trees:{name:"trees",hasCache:!0,hasSessionCache:!0,request:n.request.getDocumentTree,option:{},expriedDay:7,isPrivate:!0},getNodeQuestion:{name:"getNodeQuestion",hasCache:!1,hasSessionCache:!1,request:n.request.getNodeQuestion,option:{}},getStorePrivateDocuments:{name:"getStorePrivateDocuments",hasCache:!1,hasSessionCache:!1,request:n.request.getStorePrivateDocuments,option:{}},storeTrees:{name:"storeTrees",hasCache:!1,hasSessionCache:!0,request:n.request.getStorePrivate,option:{}},versionValue:{name:"version",hasCache:!1,hasSessionCache:!0,request:n.request.getVersionValue,option:{}}}}(this.egov=this.egov||{}),function(n){n.models=n.models||{};n.viewModels=n.viewModels||{};n.models.document=Backbone.Model.extend({defaults:{Address:"",CategoryBusinessId:0,CategoryId:0,CitizenInfo:null,CitizenName:null,Color:0,Comment:"",Comments:{},Compendium:"",Compendium2:"",DateAppointed:"",DateArrived:null,DateCreated:new Date,DateFinished:null,DateModified:"",DateOfIssueCode:null,DatePublished:null,DateReceived:"",DateReceivedFormat:"",DateResponse:null,DateResponsed:null,DateResponsedOverdue:null,DateResult:"",DateReturned:null,DateSuccess:null,DocCode:null,DocFieldId:null,DocFieldIds:null,DocType:{},DocTypeId:"",DocTypePermission:0,DocumentCopyId:0,DocumentId:"00000000-0000-0000-0000-000000000000",Email:null,IdentityCard:null,InOutCode:null,InOutPlace:"",IsAcknowledged:0,IsConverted:0,IsDocumentImportant:0,IsGettingOut:0,IsReturned:null,IsSuccess:null,IsSupplemented:null,IsViewed:0,Keyword:null,LastComment:"",LastUserIdComment:0,Organization:null,Original:1,Phone:null,ProcessedMinutes:null,ResultStatus:null,ReturnNote:null,SecurityId:null,SendTypeId:null,Status:0,StoreId:null,SuccessNote:null,TotalPage:null,UrgentId:1,UserCurrentId:0,UserCreatedId:0,UserCurrentFirstName:"",UserCurrentFullName:"",UserReturnedId:null,UserSuccessId:null,Selected:!1,DocumentCopyType:0,DocCopyStatus:0,DateOverdue:"",NumberDayOverdue:"0",NumberDayAppointed:"0",IsFile:0,WorkflowId:0,NodeCurrentId:0,DocCopyDateModified:null,WorkflowTypes:"",WorkflowTypeId:"",WorkflowTypeName:"",Note:""},initialize:function(){this.set("id",this.get("DocumentCopyId"))}});n.models.documentList=Backbone.Collection.extend({model:n.models.document});n.models.documentPermission=Backbone.Model.extend({defaults:{value:0}});n.models.documentPermissionList=Backbone.Collection.extend({model:n.models.documentPermission});n.models.toolbar=Backbone.Model.extend({defaults:{text:"",className:"",disable:!1,icon:"",dataUrl:"",shortKey:"",data:null,callback:null,dropdownWidth:90,dropdownHeight:0,position:{at:"right bottom",my:"right top"},contentId:"",isDatePicker:!1,isDropdownMenu:!1,hasShortKey:!1,showSelected:!1,defaultSelectedText:"Tất cả"}});n.models.toolbarList=Backbone.Collection.extend({model:n.models.toolbar});n.models.contextMenu=Backbone.Model.extend({defaults:{selector:null,trigger:"right",dataUrl:"",param:"",data:null,callback:null,style:{},position:{},isDatePicker:!1,isShowLoading:!1,key:null},initialize:function(){var n=this.get("style");(n.height===0||n.height===undefined)&&(n.height="auto");this.set("style",$.extend({},{display:"none"},n));this.set("position",$.extend({},{at:"right bottom",my:"right top"},this.get("position")))}});n.models.contextMenuItem=Backbone.Model.extend({defaults:{text:"",value:"",callback:"",icon:"",selected:!1},initialize:function(){this.get("icon")!==""&&this.set("icon","/Content/Images/Toolbar/"+this.get("icon"))}});n.models.contextMenuList=Backbone.Collection.extend({model:n.models.contextMenuItem});n.models.TreeModel=Backbone.Model.extend({defaults:{functionId:0,parentId:0,name:"",params:"",paramId:0,icon:"",state:"closed",order:0,totalDocumentUnread:0,totalDocument:0,children:[],url:"",pagingUrl:"",isLoadChildren:!1,showTotalInTreeType:{none:0,unread:1,unreadOnAll:2,all:3}.unread,defaultSort:null,hasUyQuyen:!1,userUyQuyen:null,isOpen:!1,isSelected:!1,hasTransferTheoLo:!1,isOnlineRegistration:!1,treeGroupId:null,treeGroupOrder:0,hasExportFile:!1},initialize:function(){this.set("id",this.get("functionId"));var n="/Home/GetDocuments/"+this.get("functionId"),t="/Home/GetDocumentPaging/"+this.get("functionId");typeof this.get("params")=="object"&&this.set("params",JSON.stringify(this.get("params")));this.get("params")!==""&&(n+="?params="+this.get("params"),t+="?params="+this.get("params"));this.set("url",n);this.set("pagingUrl",t);this.set("isLoadChildren",!1);typeof this.get("defaultSort")=="object"&&this.set("defaultSort",JSON.stringify(this.get("defaultSort")));typeof this.get("userUyQuyen")=="string"&&this.set("userUyQuyen",JSON.parse(this.get("userUyQuyen")))}});n.models.TreeList=Backbone.Collection.extend({model:n.models.TreeModel});n.models.StorePrivateModel=Backbone.Model.extend({defaults:{level:0,parentId:0,status:0,storePrivateId:0,storePrivateName:"",name:"",children:[],state:"closed",url:"",pagingUrl:"",root:!1,isStoreShared:!1,descStorePrivate:"",userIdJoined:[],deptExtJoined:[]},initialize:function(){var t="/StorePrivate/GetDocuments/"+this.get("storePrivateId");this.set("id",this.get("storePrivateId"));this.set("pagingUrl",t);this.set("children",new n.models.StorePrivateList(this.get("children")?this.get("children"):[]))}});n.models.StorePrivateList=Backbone.Collection.extend({model:n.models.StorePrivateModel});n.models.question=Backbone.Model.extend({defaults:{QuestionId:0,Date:"",AskPeople:"",Detail:"",Name:"",Email:"",Phone:"",DocCode:"",QuestionType:0,IsGeneralQuestion:!0,UserComments:[],AnswerHolder:null,isMe:!1,Compendium:"",DocumentHolderName:"",DocumentHolderAccount:"",DocumentHolderFullAccount:""},initialize:function(){}});n.models.questionList=Backbone.Collection.extend({model:n.models.question});n.models.QuestionTreeModel=Backbone.Model.extend({defaults:{level:0,status:0,name:"",children:[],state:"closed",root:!1,isGeneral:!1},initialize:function(){this.set("children",new n.models.QuestionTreeList(this.get("children")?this.get("children"):[]))}});n.models.QuestionTreeList=Backbone.Collection.extend({model:n.models.QuestionTreeModel});n.models.TabModel=Backbone.Model.extend({defaults:{id:0,name:"",title:"",href:"",hasTooltip:!0,hasCloseButton:!1,isRoot:!1,privateId:0,attributes:{},isCreateDocument:!1,type:0,cateBusId:0,hasLoadContent:!0}});n.models.TabList=Backbone.Collection.extend({model:n.models.TabModel});n.models.action=Backbone.Model.extend({defaults:{currentNodeId:0,id:"",isAllow:!0,isAllowSign:!1,isSpecial:!1,name:"",nextNodeId:0,priority:0,userIdNext:0,workflowId:0}});n.models.userAction=Backbone.Model.extend({defaults:{id:0,value:0,label:"",fullname:"",department:"",username:"",position:"",isMainProcess:!1,isCoProcess:!1},initialize:function(){this.set("id",this.get("value"))}});n.models.actionUserList=Backbone.Collection.extend({model:n.models.userAction});n.models.attachment=Backbone.Model.extend({defaults:{Id:0,Name:"",Extension:"",Size:0,Versions:[],fileData:undefined,isRemoved:!1,isNew:!1,isMofified:!1,isOpen:!1,icon:""},initialize:function(){var t,n;t=this.get("Extension");t.indexOf(".")!==0&&(t="."+t);switch(t){case".doc":case".docx":n="icon-file-word";break;case".xls":case".xlsx":n="icon-file-excel";break;case".pdf":n="icon-file-pdf";break;case".txt":n="icon-text";break;case".zip":case".rar":case".7z":n="icon-file-zip";break;case".ppt":case".pptx":n="icon-file-powerpoint";break;case".html":n="icon-chrome";break;case".jpg":case".jpeg":case".bmp":case".png":case".ico":case".gif":n="icon-image2";break;default:n="icon-file4"}this.set("icon",n)}});n.models.attachmentList=Backbone.Collection.extend({model:n.models.attachment});n.models.relation=Backbone.Model.extend({defaults:{id:0,RelationCopyId:0,RelationId:"",RelationType:0,IsAddNext:!1,Compendium:"",CitizenName:"",DocCode:"",DateCreated:"",CategoryName:"",IsRemoved:!1,IsNew:!1},initialize:function(){this.set("id",this.get("RelationCopyId"))}});n.models.relationList=Backbone.Collection.extend({model:n.models.relation});n.models.quickView=Backbone.Model.extend({defaults:{id:0,type:1,compendium:null,lastComment:null,category:null,department:null,dateCreate:null,lastUser:null,docField:null,urgent:null,docCode:null,totalPage:null,docType:null,dateReceived:null,DateReceivedFormat:"",dateAppoint:null,personInfo:null,email:null,phone:null,address:null},initialize:function(){}});n.models.quickViewList=Backbone.Collection.extend({model:n.models.quickView,initialize:function(){}});n.models.address=Backbone.Model.extend({defaults:{IsShow:!1,ParentId:null},initialize:function(){this.set("id",this.get("AddressId"));this.set("value",this.get("AddressId"));this.set("label",this.get("Name"));this.set("isSelected",!1)}});n.models.addressCollection=Backbone.Collection.extend({model:n.models.address});n.models.publish=Backbone.Model.extend({defaults:{StoreId:0,CodeId:0,Code:"",DatePublished:new Date,DateResponse:null,TotalPage:1,SecurityId:1,TotalCopy:1,Approvers:"",KeyWordId:0,InPlace:0,IsCustomCode:!1,Address:[]}});n.models.supplementary=Backbone.Model.extend({SupplementaryId:0,Comment:"",DateSend:"",IsDeleted:!1,UserSendId:0,UserSendName:""});n.models.supplementaryList=Backbone.Collection.extend({model:n.models.supplementary});n.models.search=Backbone.Model.extend({defaults:{Compendium:"",CategoryId:null,KeyWord:"",Content:"",DocCode:"",InOutCode:"",UrgentId:null,CategoryBusinessId:null,StorePrivateId:null,CurrentUserId:null,InOutPlace:"",FromDateStr:"",ToDateStr:"",BeforeDate:"",AfterDate:"",OrganizationCreate:"",DocFieldId:null,UserSuccessId:null}});n.models.searchResultItem=Backbone.Model.extend({defaults:{Address:"",CategoryName:"",CitizenName:"",Compendium:"",DateAppointed:"",DateArrived:"",DateCreated:"",DocCode:"",DocumentCopyId:0,DocumentId:"",InOutCode:0,LastUserComment:"",UserSuccess:"",DateReceived:"",IsSelected:!1}});n.models.searchResult=Backbone.Collection.extend({model:n.models.searchResultItem});n.models.modal=Backbone.Model.extend({defaults:{title:"",keyboard:!1,resizable:!1,draggable:!1,animation:!0,remote:"",content:"",height:"auto",width:"auto",ignoreText:"",buttons:[],hide:null,close:null,loaded:null,backdrop:"static",confirm:null}});n.models.totalNotifications=Backbone.Model.extend({defaults:{totalNotify:0,total:0}});n.models.notification=Backbone.Model.extend({defaults:{NotificationId:0,NotificationType:0,Title:"",Content:"",SenderAvatar:"",SenderUserName:"",SenderFullName:"",Date:"",DateFormat:"",ReceiveDate:"",ViewdDate:"",IsViewed:!1,DocumentCopyId:0,MailId:0,folderId:0,ChatId:"",chatterJid:"",messageId:""}});n.models.notificationList=Backbone.Collection.extend({model:n.models.notification});n.models.layoutNotify=Backbone.Model.extend({defaults:{total:0,unreadTotal:0,model:[]}});n.viewModels.tree=new n.models.TreeList;n.viewModels.documentList=new n.models.documentList;n.viewModels.tabList=new n.models.TabList;n.viewModels.actionUserList=new n.models.actionUserList}(this.egov=this.egov||{}),function(n,t,i){"use strict";var e=function(){return this._initialize()},r,o,u,f;e.prototype._initialize=function(){return this._storage={},this.hasSupport=!0,this};e.prototype.get=function(i,r){var e=this,f,u;if(f=this._storage[i],f)try{t.callback(r,JSON.parse(f))}catch(o){u=JSON.parse(n.hashBase64.fromBase64(f));u.value==null||u.value==undefined?t.locache.get(i,function(n){u.value=n;t.locache.update(i,u);t.callback(r,u)}):t.callback(r,u)}else t.callback(r)};e.prototype.insert=function(n,i,r){this._storage[n]=JSON.stringify({key:n,value:i,dateModified:new Date});t.callback(r,i)};e.prototype.update=function(n,i,r){this._storage[n]=JSON.stringify({key:n,value:i,dateModified:new Date});t.callback(r,i)};e.prototype.delete=function(n,i){this._storage[n]&&(this._storage[n]=null);t.callback(i,n)};e.prototype.reset=function(n){this._storage={};t.callback(n)};r=function(){if(i.localstorage)return this._storage,this._initialize()};r.prototype._initialize=function(){return this.hasSupport=this._hasSupport(),this._storage=n.localStorage,this};r.prototype.get=function(i,r){var e=this,f,u;if(f=this._storage[i],f)try{t.callback(r,JSON.parse(f))}catch(o){u=JSON.parse(n.hashBase64.fromBase64(f));u.value==null||u.value==undefined?t.locache.get(i,function(n){u.value=n;t.locache.update(i,u);t.callback(r,u)}):t.callback(r,u)}else t.callback(r)};r.prototype.insert=function(n,i,r){this._storage.setItem(n,JSON.stringify({key:n,value:i,dateModified:new Date}));t.callback(r,i)};r.prototype.update=function(n,i,r){this._storage.setItem(n,JSON.stringify({key:n,value:i,dateModified:new Date}));t.callback(r,i)};r.prototype.delete=function(n,i){this._storage[n]&&this._storage.removeItem(n);t.callback(i,n)};r.prototype.reset=function(n){this._storage.clear();t.callback(n)};r.prototype._hasSupport=function(){if("localStorage"in n&&n.localStorage!==null)try{return n.localStorage.setItem("egov","Bkav Corporation"),n.localStorage.removeItem("egov"),!0}catch(t){return!1}else return!1};o={READ_WRITE:"readwrite",READ_ONLY:"readonly"};u=function(){var n;if(i.indexeddb)return n=this,n._storage,n._storageName="eGovStore",n._tableName="eGovObjectStore",n.version=1,n.hasSupport=!0,n._initialize()};u.prototype._initialize=function(){var t,r,i=this;return t=n.indexedDB.open(i._storageName,i.version),t.onerror=function(n){i.hasSupport=!1;console.log("Database error: "+n.target.errorCode)},t.onupgradeneeded=function(n){r=n.target.result;r.createObjectStore(i._tableName,{keyPath:"key"})},t.onsuccess=function(){i._storage=t.result},this};u.prototype.get=function(n,i){var u,r,f=this;u=f._getObjectStore(o.READ_WRITE);r=u.get(n);r.onerror=function(){console.log("Database error: "+this.error.message)};r.onsuccess=function(){!r.result;t.callback(i,r.result)}};u.prototype.insert=function(n,i,r){var f,u,e=this;f=e._getObjectStore(o.READ_WRITE);u=f.add({key:n,value:i,dateModified:new Date});u.onsuccess=function(){console.log("Add success: "+n);t.callback(r,i)};u.onerror=function(){console.log("Add error! "+this.error.message)}};u.prototype.update=function(n,i,r){var f,u,e=this;f=e._getObjectStore(o.READ_WRITE);u=f.get(n);u.onsuccess=function(){u.result&&(u.result.value=i,u.result.dateModified=new Date,f.put(u.result));console.log("Update success."+n);t.callback(r,i)};u.onerror=function(){console.log("Update error! "+this.error.message)}};u.prototype.delete=function(n,i){var u,r;u=this._getObjectStore(o.READ_WRITE);r=u.delete(n);r.onerror=function(){console.log("delete error! "+this.error.message)};r.onsuccess=function(){console.log("delete success.");t.callback(i)}};u.prototype.reset=function(n){var r,i;r=this._getObjectStore(o.READ_WRITE);i=r.clear();i.onerror=function(){console.log("reset error! "+this.error.message)};i.onsuccess=function(){console.log("Reset success.");t.callback(n)}};u.prototype._getObjectStore=function(t){t=t?t:o.READ_WRITE;var i;if(this._storage==null){console.log("Cache not loaded.");n.location.reload();return}return i=this._storage.transaction([this._tableName],t),i.objectStore(this._tableName)};f=function(n){return this._localStorage=i.localstorage,this._indexeddb=i.indexeddb,this._fileReader=i.filereader,this._hasSupportCache,this._storage,this._cacheSize,this._cacheName=n,this._initialize()};f.prototype._initialize=function(){if(this._hasSupportCache=this._localStorage||this._indexeddb||this._fileReader,!this._hasSupportCache)return new e;if(this._fileReader||this._cacheName!="fileApi"?this._indexeddb||this._cacheName!="indexedDb"||(this._cacheName="storage"):this._cacheName="indexedDb",this._cacheName)switch(this._cacheName){case"storage":return new r;case"indexedDb":return new u;case"fileApi":return;default:console.log("Giá trị khởi tạo không đúng");return}return this._indexeddb?new u:this._localStorage?new r:this._fileReader?void 0:this};f.prototype.get=function(n,i){t.callback(i)};f.prototype.insert=function(){console.log("Locache chưa được khởi tạo")};f.prototype.update=function(){console.log("Locache chưa được khởi tạo")};f.prototype.delete=function(){console.log("Locache chưa được khởi tạo")};f.prototype.reset=function(){console.log("Locache chưa được khởi tạo")};t.CacheManager=f}(this,this.egov=this.egov||{},this.Modernizr),function(n,t,i){"use strict";var u={indexedDb:"indexedDb",storage:"storage",fileApi:"fileApi"},r=function(){return this._cacheManager=new n.CacheManager(u.storage),(n.isMobile||this._cacheManager==i||!this._cacheManager.hasSupport)&&(this._cacheManager=new n.CacheManager(u.storage)),this._dataBase={},this._hasCache=this._cacheManager!==i&&this._cacheManager.hasSupport,this._expriedDay=10,this};r.prototype.get=function(r){var u,e=this,f,s=n.getKeyName(r),o;if(r==i){n.log("DataAccess.get: Entity is null.");return}if(f=r.option.success,!r.hasSessionCache){e._sendRequestToServer(r);return}r.option.success=function(h){if(r.option.success=f,h){e._sendRequestToServer(r);return}if(s=n.getKeyName(r),u=e._dataBase[s],u)if(r.isInsertToCurrentCache){if(o=JSON.stringify(r.option.data),u=u.filter(function(n){return n.key==o}),u.length>0){n.callback(f,u[0].value);return}}else{n.callback(f,u);return}e._getFromCache(r,function(h){if(h)if(u=h.value,r.isInsertToCurrentCache){if(o=JSON.stringify(r.option.data),u=u.filter(function(n){return n.key==o}),u.length>0){n.callback(f,u[0].value);return}}else{e._dataBase[s]=u;n.callback(f,u);return}t.isFunction(r.request)?e._sendRequestToServer(r):n.callback(f,i)})};this.resetOutofDate(r)};r.prototype.getCache=function(t){var r,o=this,u,f,e;if(t==i){n.log("DataAccess.get: Entity is null.");return}f=n.getKeyName(t);u=t.option.success;this._cacheManager.get(f,function(s){if(s)if(r=s.value,t.isInsertToCurrentCache){if(e=JSON.stringify(t.option.data),r=r.filter(function(n){return n.key==e}),r.length>0){n.callback(u,r[0].value);return}}else{o._dataBase[f]=r;n.callback(u,r);return}n.callback(u,i)})};r.prototype.resetOutofDate=function(t){var i,r,u;i=this;r=n.getKeyName(t);u=t.option.success;t.option.success=function(t){if(t&&Date.now()-t>i._expriedDay*864e5){i._dataBase[r]=null;i.delete(r,function(){n.callback(u,!0)});return}n.callback(u,t?!1:!0)};this.getLastUpdate(t)};r.prototype.getLastUpdate=function(t){var r;if(t==i){n.log("DataAccess.getLastUpdate: Entity is null.");return}(r=t.option.success,t.hasSessionCache)&&this._getFromCache(t,function(t){n.callback(r,t?t.dateModified:i)})};r.prototype.insert=function(t,i){var u,f,r;r=this;u=n.getKeyName(t);f=t.option.success;r._dataBase[u]=i;t.hasCache&&r._hasCache?r._cacheManager.insert(u,i,f):n.callback(f,i)};r.prototype.update=function(t,r,u){var h,e,f,o,s,c;if(f=this,e=n.getKeyName(t),u=u||!1,c="id",s=t.option.success,h=f._dataBase[e]||[],!u&&(r===i||r.length===0)){n.callback(s,h);return}o=u?r:n.mergeArraysByProperty(h,r,c);f._dataBase[e]=o;t.hasCache&&f._hasCache?f._cacheManager.update(e,o,s):n.callback(s,o)};r.prototype.delete=function(t,r){var u,f=this;if(u=n.entities[t],u===i){n.log("DataAccess.delete: entity not found");return}t=n.getKeyName(u);this._dataBase[t]=null;u.hasCache&&f._hasCache?this._cacheManager.delete(t,r):n.callback(r,t)};r.prototype.reset=function(t){this._dataBase={};this._hasCache?this._cacheManager.reset(t):n.callback(t)};r.prototype._saveToCache=function(n,t){this._cacheManager.insert(n,t)};r.prototype._getFromCache=function(t,r){this._hasCache&&t.hasCache?this._cacheManager.get(n.getKeyName(t),r):n.callback(r,i)};r.prototype._sendRequestToServer=function(t){var u,r=this,f,i,e,o,s=t.option.success;f=n.getKeyName(t);u=$.extend({cache:!0},t.option);u.success=function(u){t.isInsertToCurrentCache?r._getFromCache(t,function(n){n&&(i=n.value,o=!0);e=JSON.stringify(t.option.data);i?i.push({key:e,value:u}):i=[{key:e,value:u}];r._dataBase[f]=i;t.hasCache&&(t.option.success=function(){s(u)},o?r.update(t,i,!0):r.insert(t,i));return}):(r._dataBase[f]=u,t.option.success=function(){n.callback(s,u)},t.hasCache?r.insert(t,u):n.callback(t.option.success))};u.error=function(n){n.getResponseHeader("IsAuthenticated")==="false"&&parent.logout()};t.request(u)};r.prototype._checkBrowsersNotSupport=function(){this._cacheManager.isNotSupportIndexedDb&&(this._hasCache=!1)};r.prototype.version=function(){};r.prototype.setVersion=function(){};n.DataAccess=new r}(this.egov=this.egov||{},_,undefined),function(n){"use strict";var i=n.entities,t=function(){return this._dataAccess=n.DataAccess,this._requestDefault={},this._syncDefault={success:function(){}},this};t.prototype.sendRequest=function(n,t){n.option=$.extend({},this._requestDefault,n.option,t);this._dataAccess.get(n)};t.prototype.getCache=function(n,t){n.option=$.extend({},this._requestDefault,n.option,t);this._dataAccess.getCache(n)};t.prototype.getLastUpdate=function(n,t){n.option=$.extend({},this._requestDefault,n.option,t);this._dataAccess.getLastUpdate(n)};t.prototype.reset=function(n){this._dataAccess.reset(n?n.success:undefined)};t.prototype.deletePrivateCache=function(n){var f,t,o,r,e,u;if(typeof i!==undefined){f=0;t=[];for(o in i)r=i[o],r&&r.hasCache&&r.isPrivate&&t.push(r.name);if(t.length>0)for(e=t.length,u=0;u<e;u++)f++,this._dataAccess.delete(t[u],f==e-1&&n?n.success:undefined)}};t.prototype.getCurrentDoctypes=function(t){if(n&&n.doctypes){n.callback(t.success,n.doctypes);return}var r=i.currentDoctypes;this.sendRequest(r,t)};t.prototype.getCategories=function(n){var t=i.categories;this.sendRequest(t,n)};t.prototype.getCurrentDepartments=function(t){if(n&&n.currentDepts){n.callback(t.success,n.currentDepts);return}var r=i.currentDepartments;this.sendRequest(r,t)};t.prototype.getDepartmentsCurrent=function(t){if(n&&n.getDepartmentsCurrent){n.callback(t.success,n.getDepartmentsCurrent);return}var r=i.getDepartmentsCurrent;this.sendRequest(r,t)};t.prototype.getAllDept=function(t){if(n&&n.allDeps){n.callback(t.success,n.allDeps);return}var r=i.allDept;this.sendRequest(r,t)};t.prototype.getAllJobtitle=function(t){if(n&&n.allJobtitles){n.callback(t.success,n.allJobtitles);return}var r=i.allJobtitle;this.sendRequest(r,t)};t.prototype.getAllPosition=function(t){if(n&&n.allPositions){n.callback(t.success,n.allPositions);return}var r=i.allPosition;this.sendRequest(r,t)};t.prototype.getAllUsers=function(t){if(n&&n.allUsers){n.callback(t.success,n.allUsers);return}var r=i.allUsers;this.sendRequest(r,t)};t.prototype.getAllUserDeptPosition=function(t){if(n&&n.allUserDeps){n.callback(t.success,n.allUserDeps);return}var r=i.allUserDeptPosition;this.sendRequest(r,t)};t.prototype.getAllAddress=function(n){var t=i.allAddress;this.sendRequest(t,n)};t.prototype.clearAddress=function(){this._dataAccess.delete("allAddress",function(){})};t.prototype.getSendTypes=function(n){var t=i.allSendType;this.sendRequest(t,n)};t.prototype.getCommonConfigs=function(n){var t,r;t=i.getCommonConfigs;r=n.success;n.success=function(n){r(n)};this.sendRequest(t,n)};t.prototype.deletePrivateData=function(n){var t,r;t=i.currentUserId;r=n.success;n.success=function(n){r(n)};this.sendRequest(t,n)};t.prototype.getUserConfig=function(t){var r,u;r=i.userConfig;u=t.success;t.success=function(t){n.cookie.setQuickView(t.userSetting.quickView);n.cookie.viewSize(t.userSetting.fontSize);n.cookie.setMudimMethod(t.userSetting.MudimMethod);t.acceptFileTypes=new RegExp(t.acceptFileTypes,"i");u(t)};this.sendRequest(r,t)};t.prototype.setPopUpSize=function(n,t,r){var u;u=i.setPopUpSize;u.option.data={width:n,height:t};r=u.option;r.success=function(i){i.result==="success"&&(window.opener.egov.setting.userSetting.PopUpHeight=t,window.opener.egov.setting.userSetting.PopUpWidth=n)};this.sendRequest(u,r)};n.dataManager=new t}(this.egov=this.egov||{},_),function(n){"use strict";function u(t){var i=[],e,u,f=[],r;return _.each(t,function(t){if(e=t.filter,e.length===0){i.push(t);return}_.each(e,function(e){if(!e.IsAutoGenNodeName){i.push(t);return}if(u=n.toJSON(e.Value),u===undefined&&u.length===0){e=null;i.push(t);return}_.each(u,function(n){var i=_.clone(t);i.name=n.TextField;r=_.clone(e);r.Value=n.DataField;r.IsSqlValue=!1;r.IsAutoGenNodeName=!1;i.filter=[];i.filter.push(r);f.push(i)});f=_.sortBy(f,function(n){return n.name});i=i.concat(f)})}),i}var i,t,r;if(n.dataManager===undefined){n.log("Chưa khởi tạo data manager.");return}if(n.viewModels.tree===undefined){n.log("Chưa khởi tạo models.");return}r=n.viewModels.tree;i=n.entities;t=n.dataManager;t.getTree=function(t,f){var o,s,e,h,c=this;o=i.documentTree;s=f.success;f.success=function(i){e=_.filter(i,function(n){return t===0&&n.parentid==null||t!==0&&n.parentid==t});e=_.sortBy(e,function(n){return n.order});_.each(e,function(t){t.columnSetting=n.toJSON(t.columnSetting)});e=u(e);t===0?(r.reset(),r.add(e)):(h=r.detect(function(n){return n.get("functionId")===t}),h.set("children",new n.models.TreeList(e)));n.callback(s,r)};this.sendRequest(o,f)};t.getNodeFromStoreId=function(t,i){var u,f,e;e=this;u=i.success;f=r.detect(function(n){return n.get("group")===t});n.callback(u,f)};t.getNodeQuestion=function(n){var t=i.getNodeQuestion;this.sendRequest(t,n)};t.getStorePrivate=function(t){if(n&&n.storePrivate){n.callback(t.success,n.storePrivate);return}var r=i.getStorePrivate;this.sendRequest(r,t)};t.getTreesByRoot=function(n,t){var r=$.extend({},i.trees);n=n||0;r.option.data={id:n};this.sendRequest(r,t)};t.updateTree=function(n){var t=$.extend({},i.trees);this._dataAccess.update(t,n,!0)};t.updatePropInTreeModel=function(n,t,r){var u=i.trees,f=this;this.getTreesByRoot(0,{success:function(i){if(i&&!(i.length<=0)){for(var e=0;e<i.length;e++)if(i[e].id===n){i[e][t]=r;break}u.option.success=null;f._dataAccess.update(u,i,!0)}}})}}(this.egov=this.egov||{}),function(n){"use strict";function u(t,i,r){var f,e,u=[];return _.each(i,function(t){t.FilterExpression===n.enum.processFilterType.equal&&u.push("doc['"+t.DataField+"'] == "+t.Value);t.FilterExpression===n.enum.processFilterType.custom&&u.push(t.Value)}),f=u.join(" && "),e=_.filter(t,function(){return eval(f)}),_.sortBy(e,function(n){return n[r]})}var i,t,r;if(n.dataManager===undefined){n.log("Chưa khởi tạo data manager.");return}if(n.viewModels.documentList===undefined){n.log("Chưa khởi tạo models.");return}r=n.viewModels.documentList;i=n.entities;t=n.dataManager;t._defaultSortBy="DateReceived";t.getDocuments2=function(t,i,f){var e,o=this;o.getDocumentStore(t,{success:function(t){e=u(t,i,o._defaultSortBy);r.reset();r.add(e);n.callback(f.success,r)}})};t.syncDocuments=function(n,t){var e,f,h,o,s={};f=this;h=r;e=i.documentStore;e.id=n;s.success=function(n){o=u(n,t,f._defaultSortBy);r.reset();r.add(o)};f.getLastUpdate(e,{success:function(t){f._syncDocumentStore(n,t,s)}})};t.getDocumentStore=function(t,r){var u,f,e,o,s=this;u=i.documentStore;u.id=t;u.option.data={id:t};f=r.success;r.success=function(r){e=_.map(r,function(n){return{documentCopyId:n.DocumentCopyId,functionStoreId:t}});o=!0;s._dataAccess.insert(i.document_Store,e,o,"documentCopyId");n.callback(f,r)};this.sendRequest(u,r)};t.getDocumentPermission=function(n,t){var r;r=$.extend({},i.getDocumentPermission);r.option.data={documentCopyIds:n};this.sendRequest(r,t)};t.getFunctionStores=function(t){var r,u;r=i.functionGroups;u=t.success;t.success=function(t){n.callback(u,t)};this.sendRequest(r,t)};t.getFunctionStoreFromDocument=function(t,i){var r,u,e,f;f=this;u=i.success;e=t;f.getFunctionStores({success:function(t){t.length>0&&_.each(t,function(t){if(r=t.ClientExpression,eval(r)){n.callback(u,t[FunctionGroupId]);return}})}})};t.updateDocumentToStore=function(n){var t;t=this;t.getFunctionStoreFromDocument(n,{success:function(){}})};t.getDocumentsCache=function(n){var t=$.extend({},i.documents);t.option.success=n.success;this.getCache(t,n)};t.getDocumentsReportCache=function(n){var t=$.extend({},i.documents);t.option.success=n.success;this.getCache(t,n)};t.getDocuments=function(n,t){var r=$.extend({},i.tempDocuments);r.option.data=n;this.sendRequest(r,t)};t.updateDocuments=function(n,t){var r=$.extend({},i.documents),u=this;r.option.success=function(i){r.option.success=t;i?u._dataAccess.update(r,n,!0):u._dataAccess.insert(r,n)};this.getCache(r,{})};t.getStorePrivateDocuments=function(n,t){var r=$.extend({},i.getStorePrivateDocuments);r.option.data=n;this.sendRequest(r,t)};t._syncDocumentStore=function(t,r,u){var f,e,o,s,h=this;f=i.sync.documentStore;o=!1;f.id=t;u.data={id:t,lastUpdate:n.toServerDate(r)};e=u.success;u.success=function(t){s=i.documentStore;s.option.success=function(t){n.callback(e,t)};h._dataAccess.update(i.documentStore,t,o)};n.callback(f.request,u)}}(this.egov=this.egov||{}),function(n){"use strict";var t,i;if(n.dataManager===undefined){n.log("Chưa khởi tạo data manager.");return}t=n.entities;i=n.dataManager;i.getDocumentTemplate=function(i,r,u,f,e){var o,s,h=this;o=t.documentTemplate;o.option.data={isCreate:i,docTypeId:r,categoryBusinessId:u};s=e.success;e.success=function(t){n.callback(s,t)};this.sendRequest(o,e)};i.getDocument=function(i,r){var u,e,o,f,s;u=this;o=r.success;s=t.document_Store;s.option.success=function(t){f=_.find(t,function(n){return n.documentCopyId===i});f&&u.getDocumentStore(f,{success:function(t){e=_.find(t,function(n){return n.DocumentCopyId===i});n.callback(o,e)}})};u._dataAccess.get(t.document_Store)};i.getTemplateComments=function(n){var i,r;i=this;r=t.allTemplateComments;i.sendRequest(r,n)};i.updateTemplateComments=function(i,r,u){var h,e,o,s,f;h=this;e=t.allTemplateComments;this.getTemplateComments({success:function(t){var c,l;if(typeof i=="string"){if(o=!1,s=i.toLowerCase(),f=t,f&&f.length>0){for(c=0;c<f.length;c++)if(l=f[c],l.toLowerCase()==s){o=!0;break}o||(r?f=[i]:f.push(s),t=f)}}else i instanceof Array?t=r?i:t.concat(i):r?t=[i]:t.push(i);e.option.success=function(){u&&u.success&&n.callback(u.success)};h._dataAccess.update(e,t,!0)}})};i.getCommonComment=function(n){var i,r;i=this;r=t.allCommonComments;i.sendRequest(r,n)};i.addCommonComment=function(i,r,u){var o,f,s,e;o=this;f=t.allCommonComments;this.getCommonComment({success:function(t){if(typeof i=="string"){if(t&&t.length>0){for(var h=0;h<t.length;h++)if(t[h].toLowerCase()==i.toLowerCase()){s=!0;break}s||(t.push(i),e=!0)}}else i instanceof Array&&i.length>0&&(t=r?i:t.concat(i),e=!0);e&&(f.option.success=function(){u&&u.success&&n.callback(u.success)},o._dataAccess.update(f,t,!0))}})};i.getDocumentEditInfo=function(n,i,r){var f,u;f=this;u=t.documentEdit;u.option.data={id:n,storePrivateId:i};f.sendRequest(u,r)};i.getDocumentCreateInfo=function(n,i,r){var f,u;f=this;u=t.documentCreate;u.option.data={id:n,documentCopyRelationId:i};f.sendRequest(u,r)};i.getDocumentCreateActions=function(n,i,r){var f,u;f=this;u=t.documentCreateAction;u.option.data={documentTypeId:n,isPhanloai:i};f.sendRequest(u,r)};i.getDocumentEditActions=function(n,i){var u,r;u=this;r=t.documentEditAction;r.option.data={documentCopyId:n};u.sendRequest(r,i)};i.getUserByAction=function(n,i,r,u){var e,f;e=this;f=t.getUserByAction;f.option.data={actionId:n,workflowId:i,documentCopyId:r};e.sendRequest(f,u)};i.transfer=function(n,i,r,u,f,e,o,s){var c,h;c=this;h=t.transfer;h.option.data={doc:n,destination:i,files:r,modifiedFiles:u,removeAttachmentIds:f,storePrivateId:e,destinationPlan:o};c.sendRequest(h,s)};i.getDocumentDetail=function(i,r){var u,f,e=this;u=t.getDocumentDetail;u.id=i;u.option.data={id:i};f=r.success;r.success=function(t){n.callback(f,t)};this.sendRequest(u,r)};i.filterCitizen=function(i,r,u,f,e){var o,s,h=this;o=t.filterCitizen;o.option.data={name:i,idCardNumber:r,phoneNumber:u,email:f};s=e.success;e.success=function(t){n.callback(s,t)};this.sendRequest(o,e)}}(this.egov=this.egov||{}),function(n){n.pubsub=function(){var n=[],t={};return t.publish=function(t,i,r){var e,o,u=0,f=n[t];f&&(o=setInterval(function(){if(f[u]){try{e=f[u].context||this;f[u].callback.call(e,i,r)}catch(n){console.log('Có lỗi xảy ra khi thực thi một trong những hàm callback cho sự kiện "'+t+'"');console.log('Lỗi đó là: "'+n+'"')}u+=1}else clearInterval(o)},0))},t.subscribe=function(t,i,r){n[t]||(n[t]=[]);n[t].push({callback:i,context:r})},t.unsubscribe=function(t,i,r){n[t]&&n[t].pop({callback:i,context:r})},t}()}(this.egov=this.egov||{},jQuery),function(n){n.events={status:{status:"status",success:"status.success",error:"status.error",processing:"status.processing",warning:"status.warning",destroy:"status.destroy",importantWarning:"status.importantWarning"},destroyClickEvent:"destroyClickEvent",hideAllContext:"hideAllContext",tree:{reload:"tree.reload"},tab:{close:"tab.close",closeAll:"tab.closeAll",addDocument:"tab.addDocument",openDocument:"tab.openDocument",addSearch:"tab.addSearch",openDocumentOnline:"tab.openDocumentOnline"},documents:{showQuickView:"documents.showQuickView"},document:{open:"document.open",create:"document.create"}}}(this.egov=this.egov||{}),function(n,t){var i={importantWarning:0,error:1,success:2,processing:3,warning:4};t.fn.extend({animateCss:function(n){this.addClass("animated "+n).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t(this).removeClass("animated "+n)})}});t.widget("egov.status",{options:{duration:5e3,importantWarningDuration:1e4,subscribe:function(){n.log("Chưa set thuộc tính subscribe cho option của status.")}},_create:function(){this.element.addClass("egov-status");this.element.css({left:"10px",bottom:"0"});this._subscribeGlobalEvents()},currentStatus:null,_subscribeGlobalEvents:function(){this.options.subscribe(n.events.status.status,this._statusSubscription,this);this.options.subscribe(n.events.status.success,this._statusSuccess,this);this.options.subscribe(n.events.status.error,this._statusError,this);this.options.subscribe(n.events.status.processing,this._statusProcessing,this);this.options.subscribe(n.events.status.warning,this._statusWarning,this);this.options.subscribe(n.events.status.destroy,this.destroy,this);this.options.subscribe("status.hide",this.destroy,this);this.options.subscribe(n.events.status.importantWarning,this._statusImportantWarning,this)},_statusSubscription:function(t,r){var f=this,u=this.currentStatus,e,o;t.priority=this._getPriority(t);u&&t.priority<u.priority&&clearTimeout(u.timer);u=t;e=this._getStatusContent(t);o=this._getStatusColorClass(t.type);n.mobile&&t.priority==i.processing?(n.mobile.isTablet&&(n.mobile.$loading.attr("class",""),n.mobile.$loading.addClass(this._getStatusPositionClass(r))),n.mobile.$loading.fadeIn(),f.element.hide()):this.element.html(e).attr("class","alert egov-status "+o).show();f.element.animateCss("fadeInUp");t.duration!==0&&(u.timer=setTimeout(function(){f.element.fadeOut();f.currentStatus=null},t.duration||this.options.duration))},_importantWarningStatusSubscription:function(n){var t=this,i,r;r=this._getStatusColorClass(n.type);i=this._getStatusContent(n);this.importantWaringElement.html(i).attr("class",r).fadeIn();n.duration!==0&&(n.timer=setTimeout(function(){t.importantWaringElement.fadeOut();t.currentStatus=null},n.duration||this.options.importantWarningDuration))},_statusSuccess:function(n){var n;n=typeof n=="string"?{type:"success",message:n,undo:undefined}:{type:"success",message:n.message,undo:n.undo};this._statusSubscription(n)},_statusError:function(n){var n;n=typeof n=="string"?{type:"error",message:n,undo:undefined}:{type:"error",message:n.message,undo:n.undo};this._statusSubscription(n)},_statusProcessing:function(n,t){var i;i=typeof i=="string"?{type:"processing",message:i,undo:undefined}:{type:"processing",message:n,duration:0};this._statusSubscription(i,t)},_statusWarning:function(n){var t;t=typeof t=="string"?{type:"warning",message:t,undo:undefined}:{type:"warning",message:n};this._statusSubscription(t)},_statusImportantWarning:function(n){var t;t=typeof t=="string"?{type:"importantWarning",message:t,undo:undefined}:{type:"importantWarning",message:n};this.importantWaringElement=parent.$("#importantWarning");this._importantWarningStatusSubscription(t)},_getPriority:function(n){return i[n.type]},_getStatusContent:function(n){var r,u,i;r=t("<div>").addClass("status-content");switch(n.type){case"success":i="<img src='../../content/bkav.egov/status/images/check.svg' >";break;case"error":i="<img src='../../content/bkav.egov/status/images/error.svg' >";break;case"processing":i="<img src='../../content/bkav.egov/status/images/processing.svg' >";break;case"warning":case"importantWarning":i="<img src='../../content/bkav.egov/status/images/warning.svg' >";break;default:i="<img src='../../content/bkav.egov/status/images/info.svg' >"}return r.append(i),r.append(t("<span>").text(n.message)),n.undo&&(u=t("<a href='#' class='alert-link'>").text(n.undo.message),u.click(function(){typeof n.undo.callback=="function"&&n.undo.callback()}),r.append(u)),r},_getStatusColorClass:function(n){switch(n){case"success":return"alert-success";case"error":return"alert-danger";case"processing":return"alert-info";case"warning":case"importantWarning":return"alert-warning";default:return"alarm-info"}},_getStatusPositionClass:function(n){switch(n){case 2:return"showInDetail";default:return"showInList"}},destroy:function(){this.currentStatus&&clearTimeout(this.currentStatus.timer);n.mobile&&n.mobile.$loading&&n.mobile.$loading.fadeOut();this.element.hide()}})}(this.egov=this.egov||{},jQuery),function(n,t,i,r){var f=["áàảãạăắằẳẵặâấầẩẫậ","ÁÀẢÃẠĂẮẰẲẴẶÂẤẦẨẪẬ","đ","Đ","éèẻẽẹêếềểễệ","ÉÈẺẼẸÊẾỀỂỄỆ","íìỉĩị","ÍÌỈĨỊ","óòỏõọơớờởỡợôốồổỗộ","ÓÒỎÕỌƠỚỜỞỠỢÔỐỒỔỖỘ","ưứừửữựúùủũụ","ƯỨỪỬỮỰÚÙỦŨỤ","ýỳỷỹỵ","ÝỲỶỸỴ"],e=["a","A","d","D","e","E","i","I","o","O","u","U","y","Y"],o='<li id="${value}" label="${attr.label}" rel="${attr.rel}" idext="${attr.idext}" class="jstree-${state}"><ins class="jstree-icon">&nbsp;<\/ins><a href="#" class=""><ins class="jstree-icon">&nbsp;<\/ins>${data}<\/a><\/li>';var s='<li id="${value}" rel="${attr.rel}" idext="${attr.idext}" class="jstree-${state}"><ins class="jstree-icon">&nbsp;<\/ins><a href="#" class=""><ins class="jstree-checkbox">&nbsp;<\/ins><ins class="jstree-icon">&nbsp;<\/ins>${data}<\/a><\/li>',h='<li id="${value}" rel="${attr.rel}" idext="${attr.idext}" class="jstree-${state} jstree-unchecked"><ins class="jstree-icon">&nbsp;<\/ins><a href="#" class=""><ins class="jstree-checkbox">&nbsp;<\/ins><ins class="jstree-icon">&nbsp;<\/ins>${data}<\/a><\/li>',u=["themes","json_data","ui","crrm"];n.utilities={};n.utilities.checkbox={};n.utilities.checkbox.checkAndUnCheckAll=function(n,i,r){var u=i.length;n.bind("click",function(){for(var f=this.checked,n=0;n<u;n++)i[n].checked=f,t(i[n]).trigger("change");r&&typeof r=="function"&&r()});i.bind("click",function(){var t=0,u=0,f;i.each(function(){t++;this.checked==!0&&u++});f=t==u?!0:!1;n.prop("checked",f);r&&typeof r=="function"&&r()})};n.utilities.jstree={};n.utilities.jstree.getChildrens=function(t,r,u,f,e){var o=i.filter(u,function(n){return n.parentid==t}),h=i.filter(e,function(n){return n.departmentid===t}),c,l,s,a;if(o.length>0)for(c=0;c<o.length;c++)(n.utilities.jstree.getChildrens(o[c].value,!1,u,[],[]).length>0||r&&h.length>0)&&(o[c].state="closed");if(r&&h.length>0)for(l=0;l<h.length;l++)s=i.find(f,function(n){return n.value===h[l].userid}),s&&(a={value:"user_"+s.value,data:s.fullname,parentid:t,state:"leaf",metadata:{id:"user_"+s.value},attr:{id:"user_"+s.value,rel:"people",idext:h[l].idext}},o.push(a));return o};n.utilities.jstree.bindJsTree=function(r,f,e,o,s,h,c,l,a,v,y){var p=i.find(s,function(n){return n.parentid===0});e&&u.push("checkbox");o&&u.push("dnd");p&&r.jstree({json_data:{data:[{data:p.data.toString(),metadata:{id:p.value},state:"closed",attr:{id:p.value,rel:"dept",idext:p.idext,label:p.label},children:n.utilities.jstree.getChildrens(p.value,f,s,h,c)}]},crrm:o==!1?{}:{move:{check_move:function(n){var r=i.find(s,function(t){return t.value===parseInt(n.o.attr("id"))}),t;return r?r.level!=1?!1:(t=this._get_parent(n.o),!t)?!1:(t=t==-1?this.get_container():t,t===n.np)?!0:t[0]&&n.np[0]&&t[0]===n.np[0]?!0:!1:!1}}},dnd:o==!1?{}:{drop_target:!1,drag_target:!1},plugins:u}).bind("loaded.jstree",function(i,u){var o=1;u.inst.get_container().find("li").each(function(){u.inst.get_path(t(this)).length<=o&&u.inst.open_node(t(this))});r.bind("open_node.jstree",function(t,i){i.inst._get_children(i.rslt.obj).length==0&&n.utilities.jstree.appendChild(i.rslt.obj,parseInt(i.rslt.obj.attr("id")),f,e,s,h,c,v,y)});typeof l=="function"&&l(a)})};n.utilities.jstree.appendChild=function(i,u,f,e,c,l,a,v,y){var w,p,b;typeof v==r&&(v=!0);typeof y==r&&(y=!0);w=n.utilities.jstree.getChildrens(u,f,c,l,a);w.length>0&&(p=t("<ul><\/ul>"),p.appendTo(i),e?(b=y?s:h,t.template("checkboxTemplate",b),t.tmpl("checkboxTemplate",w).appendTo(p),v&&t(i).find("li").each(function(n,r){t(r).addClass(i.hasClass("jstree-checked")?"jstree-checked":"jstree-unchecked")})):(t.template("itemTreeviewTemplate",o),t.tmpl("itemTreeviewTemplate",w).appendTo(p)),p.children("li:last").addClass("jstree-last"))};n.utilities.string={};n.utilities.string.stripVietnameseChars=function(n){for(var i,r,t=[],u=0;u<n.length;u++)t.push(n.charAt(u));for(i=0;i<t.length;i++)for(r=0;r<f.length;r++)f[r].indexOf(t[i])>-1&&(t[i]=e[r]);return t.join("")};n.utilities.url={};n.utilities.url.getQueryStringValue=function(n,t){t||(t=location.search);n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+n+"=([^&#]*)"),i=r.exec(t);return i==null?"":decodeURIComponent(i[1].replace(/\+/g," "))};n.utilities.array={};n.utilities.array.distinct=function(n){for(var i,e,f=[],u={},t=0;t<n.length;t++)i=JSON.stringify(n[t]),e=n[t],u[i]===r?(f.push(e),u[i]=1):u[i]++;return f}}(window.egov=window.egov||{},window.jQuery,window._);bt_util_date_resource={vi:{months:["tháng 1","tháng 2","tháng 3","tháng 4","tháng 5","tháng 6","tháng 7","tháng 8","tháng 9","tháng 10","tháng 11","tháng 12"],shortMonths:["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],weeks:["chủ nhật","thứ hai","thứ ba","thứ tư","thứ năm","thứ sáu","thứ bảy"],shortWeeks:["CN","T2","T3","T4","T5","T6","T7"],times:{future:"%s tới",ago:"%s trước",s:"vài giây",m:"một phút",mm:"%d phút",h:"một giờ",hh:"%d giờ",d:"một ngày",dd:"%d ngày",M:"một tháng",MM:"%d tháng",y:"một năm",yy:"%d năm"},calendar:{sameDay:"Hôm nay",nextDay:"Ngày mai",lastDay:"Hôm qua",sameWeek:"Tuần này",nextWeek:"Tuần tới",lastWeek:"Tuần trước",sameMonth:"Tháng này",lastMonth:"Tháng trước"}}},function(){"use strict";var r,t,n,i,s,h,u,o;r=Date;t=r.prototype;n={year:"year",quarter:"quarter",month:"month",week:"week",date:"date",day:"day",hour:"hours",minute:"minutes",second:"seconds",miniSecond:"miniSecond"};s=/(\[[^\[]*\])|(\\)?(MM?M?M?|dd?d?|ww?|q|yy?yy?|a|A|hh?|HH?|mm?|ss?s?|z|.)/g;h="hh:mm dd/MM/yyyy";o="yyyy-MM-ddTHH:mm:ss";i={yy:"yy",yyyy:"yyyy",q:"q",M:"M",MM:"MM",MMM:"MMM",MMMM:"MMMM",w:"w",ww:"ww",d:"d",dd:"dd",ddd:"ddd",h:"h",hh:"hh",H:"H",HH:"HH",a:"a",A:"A",m:"m",mm:"mm",s:"s",ss:"ss",sss:"sss",z:"z"};u=bt_util_date_resource.vi;t.format=function(n){var r,u,t,i,f="";for(n=n||h,r=n.match(s),u=r.length,i=0;i<u;i++)t=r[i].toString(),t=t.replace("[","").replace("]",""),f+=l(t)?this._getFormattingValue(t):t;return f};t.subtract=function(t,i){switch(i){case n.year:this.year(this.year()-t);break;case n.month:this.month(this.month()-t);break;case n.date:return this.date(this.date()-t),this;case n.hour:this.hours(this.hours()-t);break;case n.minute:this.minutes(this.minutes()-t);break;case n.second:this.seconds(this.seconds()-t);break;case n.miniSecond:this.miniSeconds(this.miniSeconds()-t)}return this};t.add=function(t,i){switch(i){case n.year:this.year(this.year()+t);break;case n.month:this.month(this.month()+t);break;case n.date:return this.date(this.date()+t),this;case n.hour:this.hours(this.hours()+t);break;case n.minute:this.minutes(this.minutes()+t);break;case n.second:this.seconds(this.seconds()+t);break;case n.miniSecond:this.miniSeconds(this.miniSeconds()+t)}return this};t.month=function(n){return(n==2&&this.date()>28&&this.date(28),f(n))?(this.setMonth(n-1),this):this.getMonth()+1};t.year=function(n){return f(n)?(this.setFullYear(n),this):this.getFullYear()};t.date=function(n){return f(n)?(this.setDate(n),this):this.getDate()};t.day=function(){return this.getDay()};t.weekOfYear=function(){var n=new Date(this.getFullYear(),0,1);return Math.ceil(((this-n)/864e5+n.day()-1)/7)};t.dayOfYear=function(){var n=new Date(this.getFullYear(),0,1);return Math.ceil((this-n)/864e5)};t.hours=function(n){return f(n)?(this.setHours(n),this):this.getHours()};t.minutes=function(n){return f(n)?(this.setMinutes(n),this):this.getMinutes()};t.seconds=function(n){return f(n)?(this.setSeconds(n),this):this.getSeconds()};t.miniSeconds=function(n){return f(n)?(this.setMilliseconds(n),this):this.getMilliseconds()};t.quarter=function(){return Math.floor((this.month()-1)/3+1)};t.endOf=function(t){if(n[t]===undefined)throw"Đơn vị truyền vào không hợp lệ.";var f,e,u,i,o;f=this.year();e=this.quarter();u=this.month();o=this.date();switch(t){case n.year:this.month(12).date(31).hours(23).minutes(59).seconds(59).miniSeconds(999);break;case n.quarter:u=e*3;i=r.daysInMonth(u,f);this.month(u).date(i).hours(23).minutes(59).seconds(59).miniSeconds(999);break;case n.month:i=r.daysInMonth(u,f);this.date(i).hours(23).minutes(59).seconds(59).miniSeconds(999);break;case n.week:i=o-this.day()+6;this.date(i).hours(23).minutes(59).seconds(59).miniSeconds(999);break;case n.day:this.hours(23).minutes(59).seconds(59).miniSeconds(999);break;case n.hour:this.minutes(59).seconds(59).miniSeconds(999);break;case n.minute:this.seconds(59).miniSeconds(999);break;case n.second:this.miniSeconds(999)}return this};t.startOf=function(t){if(n[t]===undefined)throw"Đơn vị truyền vào không hợp lệ.";var i,r,u,f;i=this.quarter();f=this.date();switch(t){case n.year:this.month(1).date(1).hours(0).minutes(0).seconds(0).miniSeconds(0);break;case n.quarter:r=i*3-2;this.month(r).date(1).hours(0).minutes(0).seconds(0).miniSeconds(0);break;case n.month:this.date(1).hours(0).minutes(0).seconds(0).miniSeconds(0);break;case n.week:u=f-this.day();this.date(u).hours(0).minutes(0).seconds(0).miniSeconds(0);break;case n.day:this.hours(0).minutes(0).seconds(0).miniSeconds(0);break;case n.hour:this.minutes(0).seconds(0).miniSeconds(0);break;case n.minute:this.seconds(0).miniSeconds(0);break;case n.second:this.miniSeconds(0)}return this};t.isLeapYear=function(){return year%4==0&&year%100!=0||year%400==0};t._getFormattingValue=function(n){var t;switch(n){case i.yy:t=this.year().toString().substr(2,2);break;case i.yyyy:t=this.year();break;case i.q:t=this.quarter();break;case i.M:t=this.month();break;case i.MM:t=e(this.month());break;case i.MMM:t=u.shortMonths[this.month()-1];break;case i.MMMM:t=u.months[this.month()-1];break;case i.d:t=this.date();break;case i.dd:t=e(this.date());break;case i.ddd:t=u.weeks[this.day()];break;case i.h:t=c(this.hours());break;case i.hh:t=e(c(this.hours()));break;case i.H:t=this.hours();break;case i.HH:t=e(this.hours());break;case i.m:t=this.minutes();break;case i.mm:t=e(this.minutes());break;case i.s:t=this.seconds();break;case i.ss:t=e(this.seconds());break;case i.S:t=this.miniSeconds();break;case i.Z:t=this.year();break;default:t=""}return t};t.relativeDate=function(){var t=Math.floor((new Date-this)/1e3),n=Math.floor(t/31536e3);return n>1?n+" năm":(n=Math.floor(t/2592e3),n>1)?n+" Thg":(n=Math.floor(t/604800),n>1)?n+" tuần":(n=Math.floor(t/86400),n>1)?n+" ngày":(n=Math.floor(t/3600),n>1)?n+" giờ":(n=Math.floor(t/60),n>1)?n+" phút":"Vừa mới"};t.toServerString=function(){return this.format(o)};t.getVNDay=function(){var n=this.getDay();return bt_util_date_resource.vi.weeks[n]};t.timeInWord=function(){var r=this,t=Date.now(),f=t.format("yyyyMMwwdd"),e=t.subtract(1,n.date).format("yyyyMMwwdd"),o=t.format("yyyyMMww"),s=t.subtract(1,n.week).format("yyyyMMww"),h=t.format("yyyyMM"),c=t.subtract(1,n.month).format("yyyyMM"),l=t.format("yyyy"),i=r.format("yyyyMMwwddhh");return i.indexOf(f)===0?u.calendar.sameDay:i.indexOf(e)===0?u.calendar.lastDay:i.indexOf(o)===0?u.calendar.sameWeek:i.indexOf(s)===0?u.calendar.lastWeek:i.indexOf(h)===0?u.calendar.sameMonth:i.indexOf(c)===0?u.calendar.lastMonth:i.indexOf(l)===0?r.format("[Tháng] MM"):r.format("[Tháng] MM - yyyy")};t.isToday=function(){var n=Date.now().format("yyyyMMdd"),t=this.format("yyyyMMdd");return t===n};t.isYesterday=function(){var t=(new Date).add(-1,n.date).format("yyyyMMdd"),i=this.format("yyyyMMdd");return i===t};r.parse=function(n,t){return(t=t||o,!n)?null:Globalize?Globalize.parseDate(n,t):null};r.parseFromIsoString=function(n){var t=n.split(/[^0-9]/);return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])};r.daysInMonth=function(n,t){return new Date(t,n,0).date()};r.compare=function(){};r.max=function(){};r.min=function(){};r.now=function(){return new Date};var f=function(n){return n!==undefined&&n!==null},yt=function(n){return typeof n=="object"},pt=function(){},e=function(n){return n>9?n:"0"+n},c=function(n){return n>12?n-12:n},l=function(n){return i[n]!==undefined}}(this),function(){var t=String,n=t.prototype,i=["aáàảãạăắằẳẵặâấầẩẫậ","AÁÀẢÃẠĂẮẰẲẴẶÂẤẦẨẪẬ","dđ","DĐ","eéèẻẽẹêếềểễệ","EÉÈẺẼẸÊẾỀỂỄỆ","iíìỉĩị","IÍÌỈĨỊ","oóòỏõọơớờởỡợôốồổỗộ","OÓÒỎÕỌƠỚỜỞỠỢÔỐỒỔỖỘ","uưứừửữựúùủũụ","UƯỨỪỬỮỰÚÙỦŨỤ","yýỳỷỹỵ","YÝỲỶỸỴ"];n.trim=function(){return this.replace(/^\s+|\s+$/g,"")};n.trimStart=function(){return this.replace(/^\s+/,"")};n.trimEnd=function(){return this.replace(/\s+$/,"")};n.startWith=function(n,t){if(!String.isString(n))throw"Giá trị truyền vào không hợp lệ";return t=t||!1,n.equals(this.substr(0,n.length),t)};n.endWith=function(n,t){if(!String.isString(n))throw"Giá trị truyền vào không hợp lệ";return t=t||!1,n.equals(this.substr(this.length-n.length),t)};n.equals=function(n,t){if(!String.isString(n))throw"Giá trị truyền vào không hợp lệ";return t=t||!1,t?this.toLowerCase()===n.toLowerCase():this.toString()===n};n.remove=function(n,t){var i;if(typeof n!="number")throw"Start Index phải là một chữ số";return i=this.slice(0,n),t!=undefined&&typeof t=="number"&&(i+=this.slice(n+t)),i};n.replaceAll=function(n,t){if(!String.isString(n)||!String.isString(t))throw"Các tham số truyền vào phải là string";var i=new RegExp(n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");return this.replace(i,t)};n.contains=function(n){if(!String.isString(n))throw"Tham số truyền vào phải là chuỗi";return this.indexOf(n)>-1};n.toCharArray=function(){return this.split("")};n.reverse=function(){return this.split("").reverse().join("")};n.forEach=function(n){if(typeof n=="function")for(var i=this.length,t=0;t<i;t++)n(this.charAt(t),t)};n.removeVietnamChars=function(){var t=[],r=this,n;return r.forEach(function(r,u){for(t[u]=r,n=0;n<i.length;n++)if(i[n].contains(r)){t[u]=i[n][0];break}}),t.join("")};t.format=function(){return String._toFormattedString(!1,arguments)};t.isNullOrEmpty=function(n){return n===null||n===undefined||n===""};t.isNUllOrWhiteSpace=function(n){return n=n.trim(),String.isNullOrEmpty(n)};t.isString=function(n){return typeof n=="string"};t._toFormattedString=function(n,t){for(var e,u,s,i,o="",f=t[0],r=0;;){if(e=f.indexOf("{",r),u=f.indexOf("}",r),e<0&&u<0){o+=f.slice(r);break}if(u>0&&(u<e||e<0)){if(f.charAt(u+1)!=="}")throw new Error("format stringFormatBraceMismatch");o+=f.slice(r,u+1);r=u+2;continue}if(o+=f.slice(r,e),r=e+1,f.charAt(r)==="{"){o+="{";r++;continue}if(u<0)throw new Error("format stringFormatBraceMismatch");var h=f.substring(r,u),c=h.indexOf(":"),l=parseInt(c<0?h:h.substring(0,c),10)+1;if(isNaN(l))throw new Error("format stringFormatInvalid");s=c<0?"":h.substring(c+1);i=t[l];(typeof i=="undefined"||i===null)&&(i="");o+=i.toFormattedString?i.toFormattedString(s):n&&i.localeFormat?i.localeFormat(s):i.format?i.format(s):i.toString();r=u+1}return o}}(this),function(n){var t=["pdf","png","gif","jpg","jpeg","bmp"],i=/(.doc|.docx|.pdf|.xls|.xlsx)$/i,r={getFileName:function(n){var t=n.lastIndexOf(".");return t===-1?n:n.substring(0,t)},getExtension:function(n){var t=n.lastIndexOf("."),i;return t===-1?"":(i=n.substring(t+1,n.length),i.toLowerCase())},getExtensionWithDot:function(n){var t=this.getExtension(n);return t===""?"":"."+t},isPdf:function(n){var t=this.getExtensionWithDot(n);return t===".pdf"},isMsOfficeFile:function(n){var t=this.getExtensionWithDot(n);return t===".doc"||t===".docx"},isReadonly:function(n){var i=this.getExtension(n);return t.indexOf(i)>=0},isForSign:function(n){var t=this.getExtensionWithDot(n);return i.test(t)},getSizeText:function(n){var t=1024,i=1048576,r=1073741824;return n>=r?Math.round(n/r)+" GB":n>=i?Math.round(n/i)+" MB":n>=t?Math.round(n/t)+" KB":n+" bytes"},downloadUri:function(n,t){var i=document.createElement("a");i.download=t;i.href=n;i.style.display="none";document.body.appendChild(i);i.click();document.body.removeChild(i);delete i}};n.fileExtension=r}(window.egov||{}),function(){"use strict";var n={RecentTabs:"RecentTabs",DocumentHeaderWidth:"DocumentHeaderWidth_",PageSize:"PageSize",IgnoreConfirmRelations:"ConfirmRelation",viewSize:"ViewSize",quickView:"QuickView",mudimMethod:"MudimMethod",useVietKey:"UseVietKey",displayPopupTransferTheoLo:"displayPopupTransferTheoLo",lastApp:"lastApp"},t={addRecentTab:function(t,i){var r=this.getCookie(n.RecentTabs),u;r||(r={});u=r[t];u===undefined&&(u=[]);u.push(i);r[t]=u;$.cookie(n.RecentTabs,JSON.stringify(r),{secure:!0})},getRecentTab:function(t){var i=this.getCookie(n.RecentTabs);return i?i[t]:[]},deleteRecentTab:function(t,i){var r=this.getCookie(n.RecentTabs);r&&(r[t]=_.reject(r[t],function(n){return n.id===i.id}),$.cookie(n.RecentTabs,JSON.stringify(r),{secure:!0}))},addDocumentHeaderWidth:function(t,i){$.cookie(n.DocumentHeaderWidth+t,JSON.stringify(i),{expires:7,path:"/",secure:!0})},getDocumentHeaderWidth:function(t){return this.getCookie(n.DocumentHeaderWidth+t)},addPageSize:function(t){t&&typeof t=="number"&&$.cookie(n.PageSize,t,{expires:7,path:"/",secure:!0})},getPageSize:function(){var t=$.cookie(n.PageSize);return parseInt(t)},getCookie:function(n){var t=$.cookie(n);return JSON.parse(t)},setIgnoreConfirmRelation:function(t){$.cookie(n.IgnoreConfirmRelations,t,{secure:!0})},getIgnoreConfirmRelation:function(){return $.cookie(n.IgnoreConfirmRelations)},viewSize:function(t){if(t===undefined)return parseInt($.cookie(n.viewSize));$.cookie(n.viewSize,t,{expires:30,secure:!0})},setQuickView:function(t){$.cookie(n.quickView,t,{secure:!0})},getQuickView:function(){return parseInt($.cookie(n.quickView))},setLastApp:function(t){$.cookie(n.lastApp,t,{secure:!0})},getLastApp:function(){return $.cookie(n.lastApp)},setMudimMethod:function(t){$.cookie(n.mudimMethod,t,{path:"/",secure:!0})},getMudimMethod:function(){return parseInt($.cookie(n.mudimMethod))},getUseVietKey:function(){return parseInt($.cookie(n.useVietKey))},displayPopupTransferTheoLo:function(t){if(t===undefined){var i=$.cookie(n.displayPopupTransferTheoLo);return i==="true"||i==1}$.cookie(n.displayPopupTransferTheoLo,t,{path:"/",secure:!0})}};window.eGovCookie=t}(),function(){"use strict";var n={RecentTabs:"RecentTabs",DocumentHeaderWidth:"DocumentHeaderWidth_",PageSize:"PageSize",IgnoreConfirmRelations:"ConfirmRelation",viewSize:"ViewSize",quickView:"QuickView",mudimMethod:"MudimMethod",useVietKey:"UseVietKey",displayPopupTransferTheoLo:"displayPopupTransferTheoLo",lastApp:"lastApp"},t={addRecentTab:function(t,i){var r=this.getLocalStorage(n.RecentTabs),u;r||(r={});u=r[t];u===undefined&&(u=[]);u.push(i);r[t]=u;egov.locache.setDefault(n.RecentTabs,JSON.stringify(r))},getRecentTab:function(t){var i=this.getLocalStorage(n.RecentTabs);return i?i[t]:[]},deleteRecentTab:function(t,i){var r=this.getLocalStorage(n.RecentTabs);r&&(r[t]=_.reject(r[t],function(n){return n.id===i.id}),egov.locache.setDefault(n.RecentTabs,JSON.stringify(r)))},addDocumentHeaderWidth:function(t,i){egov.locache.setDefault(n.DocumentHeaderWidth+t,JSON.stringify(i))},getDocumentHeaderWidth:function(t){return this.getLocalStorage(n.DocumentHeaderWidth+t)},addPageSize:function(t){t&&typeof t=="number"&&egov.locache.setDefault(n.PageSize,t)},getPageSize:function(){var t=egov.locache.getDefault(n.PageSize);return parseInt(t)},getLocalStorage:function(n){var t=egov.locache.getDefault(n);return JSON.parse(t)},setIgnoreConfirmRelation:function(t){egov.locache.setDefault(n.IgnoreConfirmRelations,t)},getIgnoreConfirmRelation:function(){return egov.locache.getDefault(n.IgnoreConfirmRelations)},viewSize:function(t){if(t===undefined)return parseInt(egov.locache.getDefault(n.viewSize));egov.locache.setDefault(n.viewSize,t)},setQuickView:function(t){egov.locache.setDefault(n.quickView,t)},getQuickView:function(){return parseInt(egov.locache.getDefault(n.quickView))},setLastApp:function(t){egov.locache.setDefault(n.lastApp,t)},getLastApp:function(){return egov.locache.getDefault(n.lastApp)},setMudimMethod:function(t){egov.locache.setDefault(n.mudimMethod,t)},getMudimMethod:function(){return parseInt(egov.locache.getDefault(n.mudimMethod))},getUseVietKey:function(){return parseInt(egov.locache.getDefault(n.useVietKey))},displayPopupTransferTheoLo:function(t){if(t===undefined){var i=egov.locache.getDefault(n.displayPopupTransferTheoLo);return i==="true"||i==1}egov.locache.setDefault(n.displayPopupTransferTheoLo,t)}};window.eGovLocalStorage=t}(),function(){"use strict";var i={Ok:1,YesNo:2,OkCancel:3},n={Ok:1,Yes:2,No:3,Cancel:4},t={success:1,error:2,warning:3,processing:4},r=Backbone.View.extend({el:".alert",initialize:function(){this.messageButtons=i;this.messageResult=n;this.messageTypes=t;this.autoHide=!1},show:function(n,t,i,r,u,s){this.hide();require(["dialog"],function(){var h=f(),c;s&&(h=$.extend(h,s));c=e();typeof n!="string"&&(n="");c.html(n);typeof t=="string"&&t!==""&&(h.title=t);h.buttons=o(i,r,u,c);c.dialog(h)})},prompt:function(n,t,i,r,u){var f=$('<div><textarea class="form-control" row="4" style="height: 80px"><\/textarea><\/div>'),e;f.dialog({title:n,width:"400px",height:"120px",draggable:!0,keyboard:!0,buttons:[{text:t,className:"btn-primary",click:function(){var n=f.find("textarea").val();if(r&&(n===""||n==null)){f.find("textarea").addClass("input-validation-error").first().focus();return}typeof i=="function"&&i(n);f.dialog("destroy")}},{text:egov.resources.common.closeButton,click:function(){f.dialog("destroy")}}]});e=f.find("textarea");u?e.focus().val(u):e.focus()},promptHasConfirmDisplay:function(n){var r=this,t=$('<div><textarea class="form-control" row="5" style="height: 120px"><\/textarea><\/div>'),i=t.find("textarea");t.dialog({title:n.title,width:"500px",height:"150px",draggable:!0,keyboard:!0,confirm:{id:"hasDisplay",text:n.confirmTitleName,style:{float:"left",display:"inline-block","font-size":"13px","font-weight":"normal"},callback:function(t){typeof n.callbackConfirm=="function"&&n.callbackConfirm(t)}},buttons:[{text:n.confirmButtonName,className:"btn-primary",click:function(){var i=t.find("textarea").val();if(n.isCheckNullOrEmpty&&(i===""||i==null)){t.find("textarea").addClass("input-validation-error").first().focus();return}typeof n.callback=="function"&&n.callback(i);t.dialog("destroy")}},{text:egov.resources.common.closeButton,className:"btn-close",click:function(){typeof n.callbackCloseForm=="function"&&n.callbackCloseForm();t.dialog("destroy")}}]});i.focus()},notification:function(n,t,i){if(n==="hide"){this.hide();return}if(i==undefined&&(i=!0),t==undefined&&(t=this.messageTypes.success),this.$el.removeClass(),this.$el.addClass(u(t)),this.$el.html(n),i){var r=this;this.$el.fadeIn();setTimeout(function(){r.hide()},1e4)}else this.$el.fadeIn()},processing:function(n,t){this.notification(n,this.messageTypes.processing,t)},error:function(n,t){this.notification(n,this.messageTypes.error,t)},success:function(n,t){this.notification(n,this.messageTypes.success,t)},warning:function(n,t){this.notification(n,this.messageTypes.warning,t)},hide:function(){this.$el.fadeOut("slow")}}),u=function(n){switch(n){case t.success:return"alert alert-success";case t.error:return"alert alert-danger";case t.warning:return"alert alert-warning";case t.processing:return"alert alert-info";default:return""}},f=function(){return{height:"auto",width:"600px",title:"Thông báo",draggable:!0,buttons:[],close:function(){}}},e=function(){var n=$("<div>");return n.css("min-width","200px"),n},o=function(t,r,u,f){if(typeof t!="number")return[];var e=[],o={Yes:egov.resources.common.messageYesBtn?egov.resources.common.messageYesBtn:"Yes",No:egov.resources.common.messageNoBtn?egov.resources.common.messageNoBtn:"No",Cancel:egov.resources.common.messageCancelBtn?egov.resources.common.messageCancelBtn:"Cancel",Ok:egov.resources.common.messageOkBtn?egov.resources.common.messageOkBtn:"Ok"};switch(t){case i.YesNo:e.push({text:o.Yes,className:"btn-primary",click:function(){return f.dialog("destroy"),typeof r=="function"&&r(),n.Yes}});e.push({text:o.No,click:function(){return f.dialog("destroy"),typeof u=="function"&&u(),n.No}});break;case i.OkCancel:e.push({text:o.Ok,className:"btn-primary",click:function(){return f.dialog("destroy"),typeof r=="function"&&r(),n.OK}});e.push({text:o.Cancel,click:function(){return f.dialog("destroy"),typeof u=="function"&&u(),n.Cancel}});break;default:e.push({text:o.Ok,className:"btn-primary",click:function(){return f.dialog("destroy"),typeof r=="function"&&r(),n.OK}})}return e};return window.eGovMessage=r,r}(),function(n){if(typeof n=="undefined")throw"Thư viện này sử dụng jQuery, hãy tải thư viện jQuery trước khi sử dụng";var t=function(t,i){if(t.find(".trodd").removeClass("trodd"),t.find("tr:odd").addClass("trodd"),i){var r=t.find("tr");r.length>0&&(r.hover(function(){n(this).addClass("hover-row")},function(){n(this).removeClass("hover-row")}),r.click(function(){r.removeClass("highlight-row");n(this).addClass("highlight-row")}),r.mousedown(function(t){t.which===3&&(r.removeClass("highlight-row"),n(this).addClass("highlight-row"))}),n(".grid-content table tbody tr input, .grid-content table tbody tr a, .grid-content table tbody tr button").unbind("click").click(function(n){return n.stopPropagation(),!0}))}},i=function(){if("localStorage"in window&&window.localStorage!==null)try{return window.localStorage.setItem("egov","Bkav Corporation"),window.localStorage.removeItem("egov"),!0}catch(n){return!1}else return!1};jQuery.fn.grid=function(r){if(typeof r=="string"&&r.toLowerCase()==="refresh"){this.each(function(i,r){t(n(r).parent(),n(r).data()["bkav.grid"].isAddHoverRow)});return}r=n.extend({isUsingCustomScroll:!1,isAutoHideScroll:!0,isResizeColumn:!0,isFixHeightContent:!0,isAddHoverRow:!0,isUseCookie:!0,isRenderPanelGrid:!0,onresizefinish:function(){}},r);this.each(function(u,f){var g=null,nt=null,rt=null,lt=null,ut=null,h=null,o=n(f),s,et,ot,st,e,k,at,it,w,l,v,ct,vt,d,b;if(o.length===0||o[0].tagName!=="TABLE")return!1;o.data("bkav.grid",r);r.isRenderPanelGrid?(s=n("<div><\/div>"),o.after(s)):s=o.parent();s.attr("data-key",o.attr("id"));s.hasClass("grid")||s.addClass("grid");r.width&&(typeof r.width=="number"?s.width(r.width+"px"):typeof r.width=="string"&&s.width(r.width));o.hasClass("table-main")||o.addClass("table-main");var tt=n('<div class="grid-header"><\/div>'),c=n('<div class="grid-header-wrap"><\/div>'),y=n('<table class="table table-hover table-main"><\/table>'),yt=o.find("thead tr:first th").length,ft=n("<colgroup><\/colgroup>");if(y.append(ft),o.find("col").length===0)for(et=n("<colgroup><\/colgroup>"),o.children("tbody").before(et),ot=0;ot<yt;ot++)ft.append("<col />"),et.append("<col />");else ft.append(o.find("colgroup").html());if(o.find("thead tr:first th").each(function(t,i){n(i).hasClass("header")||n(i).addClass("header")}),y.append(o.find("thead")),c.append(y),tt.append(c),s.append(tt),o.find("tfoot tr td").length>0&&(st=n('<div class="grid-pager grid-pager-wrap grid-pager-bottom"><\/div>'),st.append(o.find("tfoot tr td:first").html()),s.append(st),o.find("tfoot").remove()),e=n('<div class="grid-content"><\/div>'),e.append(o),tt.after(e),t(e,r.isAddHoverRow),r.isFixHeightContent?(e.css({"overflow-y":"auto"}),r.height&&(typeof r.height=="number"?e.height(r.height+"px"):typeof r.height=="string"&&e.height(r.height))):(e.css({"overflow-y":"visible",height:""}),r.height&&(typeof r.height=="number"?s.height(r.height+"px"):typeof r.height=="string"&&s.height(r.height))),r.isResizeColumn){k=u+"_"+o.attr("id")+"_"+window.location.pathname;at=y.find("thead tr:first th");e.bind("mousedown, mouseup, mousemove",function(){var t=n(this).scrollLeft();c.css({"margin-left":-t})});it=null;r.isUseCookie&&(it=i()?window.localStorage.getItem(k):n.cookie(k));var a=c.find("col"),p=e.children("table"),ht=e.find("col");if(y.css({minWidth:"1024px"}),p.css({minWidth:"100%"}),r.isFixHeightContent&&!r.isUsingCustomScroll&&e.height()<p.height()&&(tt.css("padding-right",n.layout.scrollbarWidth()+"px"),p.css("padding-right",n.layout.scrollbarWidth()+"px")),it){if(w=it.split(","),w.length==a.length){for(h=0,l=0;l<w.length;l++)a.eq(l)&&(a.eq(l).width(w[l]+"px"),ht.eq(l).width(w[l]+"px"),h+=parseInt(w[l]));y.width(h+"px");p.width(h+"px")}}else if(v=[],ct=0,a.each(function(t){n(this).width()==0||n(this).inlineStyle("width")==null?v.push(t):ct+=n(this).width()}),v.length>0)for(h=s.width(),r.isFixHeightContent&&!r.isUsingCustomScroll&&(h=h-n.layout.scrollbarWidth()),vt=h-ct,d=vt/v.length,b=0;b<v.length;b++)b==v.length-1&&(d=d-n.layout.scrollbarWidth()),a.eq(v[b]).width(d),ht.eq(v[b]).width(d);else h=0,a.each(function(t,i){h+=n(i).width()});r.isUsingCustomScroll&&e.niceScroll({autohidemode:r.isAutoHideScroll});at.each(function(t,u){n(u).unbind("mousedown").mousedown(function(t){if(n(t.target).css("cursor")=="w-resize"){t.preventDefault();n("body").addClass("unselectable");g=!0;nt=t.target;rt=n(nt).index();lt=t.clientX;ut=n(nt).outerWidth();h=p.width();var u=n('<div id="resize-column-layer" style="position:fixed; z-index:10000; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;cursor: w-resize !important;border-right:1px solid gray"><\/div>').css({height:n(document).height(),width:n(document).width(),display:"block"}).mousemove(function(n){var t,i;g&&(t=lt-n.clientX,ut-t>10&&(i=ut-t,a.eq(rt).width(i),ht.eq(rt).width(i),y.width(h-t),c.width(h-t),p.width(h-t),e.width(h-t)));c.css({"margin-left":-e.scrollLeft()})}).mouseup(function(t){var h,l,o;if(g){if(g=!1,nt=null,n("body").css({cursor:""}),n("body").removeClass("unselectable"),r.isUseCookie){var f=[],u=[],s=0;if(a.each(function(t){n(this).width()==0||n(this).inlineStyle("width")==null?u.push(t):s+=n(this).width();f.push(n(this).width())}),u.length>0)for(h=p.width()-s,l=h/u.length,o=0;o<u.length;o++)f[u[o]]=l;i()?window.localStorage.setItem(k,f.join(",")):n.cookie(k,f.join(","),{expires:7,path:"/",secure:!0})}r.onresizefinish&&n.isFunction(r.onresizefinish)&&r.onresizefinish();r.isUsingCustomScroll&&e.getNiceScroll().resize();c.css({"margin-left":-e.scrollLeft()});n(t.target).css({cursor:"w-resize","border-right":""});n(this).remove()}}).appendTo("body");n.support.fixedPosition||u.css({position:"absolute",height:n(document).height()})}});n(u).unbind("mousemove").mousemove(function(t){if(n(t.target).attr("class")!="grid-header-wrap"&&n(t.target).attr("class")=="header"){var i=n(t.target).bounds();c.css({"margin-left":-e.scrollLeft()});Math.abs(i.left+i.width+10-t.clientX)<=10?n(t.target).css({cursor:"w-resize"}):n(t.target).css({cursor:""})}})})}else e.css({"overflow-x":"visible"}),c.css("width",s.width()-1).children("table").css("width",s.width()-1),e.css("width",s.width()-2).children("table").css("width",s.width()-2)})}}(window.jQuery),function(n){jQuery.fn.bounds=function(){var t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:Number.NaN,height:Number.NaN};return this.each(function(i,r){var f=n(r),u=f.offset();u.right=u.left+n(f).width();u.bottom=u.top+n(f).height();u.left<t.left&&(t.left=u.left);u.top<t.top&&(t.top=u.top);u.right>t.right&&(t.right=u.right);u.bottom>t.bottom&&(t.bottom=u.bottom)}),t.width=t.right-t.left,t.height=t.bottom-t.top,t}}(window.jQuery),function(n){n.fn.inlineStyle=function(t){var r=n(this).attr("style"),e,u,i,f;if(r==null||r==undefined)return null;for(u=r.split(";"),i=0;i<u.length;i++)f=u[i].split(":"),n.trim(f[0])===t&&(e=f[1]);return e}}(window.jQuery),function(n){n.fn.tableSelect=function(t){var i={clickedClass:"selected",clickCallback:null,contextCallback:null,tableCallback:null},f,u,e,r,o;if(i=n.extend(i,t),f=n(this),f[0].tagName!=="TABLE")return!1;r=n(f).find("tr");o=function(){n.each(r,function(){n(this).removeClass(i.clickedClass)})};n.each(r,function(){var t=n(this);t.children("td").attr("class","");t.children("td").attr("unselectable","on");t.on("click",function(t){var f=n(this),s;if(t.shiftKey){var h=r.index(u),c=r.index(this),l=Math.min(c,h),a=Math.max(c,h)+1;for(o(),s=l;s<a;s++)n(r[s]).hasClass(i.clickedClass)||n(r[s]).addClass(i.clickedClass);e=u}else t.ctrlKey?(this.className.search(i.clickedClass)>-1?f.removeClass(i.clickedClass):f.hasClass(i.clickedClass)||f.addClass(i.clickedClass),u=this,e=this):(o(),f.hasClass(i.clickedClass)||(f.addClass(i.clickedClass),u=this,e=this));typeof i.clickCallback=="function"&&i.clickCallback()});!t.hasClass(i.clickedClass);i.tableCallback&&typeof i.tableCallback=="function"&&i.tableCallback()})};n.fn.openLink=function(t){var i={event:"dblclick",urlOpen:""},r=n(this),u,f;if(i=n.extend(i,t),r[0].tagName!=="TABLE"||i.urlOpen==null||i.urlOpen==""||i.event==null||i.event=="")return!1;u=n(r).find("tr");n.each(u,function(){var t=n(this);t.on(i.event,function(){var t=n(this),r=t.attr("id")||t.attr("data-id");urlOpen=f(i.urlOpen);r&&urlOpen!=null&&urlOpen!=""&&(document.location.href=urlOpen+"/"+r)})});String.prototype.endsWith||(String.prototype.endsWith=function(n,t){var i=this.toString(),r;return(typeof t!="number"||!isFinite(t)||Math.floor(t)!==t||t>i.length)&&(t=i.length),t-=n.length,r=i.indexOf(n,t),r!==-1&&r===t});f=function(n){return n==""||n==null?null:(n.endsWith("/")&&(n=n.substring(0,n.lastIndexOf("/"))),n)}}}(jQuery),function(){egov=egov||{};egov.popup={open:function(n,t,i,r){var u,f;u=i?i:egov.setting&&egov.setting.userSetting&&egov.setting.userSetting.PopUpWidth?egov.setting.userSetting.PopUpWidth:900;f=r?i:egov.setting&&egov.setting.userSetting&&egov.setting.userSetting.PopUpHeight?egov.setting.userSetting.PopUpHeight:575;window.open(n,t,"width="+u+",height="+f)},autoSaveSize:function(){var n=function(){var n=0;return function(t,i){clearTimeout(n);n=setTimeout(t,i)}}();$(window).resize(function(){var t=this;n(function(){egov.request.setPopUpSize({data:{width:t.innerWidth,height:t.innerHeight}})},500)})}}}(),function(){"use strict";var n=Backbone.View.extend({selectedClass:"rowSelected",events:{"click tr":"selected","click .checkAll":"selectMany","mousedown th":"startResize",mousemove:"onResize",mouseup:"endResize"},pressed:!1,startWidth:undefined,initialize:function(n){this.$el=n.el;this.resizable=n.resizable;this.scrollable=n.scrollable;this.render()},render:function(){this.resizable&&this.renderResizable();this.scrollable&&this.renderScollable()},startResize:function(){this.pressed=!0},onResize:function(){this.pressed&&this.$el.find("colgroup").remove()},endResize:function(){this.pressed&&(this.pressed=!1)},selected:function(n){var r=$(n.target),t=r.is("tr")?r:r.parents("tr"),u,i,f;if(n&&n.preventDefault(),n=n||{},u=n.ctrlKey||$(n.target).closest('.checkbox, [type="checkbox"]').length>0,n.shiftKey){var e=this.$el.find("."+this.selectedClass).first().index(),o=t.index(),s=this.$el.find("tr");for(this.removeAllSelected(),i=e;i<=o;i++)f=s.eq(i),f.addClass(this.selectedClass),this.select(f)}else u?t.hasClass(this.selectedClass)?(t.find('.checkbox, [type="checkbox"]').removeClass("checked").prop("checked",!1),t.removeClass(this.selectedClass)):this.select(t):(this.removeAllSelected(),this.select(t));u&&n.stopPropagation()},select:function(n){n.addClass(this.selectedClass);n.find('.checkbox, [type="checkbox"]').addClass("checked").prop("checked",!0)},selectAll:function(){this.$el.find("tr").addClass(this.selectedClass);this.$('tr .checkbox, tr [type="checkbox"]').addClass("checked").prop("checked",!0)},selectMany:function(n){var t=$(n.target).closest(".checkAll");t.hasClass("checked")||t.is(":checked")?(this.removeAllSelected(),t.removeClass("checked").removeAttr("checked")):(this.selectAll(),t.addClass("checked").prop("checked",!0));n&&(n.stopPropagation(),n.preventDefault())},removeAllSelected:function(){this.$("tr").removeClass(this.selectedClass);this.$('tr .checkbox, tr [type="checkbox"]').removeClass("checked").prop("checked",!1)},renderResizable:function(){this.$("th").resizable()},renderScollable:function(){}});egov.utils.table=n}(),function(){"use strict";var r=".qtooltip",u=".edropdown",f=".shortkey",n=function(){};n.prototype.initShortKeyHelper=function(){s()};n.prototype.bind=function(n){n instanceof jQuery||(n=$(n));n.each(function(n,f){if(f=$(f),f.is(r))e(f);else if(f.is(u))o(f);else{var s=i();s.position=t($(f));f.qtip(s)}})};n.prototype.destroy=function(n){n.qtip("destroy")};var e=function(n){var r=$(n),u=i();u.events={show:function(){var i=r.data("qtip").elements.target,n=t(r);i.qtip("option",{"position.at":n.at,"position.my":n.my})}};r.qtip(u)},t=function(n){var t=n.offset().left,e=n.offset().top,s=n.height(),o=n.width(),h=n.attr("etip-width"),i="top",r="center",u="bottom",f="center";return t<20&&(r="left",f="left"),(t+o>window.innerWidth-h/2||t+o>window.innerWidth-50)&&(r="right",f="right"),e<20&&(u="bottom",i="top"),e+s>window.innerHeight-20&&(i="bottom",u="top"),{my:i+r,at:u+f}},o=function(n){var i=$(n),r=i.attr("content-id"),o=i.attr("data-url"),u=i.attr("show-tip")=="true",s=t(i),f,e;s.adjust={y:u?5:13};f=i.attr("etip-width");e=i.attr("etip-height");i.qtip({content:{text:function(n,t){if(r!=undefined&&r!=="")return r.indexOf("#")<0&&(r="#"+r),$(r);$.ajax({url:o,type:"POST"}).then(function(n){t.set("content.text",n)},function(n,i,r){t.set("content.text",i+":"+r)})}},events:{show:function(){var r=i.data("qtip").elements.target,n=t(i);n.adjust={y:u?5:13};r.qtip("option",{"position.at":n.at,"position.my":n.my,"position.adjust.y":n.adjust.y})}},show:{event:"click",fixed:!0,effect:!1,delay:0},hide:{event:"click unfocus",fixed:!0,effect:!1,delay:0},style:{classes:"qtip-light",tip:u,width:f,height:e}})},s=function(){var n=i();n.style={tip:!1,classes:"shortkey-helper"};n.position={my:"bottom left",at:"center right"};n.show=!1;$(f).qtip(n)},i=function(){return{style:{tip:!1,classes:"qtip-dark tooltip"},position:{my:"top center",at:"bottom center",adjust:{y:10}}}};return n}();Base.prototype.isReady=function(){};Base.prototype.isPluginExist=function(){};Base.prototype.openURL=function(){};Base.prototype.openFile=function(){};Base.prototype.signWord=function(){};Base.prototype.signPdf=function(){};Base.prototype.getCertIndex=function(){};Base.prototype.writeFileBase64=function(){};Base.prototype.readFileBase64=function(){};Base.prototype.getTempFolder=function(){};Base.prototype.transferPdf=function(){};Base.prototype.transferDoc=function(){};Base.prototype.closeAllOfficeDocuments=function(){};Base.prototype.cancelTransferImage=function(){};Base.prototype.isWordInstalled=function(){};Base.prototype.isChangeContent=function(){};Base.prototype.getAllScanner=function(){};Base.prototype.imageCrop=function(){};Base.prototype.readFileScanBase64=function(){};Base.prototype.imageRotate=function(){};Base.prototype.imageAdjustBrightness=function(){};Base.prototype.imageAdjustContrast=function(){};Base.prototype.transferImage=function(){};ChromeNativeApp.version="1.0.2016.0801";ChromeNativeApp.prototype.version=ChromeNativeApp.version;ChromeNativeApp.prototype=new Base;ChromeNativeApp.prototype.constructor=ChromeNativeApp;ChromeNativeApp.EXTENSION_ID="cngndmpehahbhkdhihanbpobckmkdkkk";ChromeNativeApp.EXTENSION_URL="";ChromeNativeApp.Egov_Event={GetMd5:"Egov_GetMd5",OpenFile:"Egov_OpenFile",CloseFile:"Egov_CloseFile",WriteFileBase64:"Egov_WriteFileBase64",ReadFileBase64:"Egov_ReadFileBase64",DeleteFile:"Egov_DeleteFile",DeleteFolder:"Egov_DeleteFolder",GetCertIndex:"Egov_GetCertIndex",SignFile:"Egov_SignFile",SignFileByPoint:"Egov_SignFileByPoint",HasAppendModeVersion:"HasAppendModeVersion",ScanFile:"Egov_ScanFile",TransferPdf:"Egov_TransferPdf",TransferDoc:"Egov_TransferDoc",CancelTransferImage:"Egov_CancelTransferImage",IsWordInstalled:"Egov_IsWordInstalled",IsChangeContent:"Egov_isChangeContent",GetAllScanner:"Egov_GetAllScanner",ImageCrop:"Egov_ImageCrop",ReadFileScanBase64:"Egov_ReadFileScanBase64",ImageRotate:"Egov_ImageRotate",ImageAdjustBrightness:"Egov_ImageAdjustBrightness",ImageAdjustContrast:"Egov_ImageAdjustContrast",TransferImage:"Egov_TransferImage",Acquire:"Egov_Acquire",GetTempFolder:"Egov_GetTempFolder",IsExistExtension:"IsExistExtension",Convert:"Egov_Convert",GetMAC:"Egov_GetMAC",OpenUrl:"Egov_OpenUrl"};ChromeNativeApp.getInstance=function(){return this._instance||(this._instance=new ChromeNativeApp),this._instance};ChromeNativeApp.callbacks={};ChromeNativeApp.responseEventReady=!1;ChromeNativeApp.sendToContent=function(n,t){var i,r,u,f;ChromeNativeApp.responseEventReady||(i=function(n){var t=n.detail,r=t.sender==null?null:t.sender.callbackid,i;if(r&&(i=ChromeNativeApp.callbacks[r],i)){if(delete ChromeNativeApp.callbacks[r],typeof i=="function"){i(t);return}if(t)return t}},parent.document.removeEventListener("BkaveGovChromeExtension_Response",i,!1),parent.document.addEventListener("BkaveGovChromeExtension_Response",i),ChromeNativeApp.responseEventReady=!0);r=(new Date).getTime();ChromeNativeApp.callbacks[r]=t;n.sender=n.sender||{};n.sender.hasAppendModeVersion=ChromeNativeApp.hasAppendMode||egov.hasPluginAppendMode;n.sender.callbackid=r;u=document.createEvent("CustomEvent");u.initCustomEvent("BkaveGovChromeExtension_Request",!0,!0,n);f=parent.document.dispatchEvent(u)};ChromeNativeApp.prototype.isReady=function(n){if(typeof n=="function")n(!0);else return!0};ChromeNativeApp.prototype.isPluginExist=function(n){ChromeNativeApp.sendToContent({message:"installed"},function(t){n(t.isInstalled)})};ChromeNativeApp.prototype.hasAppendWriteMode=function(n){var t={action:ChromeNativeApp.Egov_Event.HasAppendModeVersion,fileName:"test.txt",data:"MTIz",mode:!1};ChromeNativeApp.sendToContent(t,function(t){n(t.hasAppendWriteMode)})};ChromeNativeApp.prototype.openFile=function(n,t){var i={action:ChromeNativeApp.Egov_Event.OpenFile,fileName:n};return ChromeNativeApp.sendToContent(i,t)};ChromeNativeApp.prototype.closeFile=function(n,t){var i={action:ChromeNativeApp.Egov_Event.CloseFile,fileName:n};return ChromeNativeApp.sendToContent(i,t)};ChromeNativeApp.prototype.writeFileBase64=function(n,t,i,r){var u={action:ChromeNativeApp.Egov_Event.WriteFileBase64,fileName:n,data:t,mode:i};return ChromeNativeApp.sendToContent(u,r)};ChromeNativeApp.prototype.readFileBase64=function(n,t){var i={action:ChromeNativeApp.Egov_Event.ReadFileBase64,fileName:n};return ChromeNativeApp.sendToContent(i,t)};ChromeNativeApp.prototype.existsFile=function(n,t){var i={action:ChromeNativeApp.Egov_Event.ExistsFile,fileName:n};return ChromeNativeApp.sendToContent(i,t)};ChromeNativeApp.prototype.getMd5=function(n,t){var i={action:ChromeNativeApp.Egov_Event.GetMd5,fileName:n};return ChromeNativeApp.sendToContent(i,t)};ChromeNativeApp.prototype.deleteFile=function(n,t,i){t=t||!1;var r={action:ChromeNativeApp.Egov_Event.DeleteFile,fileName:n,mode:t};return ChromeNativeApp.sendToContent(r,i)};ChromeNativeApp.prototype.deleteFolder=function(n,t,i){t=t||!1;var r={action:ChromeNativeApp.Egov_Event.DeleteFolder,fileName:n,mode:t};return ChromeNativeApp.sendToContent(r,i)};ChromeNativeApp.prototype.signFile=function(n,t,i,r){var u={action:ChromeNativeApp.Egov_Event.SignFile,idxCert:i,fileName:n,config:t};return ChromeNativeApp.sendToContent(u,r)};ChromeNativeApp.prototype.signFileByPoint=function(n,t,i,r){var u={action:ChromeNativeApp.Egov_Event.SignFileByPoint,idxCert:i,fileName:n,config:t};return ChromeNativeApp.sendToContent(u,r)};ChromeNativeApp.prototype.getCertIndex=function(n){var t={action:ChromeNativeApp.Egov_Event.GetCertIndex};return ChromeNativeApp.sendToContent(t,n)};ChromeNativeApp.prototype.getTempFolder=function(n){var t={action:ChromeNativeApp.Egov_Event.GetTempFolder};return ChromeNativeApp.sendToContent(t,n)};ChromeNativeApp.prototype.transferPdf=function(n,t,i){var r={action:ChromeNativeApp.Egov_Event.TransferPdf,listpath:n};return ChromeNativeApp.sendToContent(r,i)};ChromeNativeApp.prototype.transferDoc=function(n,t){var i={action:ChromeNativeApp.Egov_Event.TransferDoc,listpath:n};return ChromeNativeApp.sendToContent(i,t)};ChromeNativeApp.prototype.cancelTransferImage=function(n){var t={action:ChromeNativeApp.Egov_Event.CancelTransferImage,path:n};return ChromeNativeApp.sendToContent(t)};ChromeNativeApp.prototype.isWordInstalled=function(n){var t={action:ChromeNativeApp.Egov_Event.isWordInstalled};return ChromeNativeApp.sendToContent(t,n)};ChromeNativeApp.prototype.isChangeContent=function(n,t){var i={action:ChromeNativeApp.Egov_Event.IsChangeContent,filename:n};return ChromeNativeApp.sendToContent(i,t)};ChromeNativeApp.prototype.getAllScanner=function(n,t){var i={action:ChromeNativeApp.Egov_Event.GetAllScanner,reload:n};return ChromeNativeApp.sendToContent(i,t)};ChromeNativeApp.prototype.acquire=function(n,t,i,r,u,f){var e={action:ChromeNativeApp.Egov_Event.Acquire,showui:n,sourceIndex:t,pixelType:i,resolution:r,enableDuplex:u};return ChromeNativeApp.sendToContent(e,f)};ChromeNativeApp.prototype.imageCrop=function(n,t,i,r,u,f,e){var o={action:ChromeNativeApp.Egov_Event.ImageCrop,path:n,left:t,top:i,bottom:r,right:u,width:f,height:e};return ChromeNativeApp.sendToContent(o)};ChromeNativeApp.prototype.readFileScanBase64=function(n,t,i,r){var u={action:ChromeNativeApp.Egov_Event.ReadFileScanBase64,start:t,length:i,path:n};return ChromeNativeApp.sendToContent(u,r)};ChromeNativeApp.prototype.imageRotate=function(n,t,i){var r={action:ChromeNativeApp.Egov_Event.ImageRotate,path:n,angle:t};return ChromeNativeApp.sendToContent(r,i)};ChromeNativeApp.prototype.imageAdjustBrightness=function(n,t,i){var r={action:ChromeNativeApp.Egov_Event.ImageAdjustBrightness,path:n,percentage:t};return ChromeNativeApp.sendToContent(r,i)};ChromeNativeApp.prototype.imageAdjustContrast=function(n,t,i){var r={action:ChromeNativeApp.Egov_Event.ImageAdjustContrast,path:n,percentage:t};return ChromeNativeApp.sendToContent(r,i)};ChromeNativeApp.prototype.transferImage=function(n,t){var i={action:ChromeNativeApp.Egov_Event.TransferImage,path:n,imageformat:t};return ChromeNativeApp.sendToContent(i)};ChromeNativeApp.prototype.openURL=function(n){var t={action:ChromeNativeApp.Egov_Event.OpenUrl,url:n};return ChromeNativeApp.sendToContent(t)};ChromeNativeApp.prototype.getMAC=function(n){var t={action:ChromeNativeApp.Egov_Event.GetMAC};return ChromeNativeApp.sendToContent(t,n)};ChromeNativeApp.prototype.convertToPdf=function(n,t){var i={action:ChromeNativeApp.Egov_Event.Convert,fileType:35,fileNameArr:n};return ChromeNativeApp.sendToContent(i,t)};PluginFactory.getInstance=function(){return navigator.isMobile?BChromeCAPlugin.getInstance():PluginFactory.isChrome()?ChromeNativeApp.getInstance():null};PluginFactory.isChrome=function(){return navigator.userAgent.indexOf("Chrome")!=-1?!0:!1},function(){function t(n){for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="",u=0,e=n.length,r,f,o;u<e;){if(r=n.charCodeAt(u++)&255,u==e){t+=i.charAt(r>>2);t+=i.charAt((r&3)<<4);t+="==";break}if(f=n.charCodeAt(u++),u==e){t+=i.charAt(r>>2);t+=i.charAt((r&3)<<4|(f&240)>>4);t+=i.charAt((f&15)<<2);t+="=";break}o=n.charCodeAt(u++);t+=i.charAt(r>>2);t+=i.charAt((r&3)<<4|(f&240)>>4);t+=i.charAt((f&15)<<2|(o&192)>>6);t+=i.charAt(o&63)}return t}function i(n){var t=new XMLHttpRequest;return t.open("GET",n,!1),t.overrideMimeType("text/plain; charset=x-user-defined"),t.send(null),t.responseText}var n={extension:null,signatureConfig:[],appendPlugin:function(n){(egov.extension||(egov.extension=PluginFactory.getInstance()),egov.extension)&&egov.extension.isReady(function(t){t?this.checkNativeAppVersion(n):egov.extension.isPluginExist(function(t){t?egov.extension.injectPlugin("egovPlugin",function(){this.appendPlugin(n)}.bind(this)):this.showDialogDownloadPlugin(function(){this.appendPlugin(n)}.bind(this))}.bind(this))}.bind(this))},checkNativeAppVersion:function(n){egov.extension.hasAppendMode!=null||egov.hasPluginAppendMode!=null||setTimeout(function(){egov.extension.hasAppendWriteMode(function(t){egov.extension.hasAppendMode=t;egov.hasPluginAppendMode=t;egov.callback(n)})},2e3);egov.callback(n);return},showDialogDownloadPlugin:function(n){var i,t;i=this;t=$('<div><p style="font-size:16px;font-weight:bold;">'+egov.resources.plugin.noplugin+"<\/p><p>"+egov.resources.plugin.pluginrequire+'<\/p><p style="color:red">'+egov.resources.plugin.needrestartbrowser+'<\/p><center><div style="text-align:center;width:180px"><input type="button" value="'+egov.resources.plugin.downloadtosetup+'" /><\/div><\/center><\/div>');t.find("input").bind("click",function(){i._startDownload();i._dowloadingPlugin(t,n)});t.dialog({width:"800px",resizable:!1,title:egov.resources.common.alert,buttons:[{text:egov.resources.common.closeButton,click:function(){t.dialog("destroy")}}]})},_startDownload:function(){document.location="/Download/EOfficePlusPlugin"},_dowloadingPlugin:function(n){var i,t;i=this;t=$('<a class="retry">'+egov.resources.main.installPlugin.reDownload+"<\/a>");t.on("click",function(){i._startDownload()});n.empty();n.append(t)},callSignSuccess:function(n){this.tempFolderLoc&&this.deleteFolder(this.tempFolderLoc);this.currentSignOptions={withChoosePoint:!1};egov.callback(this.signSuccess,n)},sign:function(n,t){var i,u,r,f;if(i=this,i.currentSignOptions={withChoosePoint:!1},i.tempFolderLoc=(new Date).getTime().toString()+"_forsign",i.hasDeleteOldFile=!1,i.signatureConfig=egov.signatureConfig||[],i.signSuccess=t,r=egov.setting.signerConfig,r.length===0){egov.pubsub.publish(egov.events.status.error,"Bạn chưa cấu hình chữ ký số, vui lòng vào Thiết lập cá nhân/Cấu hình chữ ký để tạo mới.");i.callSignSuccess(!1);return}f=$.isArray(r)?r.slice(0,r.length):$.extend(!0,{},r);i.document=n;i._writeImageSignature(f,function(){u=n.getAttachmentsForSign();u.length>0?(i.confirmSignFiles=u,i._displaySignDialog(u,t)):i.callSignSuccess(!1)})},_displaySignDialog:function(n){var t,r,i;t=this;t.isPreviewing=!1;require([egov.template.document.signer],function(u){r=$("<div><\/div>");r.append(u);r.find(".sign-list").append($.tmpl('<li class="list-group-item"><div><label><input type="checkbox" data-id="${Id}"> ${Title}<\/label><\/div><\/li>',t.signatureConfig));t.signatureConfig.length===1&&r.find(".sign-list :checkbox").attr("checked","checked");var e=_.map(n,function(n){return n.toJSON()}),o=_.groupBy(e,"Compendium"),f=r.find(".att-list");_.each(o,function(n,t){f.append('<li class="list-group-item"><b>'+t+"<\/b><\/li>");f.append($.tmpl('<li class="list-group-item"><div><label><input type="checkbox" data-id="${Id}" checked> ${Name}<\/label><\/div><\/li>',n))});r.appendTo("body");t.$confirmDialog=r;i={};i.width=500;i.height="auto";i.autoResize=!0;i.title="Ký số điện tử";i.buttons=[{text:"Xem trước",className:"btn-warning",click:function(){t._signPreviewBtn()}},{text:"Chuyển",className:"btn-primary",click:function(){t._signAndSendBtn()}},{text:"Bỏ qua",className:"btn-default",click:function(){t.isPreviewing=!1;t.$confirmDialog.dialog("destroy");t.callSignSuccess(!1)}}];i.confirm={text:"Xóa tệp cũ sau khi ký",id:"deleleOldFile",style:{float:"left","font-weight":"normal","font-size":"13px"},click:function(n){t.hasDeleteOldFile=n},hasAutoClick:!1,disabled:!1};t.$confirmDialog.dialog(i)})},_getSelectedFiles:function(n){var r=this,u=r.$confirmDialog.find(".att-list input:checked"),t,i;return u.length<=0?[]:(t=[],u.each(function(n,i){t.push($(i).attr("data-id"))}),i=_.filter(n,function(n){return _.contains(t,n.get("Id").toString())}),r.currentSignOptions.selectedFiles=i,i)},_getSelectedSignerConfig:function(n){var i=this,f=!1,e=i.$confirmDialog.find(".sign-list input:checked"),r,t,u,o;return e.length<=0?[]:(r=[],e.each(function(n,t){r.push($(t).attr("data-id"))}),t=_.filter(n,function(n){return _.contains(r,n.Id.toString())}),u={sameToken:_.where(t,{hasSameToken:!0})},_.each(_.where(t,{hasSameToken:!1}),function(n){f=!0;u[n.Id]=[n]}),o=_.values(u),i.currentSignOptions.config=o,i.currentSignOptions.hasShowAlertChooseToken=f,t)},_writeFileBase64:function(n,t,i){var s=this,f,u,h,o;if(!n){i();return}if(f=Object.keys(n),f.length===0){i();return}var e=f[0],c=n[e],r=t.filter(function(n){return n.get("Id")==e});r=r[0];u=r.get("Extension");u.indexOf(".")!=0&&(u="."+u);h=r.get("Name").toLowerCase();o=s.tempFolderLoc+"\\"+h;egov.extension.writeFileBase64(o,c,!0,function(u){var f=u.returnCode===1;if(f)r.set("fileData",o),r.set("md5",u.md5),delete n[e],s._writeFileBase64(n,t,i);else{egov.pubsub.publish(egov.events.status.error,egov.resources.common.errorMessage);return}})},_writeImageSignature:function(n,t){var i=this,r,f;if(n.length===0||egov.isWriteSigner){egov.isWriteSigner=!0;egov.signatureConfig=i.signatureConfig;_.each(egov.signatureConfig,function(n){if(n.SignType!==0){var t=i.document.isTransferTheoLo?"":i.document.model.get("DocCode");n.ReplaceText=t.split("/")[0]}});t(i.signatureConfig);return}if(r=n.pop(),r==undefined){t(i.signatureConfig);return}if(f=r.ImagePath&&r.SignType===0,f)var e=""+(new Date).getTime()+r.Ext,o=(new Date).getTime().toString(),u=o+"\\"+e,s=egov.extension.writeFileBase64(u,r.ImagePath,!0,function(f){if(f.returnCode==1)u=u.replace(/\//g,"\\"),r.ImagePath=u,i.signatureConfig.push(r),i._writeImageSignature(n,t);else{egov.pubsub.publish(egov.events.status.error,egov.resources.common.errorMessage);return}});else r.ImagePath="",r.ReplaceText=i.document.isTransferTheoLo?"":i.document.model.get("DocCode"),i.signatureConfig.push(r),i._writeImageSignature(n,t)},_signAndSendBtn:function(){var n=this,t=function(t,i){if(!t||i.length===0){n.$confirmDialog.dialog("destroy");n.callSignSuccess(!1);return}egov.pubsub.publish(egov.events.status.success,"Kí file thành công!");n._uploadAndSend(i)};this._doSign(t)},_signPreviewBtn:function(){var n=this,t;n.isPreviewing||(n.isPreviewing=!0,t=function(t,i){if(!t||i.length===0){n.$confirmDialog.dialog("destroy");n.callSignSuccess(!1);return}n._openPreviewSinged(i)},this._doSign(t))},_signWithPositionAndPreview:function(){if(this.currentSignOptions){var n=this,t=function(t,i){if(!t||i.length===0){n.$confirmDialog.dialog("destroy");n.callSignSuccess(!1);return}n._openPreviewSinged(i)};n.currentSignOptions.withChoosePoint=!0;egov.pubsub.publish(egov.events.status.info,"Vui lòng quét chuột chọn vị trí cần hiển thị chữ ký.");n._writeFilesAndSign(t)}},_openPreviewSinged:function(n){for(var f,r,e,i=this,t=$("<div>"),u=0;u<n.length;u++)f=n[u],r=$("<object>"),r.css({width:"100%",height:"350px",border:"none"}),r.attr("data","data:application/pdf;base64,"+f.value),t.append(r);t.appendTo("body");e={width:1e3,height:400,autoResize:!0,title:"Ký số điện tử",buttons:[{text:"Quét chọn vị trí khác",className:"btn-warning",click:function(){t.dialog("destroy");i.deleteFolder(i.tempFolderLoc,function(){i._signWithPositionAndPreview()})}},{text:"Chuyển",className:"btn-primary",click:function(){t.dialog("destroy");i._uploadAndSend(n)}},{text:"Bỏ qua",className:"btn-default",click:function(){i.isPreviewing=!1;t.dialog("destroy")}}]};t.dialog(e)},_doSign:function(n){var i,u,r=[],f=[],t=this,e;if(i=t._getSelectedFiles(t.confirmSignFiles),u=t._getSelectedSignerConfig(t.signatureConfig),i.length<=0||u.length<=0){egov.pubsub.publish(egov.events.status.warning,"Bạn chưa chọn tệp hoặc chữ ký để ký số. Vui lòng thử lại.");t.$confirmDialog.dialog("destroy");n(!1,[]);return}e=i.filter(function(n){return!n.get("fileData")||!egov.setting.publish.detectPdfChangeContent&&egov.fileExtension.isReadonly(n.get("Name"))});$.each(e,function(n,t){t.get("isNew")?egov.isMobile?r.push(t.get("Id")+"."+t.get("Extension")):r.push(t.get("Id")):f.push(t.get("Id"))});egov.pubsub.publish(egov.events.status.processing,egov.resources.common.processing);egov.request.downloadAttachmentForSignBase64({data:{fileIds:f,fileTempIds:r,convertWordTopdf:!1},success:function(i){t.currentSignOptions.base64OfAttachmentFiles=$.extend(!0,{},i.files);t._writeFilesAndSign(n)},error:function(){t.isPreviewing=!1;egov.pubsub.publish(egov.events.status.error,egov.resources.common.errorMessage)}})},_writeFilesAndSign:function(n){var t=this,u=t.currentSignOptions.hasShowAlertChooseToken,i=_.clone(t.currentSignOptions.config),r=_.clone(t.currentSignOptions.selectedFiles),f=_.clone(t.currentSignOptions.base64OfAttachmentFiles),e=function(){var e=[],f=i.pop(),o;f.length===0&&(f=i.pop());o=function(){if(i.length===0){n(!0,e);return}f=i.pop();t._signFileWithCertIndex(r,f,e,o,u)};t._signFileWithCertIndex(r,f,e,o,u)};this._writeFileBase64(f,r,e)},_signFileWithCertIndex:function(n,t,i,r,u){var e,s,f,o;if(t.length===0)return r();if(u&&(e=_.pluck(t,"Title").join(","),s=String.format("Đang ký số cho chữ ký {0}. /nVui lòng cắm token vào máy và nhấn Ok để chọn.",e),alert("Chọn Token cho chữ ký "+e)),f=this,this.currentSignOptions&&this.currentSignOptions.idxCert){this._signFile(n,i,t,this.currentSignOptions.idxCert,function(){r()},this.currentSignOptions.withChoosePoint);return}o=function(u){var e=parseInt(u.idxCert);if(isNaN(e)||e<=-1){f.isPreviewing=!1;egov.pubsub.publish(egov.events.status.error,"Vui lòng kiểm tra lại chữ kí số đã sẵn sàng trước khi kí!");return}f.currentSignOptions.idxCert=e;f._signFile(n,i,t,e,function(){r()},f.currentSignOptions.withChoosePoint)};egov.extension.getCertIndex(o)},_signFile:function(n,t,i,r,u,f){if(n.length===0){u();return}f=f||!1;var o=n.pop(),e=o.get("fileData"),a=egov.fileExtension.isForSign(e),l=i.slice(0);if(a){var s=l.pop(),h=$.extend(!0,{SignAuthor:egov.setting.userName,SignReason:"Bkav eGov - Ký số điện tử"},s),c=function(a){if(s=l.pop(),a.returnCode==1){if(s!=undefined){egov.fileExtension.isMsOfficeFile(e)&&(e=egov.fileExtension.getFileName(e)+".pdf");h=$.extend(!0,{SignAuthor:egov.setting.userName,SignReason:"Bkav eGov - Ký số điện tử"},s);this._signSelectFile(e,h,r,c);return}var v=egov.fileExtension.getFileName(o.get("Name"));v.match(/_Signed$/)||(v=v+"_Signed");v=v+".pdf";t.push({id:""+o.get("Id"),documentCopyId:o.get("DocumentCopyId"),name:v,originName:a.fileName,value:a.base64});this._signFile(n,t,i,r,u,f)}else{egov.pubsub.publish(egov.events.status.error,egov.resources.common.errorMessage+": "+a.returnMessage);return}}.bind(this);f?this._signByPoint(e,h,r,c):this._signSelectFile(e,h,r,c)}},_signSelectFile:function(n,t,i,r){egov.extension.signFile(n,t,parseInt(i),function(n){r(n)}.bind(this))},_signByPoint:function(n,t,i,r){egov.extension.signFileByPoint(n,t,parseInt(i),function(n){r(n)}.bind(this))},_uploadAndSend:function(n){var t=this;this._uploadSignedFile(n,this.document,function(){t.$confirmDialog.dialog("destroy");t.callSignSuccess(!0);egov.pubsub.publish(egov.events.status.success,"Đính kèm file đã kí vào văn bản thành công!")})},_uploadSignedFile:function(n,t,i){t.uploadSignFiles(n,i)},openAttachment:function(n,t){var r,u,i;r=n.model.get("Id");u=n.parent.storePrivateId;n.model.get("isNew")?n.model.get("isOpen")&&n.model.get("fileData")?egov.extension.openFile(n.model.get("fileData")):egov.request.downloadAttachmentTemp({data:{id:r},success:function(t){var r=JSON.parse(t),i,u,f;r&&(r.error?egov.pubsub.publish(egov.events.status.error,r.error):(i=n.model.get("Extension"),i.indexOf(".")!=0&&(i="."+i),u=n.model.get("Id")+i,f=(new Date).getTime().toString(),filePath=f+"\\"+u,egov.extension.writeFileBase64(filePath,r.content,!0,function(t){t.returnCode==1&&(n.model.set("fileData",filePath),n.model.set("md5",t.md5),egov.extension.openFile(filePath,function(){n.model.set("isOpen",!0)}))}.bind(this))))}.bind(this),error:function(){egov.pubsub.publish(egov.events.status.error,egov.resources.document.attachment.errorDownload)},complete:function(){egov.pubsub.publish(egov.events.status.destroy)}}):(i=t==n.model.get("LastestVesion"),n.model.get("isOpen")&&(!t||i)?egov.extension.openFile(n.model.get("fileData")):(egov.pubsub.publish(egov.events.status.processing,egov.resources.common.processing),egov.request.downloadAttachment({data:{id:r,storePrivateId:u,version:t?i?null:t:null},success:function(r){var f=JSON.parse(r),u,e,o;f&&(f.error?egov.pubsub.publish(egov.events.status.error,f.error):(u=n.model.get("Extension"),u.indexOf(".")!=0&&(u="."+u),e=n.model.get("Id")+u,o=(new Date).getTime().toString(),filePath=o+"\\"+e,egov.extension.writeFileBase64(filePath,f.content,!0,function(r){r.returnCode==1&&((i||!t)&&n.model.set("fileData",filePath),n.model.set("md5",r.md5),egov.extension.openFile(filePath,function(){(i||!t)&&n.model.set("isOpen",!0)}))}.bind(this))))}.bind(this),error:function(){egov.pubsub.publish(egov.events.status.error,_resource.errorDownload)},complete:function(){egov.pubsub.publish(egov.events.status.destroy)}})))},openStoreAttachment:function(n){egov.request.storePrivateOpenFile({data:{id:n},success:function(n){var t=JSON.parse(n),i,r;t&&(t.error?egov.pubsub.publish(egov.events.status.error,t.error):(i=t.fileName,r=(new Date).getTime().toString(),filePath=r+"\\"+i,egov.extension.writeFileBase64(filePath,t.content,!0,function(n){n.returnCode==1&&egov.extension.openFile(filePath,function(){})}.bind(this))))},error:function(){egov.pubsub.publish(egov.events.status.error,_resource.errorDownload)},complete:function(){egov.pubsub.publish(egov.events.status.destroy)}})},confirmAttachments:function(n,t){var r=this,i=n.model.select(function(t){var i=!t.get("isRemoved")&&t.get("isOpen");return n.isPublishing&&egov.setting.publish.detectPdfChangeContent||(i=i&&!egov.fileExtension.isReadonly(t.get("Name"))),i});if(i.length===0){egov.callback(t);return}$(document).on("checkModifySuccess",function(n){$(document).off("checkModifySuccess");egov.callback(t);egov.helper.destroyClickEvent(n)});this._confirmSaveAttachment(i,n)},_confirmSaveAttachment:function(n,t){if(n.length===0){$(document).trigger("checkModifySuccess");return}var u=this,i=n[0],r=n.splice(1,n.length-1);this._closeFile(i,t,r)},_closeFile:function(n,t,i){var r=this;egov.extension.closeFile(n.get("fileData"),function(u){u.returnCode==1||u.returnCode==2?(u.returnCode=="2"&&console.log("egov.extension.closeFile: "+n.get("Name")+" đã đóng trước đó"),egov.extension.readFileBase64(n.get("fileData"),function(u){if(u.returnCode==1)if(n.get("md5")!=u.md5){var f=n.get("Name");egov.message.show(String.format(egov.resources.document.attachment.fileChanged,f),null,egov.message.messageButtons.YesNo,function(){t.modifiedFiles[n.get("Id")]=u.base64;r._confirmSaveAttachment(i,t)},function(){r._confirmSaveAttachment(i,t)})}else r._confirmSaveAttachment(i,t);else u.returnCode==2?console.log("egov.plugin::_confirmSaveAttachment::warning: Đọc nội dung file không tồn tại!!! Cần check lại code."):console.log("egov.plugin::_confirmSaveAttachment::Error: lỗi không thể lưu nội dung file")})):egov.message.show(String.format("Vui lòng đóng phần mềm đang mở file {0} và thử lại.",n.get("Name")),"Thông báo",egov.message.messageButtons.Ok)})},openFileUri:function(n,r){var o=(new Date).getTime().toString(),u=o+"\\"+r,f,e;egov.extension||(egov.extension=PluginFactory.getInstance());f=i(n);e=t(f);egov.extension.writeFileBase64(u,e,!0,function(n){n.returnCode==1&&egov.extension.openFile(u)})},getMAC:function(n){if(egov.extension||(egov.extension=PluginFactory.getInstance()),!egov.extension){egov.callback(n,"");return}egov.extension.getMAC(function(t){egov.callback(n,t.mac)})},deleteFolder:function(n,t){egov.extension.deleteFolder(n,!0,function(){egov.callback(t)})}};return window.Plugin=n,n}(),function(){var f={bindJsTree:function(i,r,f,e,o,s,h){var c=_.find(o,function(n){return n.parentid===0}),l;f&&n.push("checkbox");e&&n.push("dnd");c&&(l=t(c.value,r,o,s,h),i.jstree({json_data:{data:[{data:c.data.toString(),metadata:{id:c.value},state:"closed",attr:{id:c.value,rel:"dept",idext:c.idext,label:c.label},children:l}]},crrm:e==!1?{}:{move:{check_move:function(n){var i=_.find(o,function(t){return t.value===parseInt(n.o.attr("id"))}),t;return i?i.level!=1?!1:(t=this._get_parent(n.o),!t)?!1:(t=t==-1?this.get_container():t,t===n.np)?!0:t[0]&&n.np[0]&&t[0]===n.np[0]?!0:!1:!1}}},dnd:e==!1?{}:{drop_target:!1,drag_target:!1},plugins:n}).bind("loaded.jstree",function(n,t){var e=1;t.inst.get_container().find("li").each(function(){t.inst.get_path($(this)).length<=e&&t.inst.open_node($(this))});i.bind("open_node.jstree",function(n,t){t.inst._get_children(t.rslt.obj).length==0&&u(t.rslt.obj,parseInt(t.rslt.obj.attr("id")),r,f,o,s,h)})}))}},r;egov.utils.treeUtil=f;var e=function(n,t){return $(String.format('<li class="list-group-item">                                <div class="row">                                    <label class="checkbox document-color">                                       <input name="checkbox[]" value="{0}" type="checkbox" checked="checked">                                        <span class="document-color-1"><i class="icon-check"><\/i><\/span>                                    <\/label>                                    <span style="margin-left: 15px;">{1}<\/span>                                <\/div>                            <\/li>',n,t))},t=function(n,i,r,u,f){var e=_.filter(r,function(t){return t.parentid==n}),o=_.filter(f,function(t){return t.departmentid===n}),c,s,h,l;if(e.length>0)for(c=0;c<e.length;c++)(t(e[c].value,!1,r,[],[]).length>0||i&&o.length>0)&&(e[c].state="closed");if(i&&o.length>0)for(s=0;s<o.length;s++)h=_.find(u,function(n){return n.value===o[s].userid}),h&&(l={value:"user_"+h.value,data:h.fullname,parentid:n,state:"leaf",metadata:{id:"user_"+h.value},attr:{id:"user_"+h.value,rel:"people",idext:o[s].idext,hasReceiveDocument:o[s].hasReceiveDocument}},e.push(l));return e},i='<li id="${value}" label="${attr.label}" rel="${attr.rel}" idext="${attr.idext}" class="jstree-${state}"><ins class="jstree-icon">&nbsp;<\/ins><a href="#" class="">';i+='<ins class="jstree-icon">&nbsp;<\/ins>${data}<\/a><\/li>';r='<li id="${value}" rel="${attr.rel}" idext="${attr.idext}" hasReceiveDocument="${attr.hasReceiveDocument}" class="jstree-${state}"><ins class="jstree-icon">&nbsp;<\/ins><a href="#" class=""><ins class="jstree-checkbox">&nbsp;<\/ins><ins class="jstree-icon">&nbsp;<\/ins>${data}<\/a><\/li>';var n=["themes","json_data","ui","crrm"],o=function(i,r,f,e,o,s,h){var c=_.find(o,function(n){return n.parentid===0}),l;f&&n.push("checkbox");e&&n.push("dnd");c&&(l=t(c.value,r,o,s,h),i.jstree({json_data:{data:[{data:c.data.toString(),metadata:{id:c.value},state:"closed",attr:{id:c.value,rel:"dept",idext:c.idext,label:c.label},children:l}]},crrm:e==!1?{}:{move:{check_move:function(n){var i=_.find(o,function(t){return t.value===parseInt(n.o.attr("id"))}),t;return i?i.level!=1?!1:(t=this._get_parent(n.o),!t)?!1:(t=t==-1?this.get_container():t,t===n.np)?!0:t[0]&&n.np[0]&&t[0]===n.np[0]?!0:!1:!1}}},dnd:e==!1?{}:{drop_target:!1,drag_target:!1},plugins:n}).bind("loaded.jstree",function(n,t){var e=1;t.inst.get_container().find("li").each(function(){t.inst.get_path($(this)).length<=e&&t.inst.open_node($(this))});i.bind("open_node.jstree",function(n,t){t.inst._get_children(t.rslt.obj).length==0&&u(t.rslt.obj,parseInt(t.rslt.obj.attr("id")),r,f,o,s,h)})}))},u=function(n,u,f,e,o,s,h){var l=t(u,f,o,s,h),c;l.length>0&&(c=$("<ul><\/ul>"),c.appendTo(n),e?($.tmpl(r,l).appendTo(c),$(n).find("li").each(function(t,i){$(i).addClass(n.hasClass("jstree-checked")?"jstree-checked":"jstree-unchecked")})):$.tmpl(i,l).appendTo(c),c.children("li:last").addClass("jstree-last"))}}(egov||{});